"use strict";var app={api_version:"v2.0.1",debug:!1,baseUrl:"",baseUrlCdn:"//cdn.internetcollaboratif.info",bearer:"",auth:{},isLogged:!1,autologin:!1,RateLimit:{Limit:null,Remaining:null,Used:null},date_format:"DD/MM/YYYY, HH:mm",cardMaxChars:256,cookieconsent:30,refreshExpiresInSeconds:28e4,itemsSize:{objects:15,flows:15,snippets:15,dashboards:15,mqtts:15,rules:15,sources:15},itemsPage:{objects:1,flows:1,snippets:1,dashboards:1,mqtts:1,rules:1,sources:1},currentSection:"index",tawktoid:"58852788bcf30e71ac141187",gtm:"GTM-PH7923",applicationServerKey:"BHnrqPBEjHfdNIeFK5wdj0y7i5eGM2LlPn62zxmvN8LsBTFEQk1Gt2zrKknJQX91a8RR87w8KGP_1gDSy8x6U7s",registration:null,defaultPageTitle:"t6 IoT App",sectionsPageTitles:{index:"t6 IoT App",profile:"t6 profile",object:"t6 Object %s",object_add:"Add Object to t6",objects:"t6 Objects",flow:"t6 Flow %s",flows:"t6 Flows",flow_add:"Add Flow to t6",dashboard:"t6 Dashboard %s",dashboards:"t6 Dashboards",dashboard_add:"Add Dashboard to t6",snippet:"t6 Snippet %s",snippets:"t6 Snippets",snippet_add:"Add Snippet to t6",rule:"t6 Rule %s",rules:"t6 Rules",rule_add:"Add Rule to t6",mqtt:"t6 Mqtt topic %s",mqtts:"t6 Mqtt topics",mqtt_add:"Add Mqtt topic to t6",source:"t6 Source %s",sources:"t6 Sources",source_add:"Add Source to t6",settings:"t6 Settings",signin:"Signin to t6",login:"Signin to t6",signup:"Signup to t6","forgot-password":"Forgot your t6 password?","reset-password":"Reset your t6 password",status:"t6 Api status",terms:"t6 Terms of Service and License Agreement",docs:"t6 Api first documentation","users-list":"t6 Users Accounts","compatible-devices":"t6 Compatible Devices",openSourceLicenses:"Open-Source licenses"},icons:{color:"format_color_fill",copy:"content_copy",dashboards:"dashboard",datapoints:"filter_center_focus",datatypes:"build",date:"event",delete:"delete",delete_question:"error_outline",description:"label",docs:"code",edit:"edit",flows:"settings_input_component",icon:"label_outline",link_off:"link_off",login:"email",menu:"menu",mqtts:"volume_down",sources:"code",code:"code",name:"list",objects:"devices_other",rules:"call_split",settings:"settings",snippets:"widgets",status:"favorite",terms:"business_center",type:"label",units:"hourglass_empty",update:"update",version:"linear_scale"},types:[{name:"cast",value:"Cast"},{name:"cast_connected",value:"Cast Connected"},{name:"computer",value:"Computer"},{name:"desktop_mac",value:"Desktop Mac"},{name:"desktop_windows",value:"Desktop Windows"},{name:"developer_board",value:"Developer Board"},{name:"device_hub",value:"Device Hub"},{name:"devices_other",value:"Devices Other"},{name:"dock",value:"Dock"},{name:"gamepad",value:"Gamepad"},{name:"headset",value:"Headset"},{name:"headset_mic",value:"Headset Mic"},{name:"keyboard",value:"Keyboard"},{name:"keyboard_voice",value:"Keyboard Voice"},{name:"laptop",value:"Laptop"},{name:"laptop_chromebook",value:"Laptop Chromebook"},{name:"laptop_mac",value:"Laptop Mac"},{name:"laptop_windows",value:"Laptop Windows"},{name:"memory",value:"Memory"},{name:"mouse",value:"Mouse"},{name:"phone_android",value:"Phone Android"},{name:"phone_iphone",value:"Phone Iphone"},{name:"phonelink",value:"Phonelink"},{name:"router",value:"Router"},{name:"scanner",value:"Scanner"},{name:"security",value:"Security"},{name:"sim_card",value:"Sim Card"},{name:"smartphone",value:"Smartphone"},{name:"speaker",value:"Speaker"},{name:"speaker_group",value:"Speaker Group"},{name:"tablet",value:"Tablet"},{name:"tablet_android",value:"Tablet Android"},{name:"tablet_mac",value:"Tablet Mac"},{name:"toys",value:"Toys"},{name:"tv",value:"Tv"},{name:"videogame_asset",value:"Videogame Asset"},{name:"watch",value:"Watch"}],snippetTypes:[],EventTypes:[{name:"mqttPublish",value:"mqtt Publish"},{name:"email",value:"Email"},{name:"webPush",value:"Notification webPush (beta)"},{name:"httpWebhook",value:"http(s) Webhook"},{name:"sms",value:"Sms/Text message"},{name:"ifttt",value:"Trigger event to Ifttt"},{name:"serial",value:"Serial using Arduino CmdMessenger"}],units:[],datatypes:[],flows:[],sources:[],snippets:[],defaultResources:{object:{id:"",attributes:{name:"",description:"",is_public:!1,type:"",ipv4:"",ipv6:"",longitude:"",latitude:"",position:"",source_id:"-"}},flow:{id:"",attributes:{name:"",mqtt_topic:"",require_signed:!1,require_encrypted:!1}},dashboard:{id:"",attributes:{name:"",description:""}},snippet:{id:"",attributes:{name:"",icon:"",color:""}},mqtt:{id:"",attributes:{name:""}},source:{id:"",attributes:{name:""}},rule:{id:"",active:!0,attributes:{name:"",priority:1,event:{type:"email",conditions:'{"all":[ { "fact":"environment", "operator":"equal", "value":"production" }]}',parameters:"{}"}}}},offlineCard:{},patterns:{name:".{3,}",ipv4:"((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)(.|$)){4}(:[0-9]{1,6})?",ipv6:"/^(?>(?>([a-f0-9]{1,4})(?>:(?1)){7}|(?!(?:.*[a-f0-9](?>:|$)){8,})((?1)(?>:(?1)){0,6})?::(?2)?)|(?>(?>(?1)(?>:(?1)){5}:|(?!(?:.*[a-f0-9]:){6,})(?3)?::(?>((?1)(?>:(?1)){0,4}):)?)?(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])(?>.(?4)){3}))$",longitude:"^[-+]?[0-9]{0,3}.[0-9]{1,7}$",latitude:"^[-+]?[0-9]{0,3}.[0-9]{1,7}$",position:".{3,255}",username:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?",password:".{4,}",cardMaxChars:"^[0-9]+$",customAttributeName:"^[a-zA-Z0-9_]+$",customAttributeValue:"^.*?$",secret_key:"^.*?$",secret_key_crypt:"^[a-fA-F0-9]{64}$",integerNotNegative:"^[^a-zA-Z]{1,4}$",meta_revision:"^[0-9]{1,}$",ttl:"^[1-9]+$",uuidv4:"^[0-9A-Fa-f]{8}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{4}-[0-9A-Fa-f]{12}$"},resources:{},buttons:{},containers:{}};app.offlineCard={title:"Offline",titlecolor:"#ffffff",description:"Offline mode, Please connect to internet in order to see your resources."};var Tawk_API,touchStartPoint,touchMovePoint;!function(t){function e(t){return i(a(n(t)))}function a(t){return s(l(o(t),8*t.length))}function i(t){try{}catch(t){h=0}for(var e,a=h?"0123456789ABCDEF":"0123456789abcdef",i="",n=0;n<t.length;n++)e=t.charCodeAt(n),i+=a.charAt(e>>>4&15)+a.charAt(15&e);return i}function n(t){for(var e,a,i="",n=-1;++n<t.length;)e=t.charCodeAt(n),a=n+1<t.length?t.charCodeAt(n+1):0,e>=55296&&56319>=e&&a>=56320&&57343>=a&&(e=65536+((1023&e)<<10)+(1023&a),n++),127>=e?i+=String.fromCharCode(e):2047>=e?i+=String.fromCharCode(192|e>>>6&31,128|63&e):65535>=e?i+=String.fromCharCode(224|e>>>12&15,128|e>>>6&63,128|63&e):2097151>=e&&(i+=String.fromCharCode(240|e>>>18&7,128|e>>>12&63,128|e>>>6&63,128|63&e));return i}function o(t){for(var e=Array(t.length>>2),a=0;a<e.length;a++)e[a]=0;for(var a=0;a<8*t.length;a+=8)e[a>>5]|=(255&t.charCodeAt(a/8))<<a%32;return e}function s(t){for(var e="",a=0;a<32*t.length;a+=8)e+=String.fromCharCode(t[a>>5]>>>a%32&255);return e}function l(t,e){t[e>>5]|=128<<e%32,t[14+(e+64>>>9<<4)]=e;for(var a=1732584193,i=-271733879,n=-1732584194,o=271733878,s=0;s<t.length;s+=16){var l=a,r=i,b=n,g=o;a=d(a,i,n,o,t[s+0],7,-680876936),o=d(o,a,i,n,t[s+1],12,-389564586),n=d(n,o,a,i,t[s+2],17,606105819),i=d(i,n,o,a,t[s+3],22,-1044525330),a=d(a,i,n,o,t[s+4],7,-176418897),o=d(o,a,i,n,t[s+5],12,1200080426),n=d(n,o,a,i,t[s+6],17,-1473231341),i=d(i,n,o,a,t[s+7],22,-45705983),a=d(a,i,n,o,t[s+8],7,1770035416),o=d(o,a,i,n,t[s+9],12,-1958414417),n=d(n,o,a,i,t[s+10],17,-42063),i=d(i,n,o,a,t[s+11],22,-1990404162),a=d(a,i,n,o,t[s+12],7,1804603682),o=d(o,a,i,n,t[s+13],12,-40341101),n=d(n,o,a,i,t[s+14],17,-1502002290),i=d(i,n,o,a,t[s+15],22,1236535329),a=p(a,i,n,o,t[s+1],5,-165796510),o=p(o,a,i,n,t[s+6],9,-1069501632),n=p(n,o,a,i,t[s+11],14,643717713),i=p(i,n,o,a,t[s+0],20,-373897302),a=p(a,i,n,o,t[s+5],5,-701558691),o=p(o,a,i,n,t[s+10],9,38016083),n=p(n,o,a,i,t[s+15],14,-660478335),i=p(i,n,o,a,t[s+4],20,-405537848),a=p(a,i,n,o,t[s+9],5,568446438),o=p(o,a,i,n,t[s+14],9,-1019803690),n=p(n,o,a,i,t[s+3],14,-187363961),i=p(i,n,o,a,t[s+8],20,1163531501),a=p(a,i,n,o,t[s+13],5,-1444681467),o=p(o,a,i,n,t[s+2],9,-51403784),n=p(n,o,a,i,t[s+7],14,1735328473),i=p(i,n,o,a,t[s+12],20,-1926607734),a=c(a,i,n,o,t[s+5],4,-378558),o=c(o,a,i,n,t[s+8],11,-2022574463),n=c(n,o,a,i,t[s+11],16,1839030562),i=c(i,n,o,a,t[s+14],23,-35309556),a=c(a,i,n,o,t[s+1],4,-1530992060),o=c(o,a,i,n,t[s+4],11,1272893353),n=c(n,o,a,i,t[s+7],16,-155497632),i=c(i,n,o,a,t[s+10],23,-1094730640),a=c(a,i,n,o,t[s+13],4,681279174),o=c(o,a,i,n,t[s+0],11,-358537222),n=c(n,o,a,i,t[s+3],16,-722521979),i=c(i,n,o,a,t[s+6],23,76029189),a=c(a,i,n,o,t[s+9],4,-640364487),o=c(o,a,i,n,t[s+12],11,-421815835),n=c(n,o,a,i,t[s+15],16,530742520),i=c(i,n,o,a,t[s+2],23,-995338651),a=u(a,i,n,o,t[s+0],6,-198630844),o=u(o,a,i,n,t[s+7],10,1126891415),n=u(n,o,a,i,t[s+14],15,-1416354905),i=u(i,n,o,a,t[s+5],21,-57434055),a=u(a,i,n,o,t[s+12],6,1700485571),o=u(o,a,i,n,t[s+3],10,-1894986606),n=u(n,o,a,i,t[s+10],15,-1051523),i=u(i,n,o,a,t[s+1],21,-2054922799),a=u(a,i,n,o,t[s+8],6,1873313359),o=u(o,a,i,n,t[s+15],10,-30611744),n=u(n,o,a,i,t[s+6],15,-1560198380),i=u(i,n,o,a,t[s+13],21,1309151649),a=u(a,i,n,o,t[s+4],6,-145523070),o=u(o,a,i,n,t[s+11],10,-1120210379),n=u(n,o,a,i,t[s+2],15,718787259),i=u(i,n,o,a,t[s+9],21,-343485551),a=m(a,l),i=m(i,r),n=m(n,b),o=m(o,g)}return Array(a,i,n,o)}function r(t,e,a,i,n,o){return m(b(m(m(e,t),m(i,o)),n),a)}function d(t,e,a,i,n,o,s){return r(e&a|~e&i,t,e,n,o,s)}function p(t,e,a,i,n,o,s){return r(e&i|a&~i,t,e,n,o,s)}function c(t,e,a,i,n,o,s){return r(e^a^i,t,e,n,o,s)}function u(t,e,a,i,n,o,s){return r(a^(e|~i),t,e,n,o,s)}function m(t,e){var a=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(a>>16)<<16|65535&a}function b(t,e){return t<<e|t>>>32-e}function g(t,e){if(t){e=e||{timeout:3e3,type:"info"},e.timeout=void 0!==typeof e.timeout?e.timeout:3e3,e.type=void 0!==typeof e.type?e.type:"info";var a=document.createElement("div");a.className="toast__msg "+e.type;var i=document.createElement("i");i.className="material-icons",i.textContent=e.type;var n=document.createElement("span"),o=document.createElement("a");n.textContent=t,o.textContent="Dismiss",o.className="mdl-button",a.appendChild(i),a.appendChild(n),a.appendChild(o),y.appendChild(a),o.addEventListener("click",function(){event.target.parentNode.classList.add("toast__msg--hide"),event.target.parentNode.remove(1)}),setTimeout(function(){a.classList.add("toast__msg--hide"),a.remove(1)},e.timeout)}}function f(t,e){e||(e=window.location.href),t=t.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)"),i=a.exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}function v(t,e){return t.replace(/%s/g,e)}var h=0;t.hex_md5=e;var y=document.querySelector(".toast__container");t.toast=g,t.getParameterByName=f,t.sprintf=v}("undefined"==typeof window?module.exports:window),function(){app.isLtr=function(){return null===app.getSetting("settings.isLtr")||!!JSON.parse(String(app.getSetting("settings.isLtr")).toLowerCase())},app.preloadImage=function(t){t.setAttribute("src",t.getAttribute("data-src"))},app.escapeHtml=function(t){return"string"==typeof t&&(t=t.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")),t},app.urlBase64ToUint8Array=function(t){const e="=".repeat((4-t.length%4)%4),a=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),i=window.atob(a),n=new Uint8Array(i.length);for(var o=0;o<i.length;++o)n[o]=i.charCodeAt(o);return n},app.nl2br=function(t,e){var a=e||void 0===e?"<br />":"<br>";return(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+a+"$2")},app.fetchStatusHandler=function(t){if(t.headers.get("X-RateLimit-Limit")&&t.headers.get("X-RateLimit-Remaining")&&(app.RateLimit.Limit=t.headers.get("X-RateLimit-Limit"),app.RateLimit.Remaining=t.headers.get("X-RateLimit-Remaining"),app.RateLimit.Used=app.RateLimit.Limit-app.RateLimit.Remaining),200===t.status||201===t.status)return t;if(204===t.status)return t;if(400===t.status)return toast("Bad Request.",{timeout:3e3,type:"error"}),t;if(401===t.status||403===t.status)return app.sessionExpired(),t;if(404===t.status)return toast("There is an unknown resource that can't be loaded.",{timeout:3e3,type:"error"}),t;if(409===t.status)return toast("Revision is conflictual.",{timeout:3e3,type:"error"}),t;if(412===t.status)return toast("Precondition Failed",{timeout:3e3,type:"error"}),t;if(429===t.status)return toast("Oups, over quota.",{timeout:3e3,type:"error"}),t;throw new Error(t.statusText)},app.fetchStatusHandlerOnUser=function(t){if(t.headers.get("X-RateLimit-Limit")&&t.headers.get("X-RateLimit-Remaining")&&(app.RateLimit.Limit=t.headers.get("X-RateLimit-Limit"),app.RateLimit.Remaining=t.headers.get("X-RateLimit-Remaining"),app.RateLimit.Used=app.RateLimit.Limit-app.RateLimit.Remaining),200===t.status||201===t.status)return t;throw 409===t.status?new Error("Email already exists on t6, please Sign in."):new Error(t.statusText)},app.getUniqueId=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},app.setSetting=function(t,e){localStorage.setItem(t,e)},app.getSetting=function(t){return localStorage.getItem(t)},app.setLoginAction=function(){for(var t in app.buttons.loginButtons)app.buttons.loginButtons[t].childElementCount>-1&&(app.buttons.loginButtons[t].removeEventListener("click",app.onLoginButtonClick,!1),app.buttons.loginButtons[t].addEventListener("click",app.onLoginButtonClick,!1))},app.onLoginButtonClick=function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode;e.querySelector("form.signin button.login_button i.material-icons").textContent="cached",e.querySelector("form.signin button.login_button i.material-icons").classList.add("animatedIcon"),componentHandler.upgradeDom();var a=e.querySelector("form.signin input[name='username']").value,i=e.querySelector("form.signin input[name='password']").value;app.auth={username:a,password:i},app.authenticate(),t.preventDefault()},app.onStatusButtonClick=function(t){app.getStatus(),app.setSection("status"),t&&t.preventDefault()},app.onSettingsButtonClick=function(t){app.setSection("settings"),t&&t.preventDefault()},app.onDocsButtonClick=function(t){app.setSection("docs"),t&&t.preventDefault()},app.onTermsButtonClick=function(t){app.getTerms(),app.setSection("terms"),t&&t.preventDefault()},app.setSignupAction=function(){for(var t in app.buttons.user_create)app.buttons.user_create[t].childElementCount>-1&&app.buttons.user_create[t].addEventListener("click",app.onSignupButtonClick,!1)},app.setPasswordResetAction=function(){for(var t in app.buttons.user_setpassword)app.buttons.user_setpassword[t].childElementCount>-1&&app.buttons.user_setpassword[t].addEventListener("click",app.onPasswordResetButtonClick,!1)},app.setForgotAction=function(){for(var t in app.buttons.user_forgot)app.buttons.user_forgot[t].childElementCount>-1&&app.buttons.user_forgot[t].addEventListener("click",app.onForgotPasswordButtonClick,!1)},app.onSignupButtonClick=function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode;e.querySelector("form.signup button.createUser i.material-icons").textContent="cached",e.querySelector("form.signup button.createUser i.material-icons").classList.add("animatedIcon"),componentHandler.upgradeDom();var a=e.querySelector("form.signup input[name='email']").value,i=e.querySelector("form.signup input[name='terms']").checked;if(a&&a.match(app.patterns.username))if(i){var n=e.querySelector("form.signup input[name='firstName']").value,o=e.querySelector("form.signup input[name='lastName']").value,s={email:a,firstName:n,lastName:o};app.getSetting("settings.pushSubscription.endpoint")&&app.getSetting("settings.pushSubscription.keys.auth")&&app.getSetting("settings.pushSubscription.keys.p256dh")&&(s.pushSubscription={endpoint:app.getSetting("settings.pushSubscription.endpoint"),keys:{auth:app.getSetting("settings.pushSubscription.keys.auth"),p256dh:app.getSetting("settings.pushSubscription.keys.p256dh")}});var l=new Headers;l.append("Content-Type","application/json");var r={method:"POST",headers:l,body:JSON.stringify(s)},d=app.baseUrl+"/"+app.api_version+"/users";fetch(d,r).then(app.fetchStatusHandlerOnUser).then(function(t){return t.json()}).then(function(t){app.setSetting("notifications.email",t.user.data.attributes.email),app.setSetting("notifications.unsubscription_token",t.user.data.attributes.unsubscription_token),toast("Welcome, you should have received an email to set your password.",{timeout:3e3,type:"done"}),"undefined"!=typeof firebase&&firebase.analytics().logEvent("sign_up"),app.setSection("manage_notifications")}).catch(function(t){toast("We can't process your signup. Please resubmit the form later! "+t,{timeout:3e3,type:"warning"})})}else toast("Please read Terms & Conditions, you will be able to manage your privacy in the step right after.",{timeout:3e3,type:"warning"});else toast("We can't process your signup. Please check your inputs.",{timeout:3e3,type:"warning"});t.preventDefault()},app.onPasswordResetButtonClick=function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode;e.querySelector("form.resetpassword button.setPassword i.material-icons").textContent="cached",e.querySelector("form.resetpassword button.setPassword i.material-icons").classList.add("animatedIcon"),componentHandler.upgradeDom();var a=e.querySelector("form.resetpassword input[name='password']").value,i=e.querySelector("form.resetpassword input[name='password2']").value,n=getParameterByName("token");if(void 0!==n&&a==i){var o=new Headers;o.append("Content-Type","application/json");var s={method:"POST",headers:o,body:JSON.stringify({password:a})},l=app.baseUrl+"/"+app.api_version+"/users/token/"+n;fetch(l,s).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("login"),toast("Your password has been reset; please login again.",{timeout:3e3,type:"done"})}).catch(function(t){toast("We can't process your password reset. Please resubmit the form later!",{timeout:3e3,type:"warning"})})}else toast("We can't process your password reset.",{timeout:3e3,type:"warning"});t.preventDefault()},app.onForgotPasswordButtonClick=function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode;e.querySelector("form.forgotpassword button.forgotPassword i.material-icons").textContent="cached",e.querySelector("form.forgotpassword button.forgotPassword i.material-icons").classList.add("animatedIcon"),componentHandler.upgradeDom();var a=e.querySelector("form.forgotpassword input[name='email']").value;if(a&&a.match(app.patterns.username)){var i=new Headers;i.append("Content-Type","application/json");var n={method:"POST",headers:i,body:JSON.stringify({email:a})},o=app.baseUrl+"/"+app.api_version+"/users/instruction/";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("login"),toast("Instructions has been sent to your email.",{timeout:3e3,type:"done"})}).catch(function(t){toast("We can't process your request. Please resubmit the form later!",{timeout:3e3,type:"warning"})})}else toast("We can't send the instructions. Please check your inputs.",{timeout:3e3,type:"warning"});t.preventDefault()},app.askPermission=function(){return new Promise(function(t,e){const a=Notification.requestPermission(function(e){t(e)});a&&a.then(t,e)}).then(function(t){if("granted"!==t)throw new Error("We weren't granted permission.")})},app.registerServiceWorker=function(){return navigator.serviceWorker.register("/service-worker.js",{scope:"/"}).then(function(t){return"true"==localStorage.getItem("settings.debug")&&console.log("[ServiceWorker] Registered with scope:",t.scope),"object"==typeof firebase&&"undefined"!=typeof firebase||"object"==typeof firebase.apps||"number"==typeof firebase.apps.length||firebase.initializeApp(firebaseConfig),firebase.messaging().useServiceWorker(t),"true"==localStorage.getItem("settings.debug")&&console.log("[pushSubscription]",firebase.messaging().getToken()),firebase.analytics(),t}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&console.log("[ServiceWorker] error occured..."+t)})},app.subscribeUserToPush=function(){return app.registerServiceWorker().then(function(t){const e={userVisibleOnly:!0,applicationServerKey:app.urlBase64ToUint8Array(app.applicationServerKey)};return!!t&&t.pushManager.subscribe(e)}).then(function(t){var e=JSON.parse(JSON.stringify(t));return e&&e.keys&&(app.setSetting("settings.pushSubscription.endpoint",e.endpoint),app.setSetting("settings.pushSubscription.keys.p256dh",e.keys.p256dh),app.setSetting("settings.pushSubscription.keys.auth",e.keys.auth)),"true"==localStorage.getItem("settings.debug")&&console.log("[pushSubscription]",e),t}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&console.log("[pushSubscription]","subscribeUserToPush"+t)})},app.onSaveProfileButtonClick=function(t){var e=document.getElementById("firstName").value,a=document.getElementById("lastName").value,i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"PUT",headers:i,body:JSON.stringify({firstName:e,lastName:a})},o=app.baseUrl+"/"+app.api_version+"/users/"+localStorage.getItem("currentUserId");fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){localStorage.setItem("currentUserName",e+" "+a),app.setDrawer(),toast("Your details have been updated.",{timeout:3e3,type:"done"})}).catch(function(t){toast("We can't process your modifications. Please resubmit the form later!",{timeout:3e3,type:"warning"})})},app.refreshButtonsSelectors=function(){componentHandler&&componentHandler.upgradeDom(),app.buttons={notification:document.querySelector("button#notification"),menuTabBar:document.querySelectorAll(".mdl-layout__tab-bar a"),status:document.querySelectorAll(".statusButton"),settings:document.querySelectorAll(".settingsButton"),docs:document.querySelectorAll(".docsButton"),terms:document.querySelectorAll(".termsButton"),notifications:document.querySelectorAll("form.notifications input.mdl-checkbox__input"),loginButtons:document.querySelectorAll("form.signin button.login_button"),user_create:document.querySelectorAll("form.signup button.createUser"),user_setpassword:document.querySelectorAll("form.resetpassword button.setPassword"),user_forgot:document.querySelectorAll("form.forgotpassword button.forgotPassword"),expandButtons:document.querySelectorAll(".showdescription_button"),expandSourceButtons:document.querySelectorAll(".showsource_button"),object_create:document.querySelectorAll(".showdescription_button"),deleteObject:document.querySelectorAll("#objects .delete-button"),deleteObject2:document.querySelectorAll("#objects .delete-button"),editObject:document.querySelectorAll("#objects .edit-button"),createObject:document.querySelector("#objects button#createObject"),saveObject:document.querySelector("#object section.fixedActionButtons button.save-button"),backObject:document.querySelector("#object section.fixedActionButtons button.back-button"),editObject2:document.querySelector("#object section.fixedActionButtons button.edit-button"),listObject:document.querySelector("#object section.fixedActionButtons button.list-button"),viewuiObject:document.querySelector("#object section.fixedActionButtons button.viewui-button"),addObject:document.querySelector("#object_add section.fixedActionButtons button.add-button"),addObjectBack:document.querySelector("#object_add section.fixedActionButtons button.back-button"),deleteFlow:document.querySelectorAll("#flows .delete-button"),editFlow:document.querySelectorAll("#flows .edit-button"),createFlow:document.querySelector("#flows button#createFlow"),addFlow:document.querySelector("#flow_add section.fixedActionButtons button.add-button"),addFlowBack:document.querySelector("#flow_add section.fixedActionButtons button.back-button"),saveFlow:document.querySelector("#flow section.fixedActionButtons button.save-button"),backFlow:document.querySelector("#flow section.fixedActionButtons button.back-button"),editFlow2:document.querySelector("#flow section.fixedActionButtons button.edit-button"),listFlow:document.querySelector("#flow section.fixedActionButtons button.list-button"),deleteDashboard:document.querySelectorAll("#dashboards .delete-button"),editDashboard:document.querySelectorAll("#dashboards .edit-button"),createDashboard:document.querySelector("#dashboards button#createDashboard"),addDashboard:document.querySelector("#dashboard_add section.fixedActionButtons button.add-button"),addDashboardBack:document.querySelector("#dashboard_add section.fixedActionButtons button.back-button"),backDashboard:document.querySelector("#dashboard section.fixedActionButtons button.back-button"),saveDashboard:document.querySelector("#dashboard section.fixedActionButtons button.save-button"),editDashboard2:document.querySelector("#dashboard section.fixedActionButtons button.edit-button"),listDashboard:document.querySelector("#dashboard section.fixedActionButtons button.list-button"),deleteSnippet:document.querySelectorAll("#snippets .delete-button"),editSnippet:document.querySelectorAll("#snippets .edit-button"),createSnippet:document.querySelector("#snippets button#createSnippet"),addSnippet:document.querySelector("#snippet_add section.fixedActionButtons button.add-button"),addSnippetBack:document.querySelector("#snippet_add section.fixedActionButtons button.back-button"),backSnippet:document.querySelector("#snippet section.fixedActionButtons button.back-button"),saveSnippet:document.querySelector("#snippet section.fixedActionButtons button.save-button"),listSnippet:document.querySelector("#snippet section.fixedActionButtons button.list-button"),editSnippet2:document.querySelector("#snippet section.fixedActionButtons button.edit-button"),deleteRule:document.querySelectorAll("#rules .delete-button"),editRule:document.querySelectorAll("#rules .edit-button"),createRule:document.querySelector("#rules button#createRule"),addRule:document.querySelector("#rule_add section.fixedActionButtons button.add-button"),addRuleBack:document.querySelector("#rule_add section.fixedActionButtons button.back-button"),backRule:document.querySelector("#rule section.fixedActionButtons button.back-button"),saveRule:document.querySelector("#rule section.fixedActionButtons button.save-button"),listRule:document.querySelector("#rule section.fixedActionButtons button.list-button"),editRule2:document.querySelector("#rule section.fixedActionButtons button.edit-button"),deleteMqtt:document.querySelectorAll("#mqtts .delete-button"),editMqtt:document.querySelectorAll("#mqtts .edit-button"),createMqtt:document.querySelector("#mqtts button#createMqtt"),deleteSource:document.querySelectorAll("#sources .delete-button"),editSource:document.querySelectorAll("#sources .edit-button"),createSource:document.querySelector("#sources button#createSource"),addSource:document.querySelector("#source_add section.fixedActionButtons button.add-button"),addSourceBack:document.querySelector("#source_add section.fixedActionButtons button.back-button"),backSource:document.querySelector("#source section.fixedActionButtons button.back-button"),saveSource:document.querySelector("#source section.fixedActionButtons button.save-button"),listSource:document.querySelector("#source section.fixedActionButtons button.list-button"),editSource2:document.querySelector("#source section.fixedActionButtons button.edit-button"),buildSource:document.querySelector("#source section.fixedActionButtons button.build-button"),deploySource:document.querySelector("#source section.fixedActionButtons button.deploy-button"),editSourceChild:document.querySelectorAll("#source section button.child_edit_btn"),link_offSourceObject:document.querySelectorAll("#source section button.object_link_off_btn"),editSourceObject:document.querySelectorAll("#source section button.object_edit_btn"),deploySourceObject:document.querySelectorAll("#source section button.object_deploy_btn, #object section button.object_deploy_btn"),buildSourceObject:document.querySelectorAll("#source section button.object_build_btn, #object section button.object_build_btn")}},app.refreshContainers=function(){app.containers={spinner:document.querySelector("section#loading-spinner"),index:document.querySelector("section#index"),profile:document.querySelector("section#profile"),settings:document.querySelector("section#settings"),status:document.querySelector("section#status"),terms:document.querySelector("section#terms"),docs:document.querySelector("section#docs"),usersList:document.querySelector("section#users-list"),compatibleDevices:document.querySelector("section#compatible-devices"),openSourceLicenses:document.querySelector("section#openSourceLicenses"),objects:document.querySelector("section#objects"),object:document.querySelector("section#object"),object_add:document.querySelector("section#object_add"),flows:document.querySelector("section#flows"),flow:document.querySelector("section#flow"),flow_add:document.querySelector("section#flow_add"),dashboards:document.querySelector("section#dashboards"),dashboard:document.querySelector("section#dashboard"),dashboard_add:document.querySelector("section#dashboard_add"),snippets:document.querySelector("section#snippets"),snippet:document.querySelector("section#snippet"),snippet_add:document.querySelector("section#snippet_add"),rules:document.querySelector("section#rules"),rule:document.querySelector("section#rule"),rule_add:document.querySelector("section#rule_add"),mqtts:document.querySelector("section#mqtts"),mqtt:document.querySelector("section#mqtt"),mqtt_add:document.querySelector("section#mqtt_add"),sources:document.querySelector("section#sources"),source:document.querySelector("section#source"),source_add:document.querySelector("section#source_add"),menuIconElement:document.querySelector(".mdl-layout__drawer-button"),menuElement:document.getElementById("drawer"),menuOverlayElement:document.querySelector(".menu__overlay"),drawerObfuscatorElement:document.getElementsByClassName("mdl-layout__obfuscator")[0],menuItems:document.querySelectorAll(".mdl-layout__drawer nav a.mdl-navigation__link"),menuTabItems:document.querySelectorAll(".mdl-layout__tab-bar a.mdl-navigation__link.mdl-layout__tab")}},app.refreshContainers(),app.setExpandAction=function(){componentHandler.upgradeDom(),app.refreshButtonsSelectors();for(var t in app.buttons.expandButtons)app.buttons.expandButtons[t].childElementCount>-1&&app.buttons.expandButtons[t].addEventListener("click",app.expand,!1)},app.expand=function(t){var e=null!=t.target.parentElement.getAttribute("for")?t.target.parentElement.getAttribute("for"):t.target.getAttribute("for");null!=e&&(document.getElementById(e).classList.toggle("hidden"),"expand_more"==t.target.parentElement.querySelector("i.material-icons").innerHTML?t.target.parentElement.querySelector("i.material-icons").innerHTML="expand_less":t.target.parentElement.querySelector("i.material-icons").innerHTML="expand_more")},app.initNewSection=function(t){if(!document.getElementById(t)){let a=document.createElement("section");if(a.setAttribute("id",t),a.classList.add("mdl-tabs__panel","mdl-layout__tab-panel","is-inactive"),app.sectionsPageTitles[t]){let i=document.createElement("h2");i.classList.add("mdl-card__title-text","mdl-subheader-content");var e=document.createTextNode(app.sectionsPageTitles[t].replace(/%s/g,""));i.appendChild(e);let n=document.createElement("div");n.classList.add("mdl-grid","mdl-cell--12-col"),n.appendChild(i),a.appendChild(n)}let i=document.createElement("div");i.classList.add("page-content","mdl-grid","mdl-grid--no-spacing"),a.appendChild(i);let n=document.getElementsByClassName("mdl-layout__content")[0];n.appendChild(a),app.refreshContainers()}},app.setSection=function(t,e){if(t=t.split("?")[0],app.initNewSection(t),"true"==localStorage.getItem("settings.debug")&&console.log("[setSection]",t),window.scrollTo(0,0),"public-object"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}
""==i.id?app.setSection("objects"):i.id&&app.resources.objects.display(i.id,!1,!1,!0)}}else if("object"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}""==i.id?app.setSection("objects"):i.id&&app.resources.objects.display(i.id,!1,!1,!1)}}else if("object_add"===t)app.resources.objects.displayAdd(app.defaultResources.object,!0,!1,!1);else if("edit-object"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}""==i.id?app.setSection("objects"):i.id&&app.resources.objects.display(i.id,!1,!0,!1)}}else if("flow"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}""==i.id?app.setSection("flows"):i.id&&app.resources.flows.display(i.id,!1,!1,!1)}}else if("flow_add"===t)document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.resources.flows.displayAdd(app.defaultResources.flow,!0,!1,!1);else if("snippet"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}""==i.id?app.setSection("snippets"):i.id&&app.resources.dashboards.display(i.id,!1,!1,!1)}}else if("snippet_add"===t)document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.resources.snippets.displayAdd(app.defaultResources.snippet,!0,!1,!1);else if("dashboard"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}""==i.id?app.setSection("dashboards"):i.id&&app.resources.dashboards.display(i.id,!1,!1,!1)}}else if("dashboard_add"===t)document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.resources.dashboards.displayAdd(app.defaultResources.dashboard,!0,!1,!1);else if("rule"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}""==i.id?app.setSection("rules"):i.id&&app.resources.rules.display(i.id,!1,!1,!1)}}else if("rule_add"===t)document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.resources.rules.displayAdd(app.defaultResources.rule,!0,!1,!1);else if("mqtt"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}""==i.id?app.setSection("mqtts"):i.id&&app.resources.mqtts.display(i.id,!1,!1,!1)}}else if("mqtt_add"===t)document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.resources.mqtts.displayAdd(app.defaultResources.mqtt,!0,!1,!1);else if("source"===t){var a=new URLSearchParams(window.location.search),i={};if(Array.from(a).length>-1){for(let t of a){var n=t[0];i[n]=t[1]}""==i.id?app.setSection("sources"):i.id&&app.resources.sources.display(i.id,!1,!1,!1)}}else"source_add"===t?(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.resources.sources.displayAdd(app.defaultResources.source,!0,!1,!1)):"profile"===t?(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.containers.profile.querySelector(".page-content").innerHTML="",app.fetchProfile()):"settings"===t?(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.getSettings()):"login"===t?(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.displayLoginForm(document.querySelector("#login").querySelector(".page-content"))):"users-list"===t?(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.getUsersList()):"compatible-devices"===t?(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.getCompatibleDevices()):"openSourceLicenses"===t?(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.getOpenSourceLicenses()):"manage_notifications"===t?(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,void 0!==l&&l.analytics().logEvent("manage_notifications")):(document.title=void 0!==app.sectionsPageTitles[t]?app.sectionsPageTitles[t]:app.defaultPageTitle,window.location.hash="#"+t,app.fetchItemsPaginated(t,void 0,app.itemsPage[t],app.itemsSize[t]));app.refreshButtonsSelectors();var o=document.querySelectorAll("section.is-active");for(var s in o)o[s].childElementCount>-1&&(o[s].classList.remove("is-active"),o[s].classList.add("is-inactive"));for(var s in app.buttons.menuTabBar)app.buttons.menuTabBar[s].childElementCount>-1&&(app.buttons.menuTabBar[s].classList.remove("is-active"),app.buttons.menuTabBar[s].getAttribute("for")!=t&&app.buttons.menuTabBar[s].getAttribute("for")!=t+"s"||app.buttons.menuTabBar[s].classList.add("is-active"));if(document.querySelector("#"+t)&&(document.querySelector("#"+t).style.transform="ltr"==e?"translateX(-120%) !important":"translateX(120%) !important",document.querySelector("#"+t).classList.remove("is-inactive"),document.querySelector("#"+t).classList.add("is-active"),app.isLogged||document.querySelector("#"+t).querySelector(".page-content form.signin")||"signup"===t||"reset-password"===t||"forgot-password"===t||"settings"===t||"docs"===t||"terms"===t||"compatible-devices"===t||"openSourceLicenses"===t||"manage_notifications"===t||"use-cases"===t||app.displayLoginForm(document.querySelector("#"+t).querySelector(".page-content"))),app.currentSection=t,void 0===l)var l={};"object"!=typeof l&&"object"!=typeof l.apps&&"number"!=typeof l.apps.length&&l.analytics().setCurrentScreen(t,null),void 0!==Tawk_API&&"function"==typeof Tawk_API.setAttributes&&Tawk_API.addEvent("setCurrentScreen",{screen:t},function(t){})},app.setItemsClickAction=function(t){"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG setItemsClickAction",t);var e=document.querySelectorAll("[data-action='view']");for(var a in e)if("objects"==t&&void 0!==e[a]&&e[a].childElementCount>-1&&e[a].getAttribute("data-type")==t){e[a].querySelector("div.mdl-card__title").addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.objects.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1});var i=e[a].querySelectorAll("div.mdl-list__item--three-line");Array.from(i).forEach(function(t){t.addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.objects.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1})})}else if("flows"==t&&void 0!==e[a]&&e[a].childElementCount>-1&&e[a].getAttribute("data-type")==t){e[a].querySelector("div.mdl-card__title").addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.flows.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1});var i=e[a].querySelectorAll("div.mdl-list__item--three-line");Array.from(i).forEach(function(t){t.addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.flows.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1})})}else if("dashboards"==t&&void 0!==e[a]&&e[a].childElementCount>-1&&e[a].getAttribute("data-type")==t){e[a].querySelector("div.mdl-card__title").addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.dashboards.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1});var i=e[a].querySelectorAll("div.mdl-list__item--three-line");Array.from(i).forEach(function(t){t.addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.dashboards.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1})})}else if("snippets"==t&&void 0!==e[a]&&e[a].childElementCount>-1&&e[a].getAttribute("data-type")==t){e[a].querySelector("div.mdl-card__title").addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.snippets.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1});var i=e[a].querySelectorAll("div.mdl-list__item--three-line");Array.from(i).forEach(function(t){t.addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.snippets.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1})})}else if("rules"==t&&void 0!==e[a]&&e[a].childElementCount>-1&&e[a].getAttribute("data-type")==t){e[a].querySelector("div.mdl-card__title").addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.rules.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1});var i=e[a].querySelectorAll("div.mdl-list__item--three-line");Array.from(i).forEach(function(t){t.addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.rules.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1})})}else if("sources"==t&&void 0!==e[a]&&e[a].childElementCount>-1&&e[a].getAttribute("data-type")==t){e[a].querySelector("div.mdl-card__title").addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.sources.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1});var i=e[a].querySelectorAll("div.mdl-list__item--three-line");Array.from(i).forEach(function(t){t.addEventListener("click",function(t){var e=t.currentTarget.parentNode.parentNode;e.classList.add("is-hover"),app.resources.sources.display(e.dataset.id,!1,!1,!1),t.preventDefault()},{passive:!1})})}var n=document.querySelectorAll("button.swapDate");for(var o in n)void 0!==n[o]&&n[o].childElementCount>-1&&n[o].addEventListener("click",function(t){var e=t.currentTarget.dataset.id,a=document.querySelector("div[data-id='"+e+"'] span[data-date='created']").classList,i=document.querySelector("div[data-id='"+e+"'] span[data-date='updated']").classList;a.contains("visible")?(a.add("hidden"),a.remove("visible"),i.add("visible"),i.remove("hidden")):(a.add("visible"),a.remove("hidden"),i.add("hidden"),i.remove("visible"))},{passive:!1});var s=document.querySelectorAll("button.lazyloading");for(var l in s)void 0!==s[l]&&s[l].childElementCount>-1&&s[l].addEventListener("click",function(t){var e=t.currentTarget.dataset.size,a=t.currentTarget.dataset.page,i=t.currentTarget.dataset.type;app.itemsPage[i]=a,app.itemsSize[i]=e,app.fetchItemsPaginated(i,void 0,app.itemsPage[i],app.itemsSize[i])},{passive:!1})},app.showModal=function(){dialog.style.display="block",dialog.style.position="fixed",dialog.style.top="20%",dialog.style.zIndex="9999"},app.hideModal=function(){dialog.style.display="none",dialog.style.zIndex="-9999"},app.copyTextToClipboard=function(t,e){if(!navigator.clipboard){var a=e.currentTarget.parentNode.querySelector(".copytextarea");return a.focus(),a.select(),document.execCommand("copy")?(toast(t+" has been copied to clipboard.",{timeout:3e3,type:"done"}),!0):(toast("Could not copy text: "+t,{timeout:5e3,type:"warning"}),!1)}navigator.clipboard.writeText(t).then(function(){return toast(t+" has been copied to clipboard.",{timeout:3e3,type:"done"}),!0},function(e){return"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG clipboard","Could not copy text: ",e),toast("Could not copy text: "+t,{timeout:5e3,type:"warning"}),!1})},app.setListActions=function(t){app.refreshButtonsSelectors();for(var e=document.getElementById("dialog"),a=document.querySelectorAll(".copy-button"),i=0;i<a.length;i++)a[i].addEventListener("click",function(t){var e=t.currentTarget.dataset.id;app.copyTextToClipboard(e,t),t.preventDefault()});if("objects"===t){for(var n=0;n<app.buttons.deleteObject.length;n++)app.buttons.deleteObject[n].addEventListener("click",function(t){e.querySelector("h3").innerHTML='<i class="material-icons md-48">'+app.icons.delete_question+"</i> Delete Object",e.querySelector(".mdl-dialog__content").innerHTML='<p>Do you really want to delete "'+t.target.parentNode.dataset.name+'"?</p>',e.querySelector(".mdl-dialog__actions").innerHTML='<button class="mdl-button btn danger yes-button">Yes</button> <button class="mdl-button cancel-button">No, Cancel</button>',app.showModal();var a=t.target.parentNode.dataset.id;t.preventDefault(),e.querySelector(".cancel-button").addEventListener("click",function(e){app.hideModal(),t.preventDefault()}),e.querySelector(".yes-button").addEventListener("click",function(e){app.hideModal();var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"DELETE",headers:i},o=app.baseUrl+"/"+app.api_version+"/objects/"+a;fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){document.querySelector('[data-id="'+a+'"]').classList.add("removed"),toast("Object has been deleted.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Object has not been deleted.",{timeout:3e3,type:"error"})}),t.preventDefault()})});for(var o=0;o<app.buttons.editObject.length;o++)app.buttons.editObject[o].addEventListener("click",function(t){app.resources.objects.display(t.currentTarget.dataset.id,!1,!0,!1),t.preventDefault()})}else if("flows"===t){for(var n=0;n<app.buttons.deleteFlow.length;n++)app.buttons.deleteFlow[n].addEventListener("click",function(t){e.querySelector("h3").innerHTML='<i class="material-icons md-48">'+app.icons.delete_question+"</i> Delete Flow",e.querySelector(".mdl-dialog__content").innerHTML='<p>Do you really want to delete "'+t.target.parentNode.dataset.name+"\"? This action will remove all datapoints in the flow and can't be recovered.</p>",e.querySelector(".mdl-dialog__actions").innerHTML='<button class="mdl-button btn danger yes-button">Yes</button> <button class="mdl-button cancel-button">No, Cancel</button>',app.showModal();var a=t.target.parentNode.dataset.id;t.preventDefault(),e.querySelector(".cancel-button").addEventListener("click",function(e){app.hideModal(),t.preventDefault()}),e.querySelector(".yes-button").addEventListener("click",function(e){app.hideModal();var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"DELETE",headers:i},o=app.baseUrl+"/"+app.api_version+"/flows/"+a;fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){document.querySelector('[data-id="'+a+'"]').classList.add("removed"),app.resources.flows.onDelete(a),toast("Flow has been deleted.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Flow has not been deleted.",{timeout:3e3,type:"error"})}),t.preventDefault()})});for(var o=0;o<app.buttons.editFlow.length;o++)app.buttons.editFlow[o].addEventListener("click",function(t){app.resources.flows.display(t.currentTarget.dataset.id,!1,!0,!1),t.preventDefault()})}else if("dashboards"===t){for(var n=0;n<app.buttons.deleteDashboard.length;n++)app.buttons.deleteDashboard[n].addEventListener("click",function(t){e.querySelector("h3").innerHTML='<i class="material-icons md-48">'+app.icons.delete_question+"</i> Delete Dashboard",e.querySelector(".mdl-dialog__content").innerHTML='<p>Do you really want to delete "'+t.target.parentNode.dataset.name+'"?</p>',e.querySelector(".mdl-dialog__actions").innerHTML='<button class="mdl-button btn danger yes-button">Yes</button> <button class="mdl-button cancel-button">No, Cancel</button>',app.showModal();var a=t.target.parentNode.dataset.id;t.preventDefault(),e.querySelector(".cancel-button").addEventListener("click",function(e){app.hideModal(),t.preventDefault()}),e.querySelector(".yes-button").addEventListener("click",function(e){app.hideModal();var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"DELETE",headers:i},o=app.baseUrl+"/"+app.api_version+"/dashboards/"+a;fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){document.querySelector('[data-id="'+a+'"]').classList.add("removed"),toast("Dashboard has been deleted.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Dashboard has not been deleted.",{timeout:3e3,type:"error"})}),t.preventDefault()})});for(var n=0;n<app.buttons.editDashboard.length;n++)app.buttons.editDashboard[n].addEventListener("click",function(t){app.resources.dashboards.display(t.currentTarget.dataset.id,!1,!0,!1),t.preventDefault()})}else if("snippets"===t){for(var n=0;n<app.buttons.deleteSnippet.length;n++)app.buttons.deleteSnippet[n].addEventListener("click",function(t){e.querySelector("h3").innerHTML='<i class="material-icons md-48">'+app.icons.delete_question+"</i> Delete Snippet",e.querySelector(".mdl-dialog__content").innerHTML='<p>Do you really want to delete "'+t.target.parentNode.dataset.name+'"? This action will remove all reference to the Snippet in Dashboards.</p>',e.querySelector(".mdl-dialog__actions").innerHTML='<button class="mdl-button btn danger yes-button">Yes</button> <button class="mdl-button cancel-button">No, Cancel</button>',app.showModal();var a=t.target.parentNode.dataset.id;t.preventDefault(),e.querySelector(".cancel-button").addEventListener("click",function(e){app.hideModal(),t.preventDefault()}),e.querySelector(".yes-button").addEventListener("click",function(e){app.hideModal();var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"DELETE",headers:i},o=app.baseUrl+"/"+app.api_version+"/snippets/"+a;fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){document.querySelector('[data-id="'+a+'"]').classList.add("removed"),app.resources.snippets.onDelete(a),toast("Snippet has been deleted.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Snippet has not been deleted.",{timeout:3e3,type:"error"})}),t.preventDefault()})});for(var s=0;s<app.buttons.editSnippet.length;s++)app.buttons.editSnippet[s].addEventListener("click",function(t){app.resources.snippets.display(t.currentTarget.dataset.id,!1,!0,!1),t.preventDefault()})}else if("rules"===t){for(var n=0;n<app.buttons.deleteRule.length;n++)app.buttons.deleteRule[n].addEventListener("click",function(t){e.querySelector("h3").innerHTML='<i class="material-icons md-48">'+app.icons.delete_question+"</i> Delete rule",e.querySelector(".mdl-dialog__content").innerHTML='<p>Do you really want to delete "'+t.target.parentNode.dataset.name+'"? This action will remove all reference to the Rule in t6.</p>',e.querySelector(".mdl-dialog__actions").innerHTML='<button class="mdl-button btn danger yes-button">Yes</button> <button class="mdl-button cancel-button">No, Cancel</button>',app.showModal();var a=t.target.parentNode.dataset.id;t.preventDefault(),e.querySelector(".cancel-button").addEventListener("click",function(e){app.hideModal(),t.preventDefault()}),e.querySelector(".yes-button").addEventListener("click",function(e){app.hideModal();var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"DELETE",headers:i},o=app.baseUrl+"/"+app.api_version+"/rules/"+a;fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){document.querySelector('[data-id="'+a+'"]').classList.add("removed"),toast("Rule has been deleted.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Rule has not been deleted.",{timeout:3e3,type:"error"})}),t.preventDefault()})});for(var s=0;s<app.buttons.editRule.length;s++)app.buttons.editRule[s].addEventListener("click",function(t){app.resources.rules.display(t.currentTarget.dataset.id,!1,!0,!1),t.preventDefault()})}else if("mqtts"===t);else if("sources"===t){for(var n=0;n<app.buttons.deleteSource.length;n++)app.buttons.deleteSource[n].addEventListener("click",function(t){e.querySelector("h3").innerHTML='<i class="material-icons md-48">'+app.icons.delete_question+"</i> Delete source",e.querySelector(".mdl-dialog__content").innerHTML='<p>Do you really want to delete "'+t.target.parentNode.dataset.name+'"? This action will remove all reference to the Source in t6.</p>',e.querySelector(".mdl-dialog__actions").innerHTML='<button class="mdl-button btn danger yes-button">Yes</button> <button class="mdl-button cancel-button">No, Cancel</button>',app.showModal();var a=t.target.parentNode.dataset.id;t.preventDefault(),e.querySelector(".cancel-button").addEventListener("click",function(e){app.hideModal(),t.preventDefault()}),e.querySelector(".yes-button").addEventListener("click",function(e){app.hideModal();var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"DELETE",headers:i},o=app.baseUrl+"/"+app.api_version+"/sources/"+a;fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){document.querySelector('[data-id="'+a+'"]').classList.add("removed"),toast("Source has been deleted.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Source has not been deleted.",{timeout:3e3,type:"error"})}),t.preventDefault()})});for(var s=0;s<app.buttons.editSource.length;s++)app.buttons.editSource[s].addEventListener("click",function(t){app.resources.sources.display(t.currentTarget.dataset.id,!1,!0,!1),t.preventDefault()})}},app.getSubtitle=function(t){var e="<section class='mdl-grid mdl-cell--12-col md-primary md-subheader _md md-altTheme-theme sticky' role='heading'>";return e+="\t<div class='md-subheader-inner'>",e+="\t\t<div class='mdl-subheader-content'>",e+="\t\t\t<span class='ng-scope'>"+t+"</span>",e+="\t\t</div>",e+="\t</div>",e+="</section>"},app.getUnits=function(){if("null"==localStorage.getItem("units")||!JSON.parse(localStorage.getItem("units"))){var t=new Headers;t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/units/";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(t.data){for(var e=0;e<t.data.length;e++){var a=t.data[e];app.units.push({name:a.id,value:a.attributes.type+" - "+a.attributes.name,format:a.attributes.format,system:a.attributes.system,description:a.attributes.description})}app.units=app.units.sort(function(t,e){return t.value.toLowerCase()<e.value.toLowerCase()?-1:t.value.toLowerCase()>e.value.toLowerCase()?1:0}),localStorage.setItem("units",JSON.stringify(app.units))}})}},app.getFlows=function(){if(0==app.flows.length&&(app.isLogged||localStorage.getItem("bearer"))){var t=new Headers;t.append("Content-Type","application/json"),t.append("Authorization","Bearer "+localStorage.getItem("bearer"));var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/flows/?size=99999";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(t.data){for(var e=0;e<t.data.length;e++){var a=t.data[e];app.flows.push({id:a.id,name:a.attributes.name,type:"flows"})}localStorage.setItem("flows",JSON.stringify(app.flows))}})}},app.getSnippets=function(){if(0==app.snippets.length&&(app.isLogged||localStorage.getItem("bearer"))){var t=new Headers;t.append("Content-Type","application/json"),t.append("Authorization","Bearer "+localStorage.getItem("bearer"));var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/snippets/?size=99999";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(t.data){for(var e=0;e<t.data.length;e++){var a=t.data[e];app.snippets.push({id:a.id,name:a.attributes.name,sType:a.attributes.type,type:"snippets"})}localStorage.setItem("snippets",JSON.stringify(app.snippets))}})}},app.getDatatypes=function(){if(0==app.datatypes.length){var t=new Headers;t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/datatypes/";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(t.data){for(var e=0;e<t.data.length;e++){var a=t.data[e];app.datatypes.push({name:a.id,value:a.attributes.name})}app.datatypes=app.datatypes.sort(function(t,e){return t.value.toLowerCase()<e.value.toLowerCase()?-1:t.value.toLowerCase()>e.value.toLowerCase()?1:0}),localStorage.setItem("datatypes",JSON.stringify(app.datatypes))}})}},app.getSources=function(){if(app.isLogged||localStorage.getItem("bearer")){var t=new Headers;t.append("Content-Type","application/json"),t.append("Authorization","Bearer "+localStorage.getItem("bearer"));var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/sources/?size=99999";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(t.data){app.sources=new Array;for(var e=0;e<t.data.length;e++){var a=t.data[e];app.sources.push({id:a.id,name:a.attributes.name,version:a.attributes.version,subversions:a.attributes.subversions})}localStorage.setItem("sources",JSON.stringify(app.sources))}})}},app.getCard=function(t){var e="";return e+=void 0!==t.className?'<div class="'+t.className+'">':'<div class="mdl-grid mdl-cell">',e+='\t<div class="mdl-card mdl-shadow--2dp">',e+=t.image?'\t<div class="mdl-card__title" style="background:url('+t.image+') no-repeat 50% 50%;">':'\t<div class="mdl-card__title">',e+='\t\t\t<h3 class="mdl-card__title-text">'+t.title+"</h3>",e+="\t\t</div>",e+='  \t<div class="mdl-card__supporting-text mdl-card--expand">'+t.description+"</div>",(t.url||t.secondaryaction||t.action)&&(e+='  \t<div class="mdl-card__actions mdl-card--border">',t.url&&(e+='\t\t<a href="'+t.url+'"> Get Started</a>'),t.secondaryaction&&(e+='\t\t<a href="#" onclick="app.setSection(\''+t.secondaryaction.id+'\');" class="mdl-button mdl-button--colored"> '+t.secondaryaction.label+"</a>&nbsp;"),t.action&&!t.internalAction&&(e+='\t\t<button class="mdl-button mdl-js-button mdl-js-ripple-effect" onclick="app.setSection(\''+t.action.id+"');\"> "+t.action.label+"</button>"),t.internalAction&&(e+='\t\t<button class="mdl-button mdl-js-button mdl-js-ripple-effect" onclick="'+t.internalAction+'"> '+t.action.label+"</button>"),e+="\t\t</div>"),e+="\t\t</div>",e+="</div>"},app.displayChip=function(t){var e=document.createElement("div");return e.setAttribute("class","mdl-chip"),e.setAttribute("data-id",t.id),e.innerHTML="<i class='material-icons md-18'>"+app.icons[t.type]+"</i>"+t.name+"<i class='material-icons close'>close</i>",e.querySelector("i.close").addEventListener("click",function(t){t.preventDefault(),t.target.parentNode.remove()},!1),e},app.addChipTo=function(t,e){document.getElementById(t).append(app.displayChip(e))},app.displayChipSnippet=function(t){var e=document.createElement("div");return e.setAttribute("class","mdl-chip mdl-list__item"),e.setAttribute("style","width: 100%; text-overflow: ellipsis; display: flex;"),e.setAttribute("draggable",!0),e.setAttribute("data-id",t.id),e.setAttribute("data-stype",t.sType),e.innerHTML="<i class='md-36 grippy'></i><i class='material-icons md-36' id='type-"+t.id+"'>"+app.icons[t.type]+"</i> <div class='mdl-tooltip mdl-tooltip--top' for='type-"+t.id+"'>"+t.type+" ("+t.sType+")</div><span>"+t.name+" ("+t.sType+")</span><i class='material-icons close mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect' id='remove-"+t.id+"'>close</i> <div class='mdl-tooltip mdl-tooltip--top' for='remove-"+t.id+"'>Remove this "+t.type+"</div><i class='material-icons edit mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect' id='edit-"+t.id+"'>edit</i> <div class='mdl-tooltip mdl-tooltip--top' for='edit-"+t.id+"'>Edit this "+t.type+"</div>",e.querySelector("i.close").addEventListener("click",function(t){t.preventDefault(),t.target.parentNode.parentNode.remove()},!1),e.querySelector("i.edit").addEventListener("click",function(t){t.preventDefault(),app.resources.snippets.display(app.getSnippetIdFromIndex(t.target.parentNode.parentNode.getAttribute("data-id")),!1,!0,!1)},!1),e};var t=null;app.handleDragStart=function(e){t=this,e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",this.outerHTML),this.classList.add("dragElem")},app.handleDragOver=function(t){return t.preventDefault&&t.preventDefault(),this.classList.add("over"),t.dataTransfer.dropEffect="move",!1},app.handleDragEnter=function(t){},app.handleDragLeave=function(t){this.classList.remove("over")},app.handleDrop=function(e){if(e.stopPropagation&&e.stopPropagation(),t!=this){this.parentNode.removeChild(t);var a=e.dataTransfer.getData("text/html");this.insertAdjacentHTML("beforebegin",a);var i=this.previousSibling;app.addDnDHandlers(i)}return this.classList.remove("over"),!1},app.handleDragEnd=function(t){this.classList.remove("over")},app.addDnDHandlers=function(t){t.addEventListener("dragstart",app.handleDragStart,!1),t.addEventListener("dragenter",app.handleDragEnter,!1),t.addEventListener("dragover",app.handleDragOver,!1),t.addEventListener("dragleave",app.handleDragLeave,!1),t.addEventListener("drop",app.handleDrop,!1),t.addEventListener("dragend",app.handleDragEnd,!1)},app.addChipSnippetTo=function(t,e){document.getElementById(t).append(app.displayChipSnippet(e))},app.getSnippetIdFromIndex=function(t){return JSON.parse(localStorage.getItem("snippets"))[t].id},app.fetchItemsPaginated=function(t,e,a,i){let n=new Promise((n,o)=>{if("objects"!==t&&"flows"!==t&&"dashboards"!==t&&"snippets"!==t&&"rules"!==t&&"mqtts"!==t&&"sources"!==t)return n(),!1;app.initNewSection(t),i=void 0!==i?i:app.itemsSize[t],a=void 0!==a?a:app.itemsPage[t],app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var s=new Headers;s.append("Authorization","Bearer "+localStorage.getItem("bearer")),s.append("Content-Type","application/json");var l={method:"GET",headers:s},r={};if("objects"==t){var d=app.containers.objects.querySelector(".page-content"),p=app.baseUrl+"/"+app.api_version+"/objects";(a||i||e)&&(p+="?",void 0!==e&&(p+="name="+escape(e)+"&"),void 0!==a&&(p+="page="+a+"&"),void 0!==i&&(p+="size="+i+"&"));var c="My Objects";r=app.isLogged?{title:c,titlecolor:"#ffffff",description:"Hey, it looks you don't have any Object yet.",internalAction:!1,action:{id:"object_add",label:"<i class='material-icons'>add</i>Add my first Object"},className:"mdl-grid mdl-cell mdl-cell--12-col"}:{title:"Connected Objects",titlecolor:"#ffffff",description:"Connecting anything physical or virtual to t6 Api without any hassle. Embedded, Automatization, Domotic, Sensors, any Objects or Devices can be connected and communicate to t6 via RESTful API. Unic and dedicated application to rules them all and designed to simplify your journey.",className:"mdl-grid mdl-cell mdl-cell--12-col"}}else if("flows"==t){var d=app.containers.flows.querySelector(".page-content"),p=app.baseUrl+"/"+app.api_version+"/flows";(a||i||e)&&(p+="?",void 0!==e&&(p+="name="+escape(e)+"&"),void 0!==a&&(p+="page="+a+"&"),void 0!==i&&(p+="size="+i+"&"));var c="My Flows";r=app.isLogged?{title:c,titlecolor:"#ffffff",description:"Hey, it looks you don't have any Flow yet.",internalAction:!1,action:{id:"flow_add",label:"<i class='material-icons'>add</i>Add my first Flow"},className:"mdl-grid mdl-cell mdl-cell--12-col"}:{title:"Time-series Datapoints",titlecolor:"#ffffff",
description:"Communication becomes easy in the platform with Timestamped values. Flows allows to retrieve and classify data.",className:"mdl-grid mdl-cell mdl-cell--12-col"}}else if("dashboards"==t){var d=app.containers.dashboards.querySelector(".page-content"),p=app.baseUrl+"/"+app.api_version+"/dashboards";(a||i)&&(p+="?",void 0!==a&&(p+="page="+a+"&"),void 0!==i&&(p+="size="+i+"&"));var c="My Dashboards";r=app.isLogged?{title:c,titlecolor:"#ffffff",description:"Hey, it looks you don't have any dashboard yet.",internalAction:!1,action:{id:"dashboard_add",label:"<i class='material-icons'>add</i>Add my first Dashboard"},className:"mdl-grid mdl-cell mdl-cell--12-col"}:{title:"Dashboards",titlecolor:"#ffffff",description:"t6 support multiple Snippets to create your own IoT Dashboards for data visualization. Snippets are ready to Use Html components integrated into the application. Dashboards allows to empower your data-management by Monitoring and Reporting activities.",className:"mdl-grid mdl-cell mdl-cell--12-col"}}else if("snippets"==t){var d=app.containers.snippets.querySelector(".page-content"),p=app.baseUrl+"/"+app.api_version+"/snippets";(a||i)&&(p+="?",void 0!==a&&(p+="page="+a+"&"),void 0!==i&&(p+="size="+i+"&"));var c="My Snippets";r=app.isLogged?{title:c,titlecolor:"#ffffff",description:"Hey, it looks you don't have any snippet yet.",internalAction:!1,action:{id:"snippet_add",label:"<i class='material-icons'>add</i>Add my first Snippet"}}:{title:"Customize Snippets",titlecolor:"#ffffff",description:"Snippets are components to embed into your dashboards and displays your data",className:"mdl-grid mdl-cell mdl-cell--12-col"}}else if("rules"==t){var d=app.containers.rules.querySelector(".page-content"),p=app.baseUrl+"/"+app.api_version+"/rules";(a||i)&&(p+="?",void 0!==a&&(p+="page="+a+"&"),void 0!==i&&(p+="size="+i+"&"));var c="My Rules";r=app.isLogged?{title:c,titlecolor:"#ffffff",description:"Hey, it looks you don't have any rule yet.",internalAction:!1,action:{id:"rule_add",label:"<i class='material-icons'>add</i>Add my first Rule"},className:"mdl-grid mdl-cell mdl-cell--12-col"}:{title:"Decision Rules to get smart",titlecolor:"#ffffff",description:"Trigger action from Mqtt and decision-tree. Let's your Objects talk to the platform as events.",className:"mdl-grid mdl-cell mdl-cell--12-col"}}else if("mqtts"==t){var d=app.containers.mqtts.querySelector(".page-content"),p=app.baseUrl+"/"+app.api_version+"/mqtts";(a||i)&&(p+="?",void 0!==a&&(p+="page="+a+"&"),void 0!==i&&(p+="size="+i+"&"));var c="My Mqtts";r=app.isLogged?{title:c,titlecolor:"#ffffff",description:"Hey, it looks you don't have any mqtt topic yet.",action:{id:"mqtt_add",label:"<i class='material-icons'>add</i>Add my first Mqtt"},className:"mdl-grid mdl-cell mdl-cell--12-col"}:{title:"Sense events",titlecolor:"#ffffff",description:"Whether it's your own sensors or external Flows from Internet, sensors collect values and communicate them to t6.",className:"mdl-grid mdl-cell mdl-cell--12-col"}}else if("sources"==t){var d=app.containers.sources.querySelector(".page-content"),p=app.baseUrl+"/"+app.api_version+"/sources";(a||i)&&(p+="?",void 0!==a&&(p+="page="+a+"&"),void 0!==i&&(p+="size="+i+"&"));var c="My Sources";r=app.isLogged?{title:c,titlecolor:"#ffffff",description:"Hey, it looks you don't have any source yet.",action:{id:"source_add",label:"<i class='material-icons'>add</i>Add my first Source"},className:"mdl-grid mdl-cell mdl-cell--12-col"}:{title:"Code Source",titlecolor:"#ffffff",description:"Deploy Arduino source Over The Air.",className:"mdl-grid mdl-cell mdl-cell--12-col"}}else if("tokens"==t){var d=app.containers.tokens.querySelector(".page-content"),p=app.baseUrl+"/"+app.api_version+"/tokens";(a||i)&&(p+="?",void 0!==a&&(p+="page="+a+"&"),void 0!==i&&(p+="size="+i+"&"));var c="My tokens";r=app.isLogged?{title:c,titlecolor:"#ffffff",description:"Hey, it looks you don't have any token yet.",action:{id:"token_add",label:"<i class='material-icons'>add</i>Add my first Token"},className:"mdl-grid mdl-cell mdl-cell--12-col"}:{title:"Sense events",titlecolor:"#ffffff",description:"Whether it's your own sensors or external Flows from Internet, sensors collect values and communicate them to t6.",className:"mdl-grid mdl-cell mdl-cell--12-col"}}else if("status"==t){var d=(app.icons.status,app.containers.status.querySelector(".page-content"));r={},app.getStatus()}else"true"==localStorage.getItem("settings.debug")&&(console.log("DEBUG Error no Type defined: "+t),toast("Error no Type defined.",{timeout:3e3,type:"error"})),t=void 0;navigator.onLine?app.isLogged&&void 0!==t?fetch(p,l).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){if(1==a&&(d.innerHTML=""),!e.data||e.data&&0==e.data.length)d.innerHTML=app.getCard(r),app.displayLoginForm(d);else{for(var i=0;i<e.data.length;i++)d.innerHTML+=app.resources[t].displayItem(e.data[i]);app.showAddFAB(t),componentHandler.upgradeDom(),app.setItemsClickAction(t),app.setListActions(t),"snippets"==t?(app.snippets=[],e.data.map(function(t){app.snippets.push({id:t.id,name:t.attributes.name,sType:t.attributes.type,type:snippets.attributes.type})}),localStorage.setItem("snippets",JSON.stringify(app.snippets))):"flows"==t&&(app.flows=[],e.data.map(function(t){app.flows.push({id:t.id,name:t.attributes.name,type:t.attributes.type})}),localStorage.setItem("flows",JSON.stringify(app.flows)))}n()}).catch(function(e){"true"==localStorage.getItem("settings.debug")&&toast("fetchItemsPaginated "+t+" error occured..."+e,{timeout:3e3,type:"error"})}):(d.innerHTML=app.getCard(r),n()):d.innerHTML=app.getCard(app.offlineCard)});return app.containers.spinner.setAttribute("hidden",!0),app.containers.spinner.classList.add("hidden"),n},app.getUsersList=function(){app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var t=new Headers;t.append("Authorization","Bearer "+localStorage.getItem("bearer")),t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.containers.usersList.querySelector(".page-content"),i=app.baseUrl+"/"+app.api_version+"/users/list";fetch(i,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){var e="";document.title=app.sectionsPageTitles["users-list"];for(var i=0;i<t.data.length;i++){var n=t.data[i],o=t.links.meta.count-i;e+='<div class="mdl-grid mdl-cell" data-action="nothing" data-type="user" data-id="'+n.id+'">',e+='\t<div class="mdl-card mdl-shadow--2dp">',e+='\t\t<div class="mdl-card__title">',e+='\t\t\t<i class="material-icons">perm_identity</i>',e+='\t\t\t<h3 class="mdl-card__title-text">'+o+". "+n.attributes.first_name+" "+n.attributes.last_name+"</h3>",e+="\t\t</div>",e+='\t\t<div class="mdl-card__title"><img src="//secure.gravatar.com/avatar/'+hex_md5(n.attributes.email)+'" alt="" class="user-image"></div>',e+=app.getField("card_membership","User id",n.id,{type:"text",style:"text-transform: none !important;",isEdit:!1}),e+=app.getField("mail","Email",n.attributes.email,{type:"text",style:"text-transform: none !important;",isEdit:!1}),n.attributes.push_subscription&&"object"==typeof n.attributes.push_subscription&&"object"==typeof n.attributes.push_subscription.keys&&"string"==typeof n.attributes.push_subscription.keys.auth&&(e+=app.getField("sms","Push notification Auth",n.attributes.push_subscription.keys.auth,{type:"text",style:"text-transform: none !important;",isEdit:!1})),n.attributes.location&&(n.attributes.location.geo&&(e+=app.getField("dns","Location",n.attributes.location.geo.city+" ("+n.attributes.location.geo.country+")",{type:"text",isEdit:!1})),n.attributes.location.ip&&(e+=app.getField("dns","IP address",n.attributes.location.ip,{type:"text",isEdit:!1}))),e+=app.getField("contact_mail","Password last update",moment(n.attributes.password_last_updated/1).format(app.date_format),{type:"text",isEdit:!1}),e+=app.getField("contact_mail","Reminder Email",moment(n.attributes.reminder_mail/1).format(app.date_format),{type:"text",isEdit:!1}),e+=app.getField("change_history","Password reset request",moment(n.attributes.change_password_mail/1).format(app.date_format),{type:"text",isEdit:!1}),e+='\t\t<div class="mdl-card__actions mdl-card--border">',e+='\t\t\t<span class="pull-left mdl-card__date">',e+='\t\t\t\t<button data-id="'+n.id+'" class="swapDate mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',e+='\t\t\t\t\t<i class="material-icons">update</i>',e+="\t\t\t\t</button>",e+='\t\t\t\t<span data-date="created" class="visible">Subscribed on '+moment(n.attributes.subscription_date/1).format(app.date_format)+"</span>",e+='\t\t\t\t<span data-date="updated" class="hidden">Password last update on '+moment(n.attributes.password_last_updated/1).format(app.date_format)+"</span>",e+="\t\t\t</span>",e+="\t\t</div>",e+="\t</div>",e+="</div>"}a.innerHTML+=e,componentHandler.upgradeDom(),app.setItemsClickAction("usersList")}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("getUsersList error out..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},app.fetchProfile=function(){app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden"),app.initNewSection("profile");var t=new Headers;t.append("Authorization","Bearer "+localStorage.getItem("bearer")),t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.containers.profile.querySelector(".page-content"),i=app.baseUrl+"/"+app.api_version+"/users/me/token";fetch(i,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(navigator.onLine){var e=t.data,i=e.attributes.gravatar.entry[0],n="";n+='<section class="mdl-grid mdl-cell--12-col">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp card card-user">',n+=i.profileBackground?'\t<div class="card-heading heading-left" style="background: url(\''+i.profileBackground.url+"') 50% 50% !important\">":'\t<div class="card-heading heading-left" style="background: url(\''+app.baseUrlCdn+"/img/opl_img.webp') 50% 50% !important\">",n+='\t\t<img src="//secure.gravatar.com/avatar/'+hex_md5(e.attributes.email)+'" alt="" class="user-image">',n+='\t\t<h3 class="card-title text-color-white">'+e.attributes.first_name+" "+e.attributes.last_name+"</h3>",i.currentLocation&&(n+='\t\t<div class="subhead">',n+=i.currentLocation,n+="\t\t</div>"),n+="\t</div>",n+='\t<div class="card-body">',n+=app.getField("face","First name",e.attributes.first_name,{type:"input",id:"firstName",isEdit:!0,pattern:app.patterns.name,error:"Must be greater than 3 chars."}),n+=app.getField("face","Last name",e.attributes.last_name,{type:"input",id:"lastName",isEdit:!0,pattern:app.patterns.name,error:"Must be greater than 3 chars."}),n+=app.getField("lock","Email",e.attributes.email,{type:"text",id:"email",style:"text-transform: none !important;",isEdit:!1}),n+="\t</div>",n+='\t<div class="mdl-card__actions mdl-card--border">',n+='\t\t<a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" id="saveProfileButton"><i class="material-icons">edit</i>Save t6 profile</a>',n+="\t</div>",n+="</div>",n+="</section>",n+=app.getSubtitle("Gravatar contacts"),n+='<section class="mdl-grid mdl-cell--12-col">',n+='<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp card card-user">',n+='\t<div class="card-header heading-left">&nbsp;</div>',n+='\t<div class="card-body">';for(var o in i.phoneNumbers)n+=app.getField("phone",i.phoneNumbers[o].type,i.phoneNumbers[o].value,{type:"text",isEdit:!1});n+='\t\t<ul class="social-links">';for(var s in i.accounts)n+='\t\t<li><a href="'+i.accounts[s].url+'"><i class="material-icons mdl-textfield__icon">link</i><span class="mdl-list__item-sub-title">'+i.accounts[s].shortname+"</span></a></li>";n+="\t\t</ul>",n+="\t\t<ul class='social-links'>";for(var l in i.urls)n+='\t\t<li><a href="'+i.urls[l].value+'" target="_blank"><i class="material-icons">bookmark</i><span class="mdl-list__item-sub-title">'+i.urls[l].title+"</span></a></li>";n+="\t\t</ul>",n+="\t</div>",n+='\t<div class="mdl-card__actions mdl-card--border">',n+='\t\t<a class="mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect" href="'+i.profileUrl+'" target="_blank"><i class="material-icons">launch</i>Edit my gravatar</a>',n+="\t</div>",n+="</div>",n+="</section>",a.innerHTML=n,componentHandler.upgradeDom(),localStorage.setItem("currentUserId",e.id),localStorage.setItem("currentUserName",e.attributes.first_name+" "+e.attributes.last_name),localStorage.setItem("currentUserEmail",e.attributes.email),localStorage.setItem("notifications.email",e.attributes.email),localStorage.setItem("notifications.unsubscription_token",e.attributes.unsubscription_token),localStorage.setItem("currentUserHeader",i.photos[0].value),i.profileBackground&&i.profileBackground.url&&localStorage.setItem("currentUserBackground",i.profileBackground.url),app.gtm&&"true"!==app.getCookie("cookieconsentNoGTM")&&void 0!==self.dataLayer&&(self.dataLayer.push({userEmail:e.attributes.email,userRole:e.attributes.role,userId:e.id}),"undefined"==typeof firebase||firebase.apps.length||(firebase.analytics().setUserProperties({userId:e.id}),firebase.analytics().setUserProperties({userRole:e.attributes.role})),void 0!==Tawk_API&&"function"==typeof Tawk_API.setAttributes&&Tawk_API.setAttributes({name:e.attributes.first_name+" "+e.attributes.last_name,email:e.attributes.email},function(t){})),app.setDrawer(),app.fetchUnsubscriptions(),app.displayUnsubscriptions(app.containers.profile.querySelector(".page-content")),document.getElementById("saveProfileButton").addEventListener("click",function(t){app.onSaveProfileButtonClick(),t.preventDefault()}),"admin"!==e.attributes.role||document.querySelector('#drawer nav a.mdl-navigation__link[href="#users-list"]')||(localStorage.setItem("role","admin"),app.addMenuItem("Users Accounts","supervisor_account","#users-list",null))}else a.innerHTML=app.getCard(app.offlineCard)}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("fetchProfile error out..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},app.fetchUnsubscriptions=function(){var t=new Headers;t.append("Authorization","Bearer "+localStorage.getItem("bearer")),t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/notifications/list/unsubscribed";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){var e=void 0!==t.unsubscription?t.unsubscription:{};localStorage.setItem("notifications.unsubscribed",JSON.stringify(e))}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("fetchUnsubscriptions error"+t,{timeout:3e3,type:"error"})})},app.displayUnsubscriptions=function(t){var e=JSON.parse(app.getSetting("notifications.unsubscribed")),a="";a+=app.getSubtitle("Email Notifications"),a+='<section class="mdl-grid mdl-cell--12-col">',a+='<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp card card-user">',a+='\t<div class="card-header heading-left">&nbsp;</div>',a+='\t<div class="card-body">';var i;i=null!==e.reminder?"false":"true",a+=app.getField("mail_outline","Reminder Welcome email",i,{type:"switch",id:"profile.notifications.reminder",isEdit:!0}),i=null!==e.changePassword?"false":"true",a+=app.getField("mail_outline","Reminder to change Password",i,{type:"switch",id:"profile.notifications.changePassword",isEdit:!0}),i=null!==e.newsletter?"false":"true",a+=app.getField("mail_outline","t6 Newsletter",i,{type:"switch",id:"profile.notifications.newsletter",isEdit:!0}),a+=app.getField("mail_outline","Security notification related to your account",!0,{type:"switch",id:"profile.notifications.security",isEdit:!1}),a+="\t</div>",a+="</section>",t.innerHTML+=a,componentHandler.upgradeDom();let n=document.getElementById("switch-profile.notifications.reminder").parentNode;n&&n.addEventListener("change",function(t){if(app.getSetting("notifications.email")&&app.getSetting("notifications.unsubscription_token")){var e=n.classList.contains("is-checked")!==!1?"subscribe":"unsubscribe",a=new Headers;a.append("Content-Type","application/json");var i={method:"GET",headers:a},o=app.baseUrl+"/mail/"+app.getSetting("notifications.email")+"/"+e+"/reminder/"+app.getSetting("notifications.unsubscription_token")+"/";fetch(o,i).then(app.fetchStatusHandler).then(function(t){toast("Subscription reminder ("+e+") updated.",{timeout:3e3,type:"done"})}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("Error occured on saving Notifications..."+t,{timeout:3e3,type:"error"})})}else"true"==localStorage.getItem("settings.debug")&&toast("Error occured on saving Notifications...",{timeout:3e3,type:"error"})});var o=document.getElementById("switch-profile.notifications.changePassword").parentNode;o&&o.addEventListener("change",function(t){if(app.getSetting("notifications.email")&&app.getSetting("notifications.unsubscription_token")){var e="changePassword",a=o.classList.contains("is-checked")!==!1?"subscribe":"unsubscribe",i=new Headers;i.append("Content-Type","application/json");var n={method:"GET",headers:i},s=app.baseUrl+"/mail/"+app.getSetting("notifications.email")+"/"+a+"/"+e+"/"+app.getSetting("notifications.unsubscription_token")+"/";fetch(s,n).then(app.fetchStatusHandler).then(function(t){toast("Subscription "+e+" ("+a+") updated.",{timeout:3e3,type:"done"})}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("Error occured on saving Notifications..."+t,{timeout:3e3,type:"error"})})}else"true"==localStorage.getItem("settings.debug")&&toast("Error occured on saving Notifications...",{timeout:3e3,type:"error"})});let s=document.getElementById("switch-profile.notifications.newsletter").parentNode;s&&s.addEventListener("change",function(t){if(app.getSetting("notifications.email")&&app.getSetting("notifications.unsubscription_token")){var e=s.classList.contains("is-checked")!==!1?"subscribe":"unsubscribe",a=new Headers;a.append("Content-Type","application/json");var i={method:"GET",headers:a},n=app.baseUrl+"/mail/"+app.getSetting("notifications.email")+"/"+e+"/newsletter/"+app.getSetting("notifications.unsubscription_token")+"/";fetch(n,i).then(app.fetchStatusHandler).then(function(t){toast("Subscription newsletter ("+e+") updated.",{timeout:3e3,type:"done"})}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("Error occured on saving Notifications..."+t,{timeout:3e3,type:"error"})})}else"true"==localStorage.getItem("settings.debug")&&toast("Error occured on saving Notifications...",{timeout:3e3,type:"error"})})},app.setDrawer=function(){"null"!=localStorage.getItem("currentUserName")?document.getElementById("currentUserName").innerHTML=localStorage.getItem("currentUserName"):document.getElementById("currentUserName").innerHTML="t6 IoT App","null"!=localStorage.getItem("currentUserEmail")?document.getElementById("currentUserEmail").innerHTML=localStorage.getItem("currentUserEmail"):document.getElementById("currentUserEmail").innerHTML="",document.getElementById("imgIconMenu")&&"null"!=localStorage.getItem("currentUserHeader")&&localStorage.getItem("currentUserHeader")?(document.getElementById("currentUserHeader").setAttribute("src",localStorage.getItem("currentUserHeader")),document.getElementById("imgIconMenu").outerHTML='<img id="imgIconMenu" src="'+localStorage.getItem("currentUserHeader")+'" alt="Current user avatar" style="border-radius: 50%; width: 30px; height: 30px; padding: 0px;border: 2px solid #fff;margin: 0px 0px;">'):document.getElementById("currentUserHeader").setAttribute("src",app.baseUrlCdn+"/img/m/icons/icon-128x128.png"),null!==localStorage.getItem("currentUserBackground")?document.getElementById("currentUserBackground").style.background="#795548 url("+localStorage.getItem("currentUserBackground")+") 50% 50% / cover":document.getElementById("currentUserBackground").style.background="#795548 url("+app.baseUrlCdn+"/img/m/side-nav-bg.webp) 50% 50% / cover"},app.resetDrawer=function(){localStorage.removeItem("currentUserName"),localStorage.removeItem("currentUserEmail"),localStorage.removeItem("currentUserHeader"),localStorage.removeItem("currentUserBackground"),document.getElementById("imgIconMenu")&&(document.getElementById("imgIconMenu").outerHTML='<i id="imgIconMenu" class="material-icons">menu</i>'),app.setDrawer()},app.displayLoginForm=function(t){if(t.querySelectorAll("form.signin").forEach(function(t){t&&t.parentNode.remove()}),app.isLogged===!1){var e="<section class='content-grid mdl-grid'>\t<div class='mdl-layout-spacer'></div>\t<form class='signin'>\t\t<div class='mdl-card mdl-card__title mdl-shadow--2dp'>\t\t\t<img src='"+app.baseUrlCdn+"/img/opl_img.webp' alt='t6 Connect your Objects' aria-hidden='true'>\t\t\t<div class='mdl-card__title'>\t\t\t\tConnect your Objects to collect their data and show your own Dashboards.\t\t\t</div>\t\t\t<div class='mdl-card__supporting-text'>\t\t\t\t<div class='mdl-textfield mdl-js-textfield mdl-textfield--floating-label'>\t\t\t\t\t<i class='material-icons mdl-textfield__icon'>lock</i>\t\t\t\t\t<input name='username' inputmode='email' autocomplete='username email' pattern=\""+app.patterns.username+"\" class='mdl-textfield__input' type='text' id='signin.username'>\t\t\t\t\t<label for='signin.username' class='mdl-textfield__label'>Username</label>\t\t\t\t\t<span class='mdl-textfield__error'>Username should be your email address</span>\t\t\t\t</div>\t\t\t\t<div class='mdl-textfield mdl-js-textfield mdl-textfield--floating-label'>\t\t\t\t\t<i class='material-icons mdl-textfield__icon'>vpn_key</i>\t\t\t\t\t<input name='password' pattern=\""+app.patterns.password+"\" class='mdl-textfield__input' type='password' autocomplete='current-password' id='signin.password'>\t\t\t\t\t<label for='signin.password' class='mdl-textfield__label'>Password</label>\t\t\t\t\t<span class='mdl-textfield__error'>Password must be provided</span>\t\t\t\t</div>\t\t\t</div>\t\t\t<div class='mdl-card__supporting-text'>\t\t\t</div>\t\t\t<div class='mdl-card__supporting-text mdl-grid'>\t\t\t\t<span class='mdl-layout-spacer'></span>\t\t\t\t<button class='login_button mdl-button mdl-js-button mdl-js-ripple-effect'>\t\t\t\t\t<i class='material-icons'>lock</i>Log in\t\t\t\t</button>\t\t\t</div>\t\t\t<div class='mdl-card__actions mdl-card--border'>\t\t\t\t<span class='mdl-layout-spacer'></span>\t\t\t\t<a onclick=\"app.setSection('signup');\" href='#signup' class='mdl-button small'>Sign Up</a> or \t\t\t\t<a onclick=\"app.setSection('forgot-password');\" href='#forgot-password' class='mdl-button small'>Reset password</a>\t\t\t</div>\t\t</div>\t</form>\t<div class='mdl-layout-spacer'></div></section>";t.innerHTML+=e,componentHandler.upgradeDom();for(var a=document.querySelectorAll(".page-content form div.mdl-js-textfield"),i=0;i<a.length;i++)a[i].classList.remove("is-upgraded"),a[i].removeAttribute("data-upgraded");app.refreshButtonsSelectors(),app.setLoginAction(),app.setSignupAction()}},app.fetchIndex=function(){var t="",e=app.containers.index.querySelector(".page-content");if(app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden"),localStorage.getItem("index")){for(var a=JSON.parse(localStorage.getItem("index")),i=0;i<a.length;i++)t+=app.getCard(a[i]);e.innerHTML=t}else{var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"GET",headers:n},s=app.baseUrl+"/"+app.api_version+"/index";fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(a){for(var i=0;i<a.length;i++)t+=app.getCard(a[i]);localStorage.setItem("index",JSON.stringify(a)),e.innerHTML=t,app.imageLazyLoading()}).catch(function(t){e.innerHTML=app.getCard({image:app.baseUrlCdn+"/img/opl_img2.webp",title:"Oops, something has not been loaded correctly..",titlecolor:"#ffffff",description:"We are sorry, the content cannot be loaded, please try again later, there might a temporary network outage. :-)"}),app.displayLoginForm(e),"true"==localStorage.getItem("settings.debug")&&toast("fetchIndex error out..."+t,{timeout:3e3,type:"error"})})}app.containers.spinner.setAttribute("hidden",!0)},app.showAddFAB=function(t){var e,a=!1;if("objects"==t){var i="createObject";e=app.containers.objects.querySelector(".page-content"),a=!0}if("flows"==t){var i="createFlow";e=app.containers.flows.querySelector(".page-content"),a=!0}if("dashboards"==t){var i="createDashboard";e=app.containers.dashboards.querySelector(".page-content"),a=!0}if("snippets"==t){var i="createSnippet";e=app.containers.snippets.querySelector(".page-content"),a=!0}if("rules"==t){var i="createRule";e=app.containers.rules.querySelector(".page-content"),a=!0}if("mqtts"==t){var i="createMqtt";e=app.containers.mqtts.querySelector(".page-content"),a=!0}if("sources"==t){var i="createSource";e=app.containers.sources.querySelector(".page-content"),a=!0}if(a&&e){var n=null!==app.getSetting("settings.fab_position")?app.getSetting("settings.fab_position"):"fab__bottom",o="<div class='mdl-button--fab_flinger-container "+n+"'>";o+="\t<button id='"+i+"' class='mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect mdl-button--colored mdl-shadow--8dp'>",o+="\t\t<i class='material-icons'>add</i>",o+="\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+i+"'>Add a new "+t.slice(0,-1)+"</label>",o+="\t</button>",o+="</div>";var s=(parseInt(app.itemsPage[t]),parseInt(app.itemsSize[t]),parseInt(app.itemsPage[t]),parseInt(app.itemsSize[t]),parseInt(app.itemsPage[t])+1);o+="<div class='mdl-grid mdl-cell mdl-cell--12-col spacer'>",o+="\t<span class='mdl-layout-spacer'></span>",o+="\t\t<button data-size='"+parseInt(app.itemsSize[t])+"' data-page='"+s+"' data-type='"+t+"' class='lazyloading mdl-cell--12-col mdl-button mdl-js-button mdl-js-ripple-effect'>",o+="\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t</button>",o+="\t<span class='mdl-layout-spacer'></span>",o+="</div>",e.innerHTML+=o,componentHandler.upgradeDom(),app.refreshButtonsSelectors(),app.buttons.createObject&&app.buttons.createObject.addEventListener("click",function(){app.setSection("object_add")},!1),app.buttons.createFlow&&app.buttons.createFlow.addEventListener("click",function(){app.setSection("flow_add")},!1),app.buttons.createSnippet&&app.buttons.createSnippet.addEventListener("click",function(){app.setSection("snippet_add")},!1),app.buttons.createDashboard&&app.buttons.createDashboard.addEventListener("click",function(){app.setSection("dashboard_add")},!1),app.buttons.createRule&&app.buttons.createRule.addEventListener("click",function(){app.setSection("rule_add")},!1),app.buttons.createMqtt&&app.buttons.createMqtt.addEventListener("click",function(){app.setSection("mqtt_add")},!1),app.buttons.createSource&&app.buttons.createSource.addEventListener("click",function(){app.setSection("source_add")},!1)}},app.getField=function(t,e,a,i){"hidden"===i.type&&(i.isVisible=!1);var n=i.isVisible!==!1?"":" hidden",o=i.isExpand===!1?"":" mdl-card--expand",s=void 0!==i.enterkeyhint?sprintf(' enterkeyhint="%s"',i.enterkeyhint):"",l=void 0!==i.inputmode?sprintf(' inputmode="%s"',i.inputmode):"",r="";if(r+="<div class='mdl-list__item--three-line small-padding "+n+o+"'>","object"==typeof i){var d=null!==i.id?i.id:app.getUniqueId();if("input"===i.type||"text"===i.type){var p=void 0!==i.style?"style='"+i.style+"'":"";if(i.isEdit===!0){var c=void 0!==i.pattern?"pattern='"+i.pattern+"'":"";r+="<div class='mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon' for='"+d+"'>"+t+"</i>"),r+="\t<input type='text' "+p+" "+l+" "+s+" value='"+app.escapeHtml(a)+"' "+c+" class='mdl-textfield__input' name='"+e+"' id='"+d+"' />",e&&(r+="\t<label class='mdl-textfield__label' for='"+d+"'>"+e+"</label>"),i.error&&(r+="\t<span class='mdl-textfield__error'>"+i.error+"</span>"),r+="</div>"}else r+="<div class='mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon'>"+t+"</i>"),e&&(r+="\t<label class='mdl-textfield__label'>"+e+"</label>"),a&&(r+="\t<span class='mdl-list__item-sub-title' "+p+">"+app.escapeHtml(a)+"</span>"),r+="</div>"}else if("container"===i.type)r+="<div class='mdl-list__item-sub-title'>",r+="\t<i class='material-icons mdl-textfield__icon' for='"+d+"'>view_module</i>",e&&(r+="\t<label class='mdl-textfield__label' for='"+d+"'>"+e+"</label>"),r+="\t<div class='' id='"+d+"'></div>",r+="</div>";else if("hidden"===i.type){var c=void 0!==i.pattern?"pattern='"+i.pattern+"'":"";r+="<div class='mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon' for='"+d+"'>"+t+"</i>"),r+="\t<input type='hidden' value='"+a+"' "+c+" class='mdl-textfield__input' name='"+e+"' id='"+d+"' />",e&&(r+="\t<label class='mdl-textfield__label' for='"+d+"'>"+e+"</label>"),i.error&&(r+="\t<span class='mdl-textfield__error'>"+i.error+"</span>"),r+="</div>"}else if("textarea"===i.type)i.isEdit===!0?(r+="<div class='mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon' for='"+d+"'>"+t+"</i>"),r+="\t<textarea style='width:100%; height:100%;' type='text' rows='3' class='mdl-textfield__input' name='"+e+"' id='"+d+"'>"+a+"</textarea>",e&&(r+="\t<label class='mdl-textfield__label' for='"+d+"'>"+e+"</label>"),i.error&&(r+="\t<span class='mdl-textfield__error'>"+i.error+"</span>"),r+="</div>"):a&&(r+="<span class='mdl-list__item-sub-title'>"+a+"</span>");else if("radio"===i.type)i.isEdit===!0?(r+="<div class='mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon'> /! radio "+t+"</i>"),e&&(r+="\t<label class='mdl-textfield__label'> /! radio "+e+"</label>"),i.error&&(r+="\t<span class='mdl-textfield__error'>"+i.error+"</span>"),r+="</div>"):(r+="<div class='mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon'>"+t+"</i>"),e&&(r+="\t<label class='mdl-radio__label'>"+e+"</label>"),a&&(r+="\t<span class='mdl-list__item-sub-title'>"+a+"</span>"),r+="</div>");else if("checkbox"===i.type){var u=a===!0||"true"===a?" checked":"",m=a===!0||"true"===a?"is-checked":"";i.isEdit===!0?(r+="<label class='mdl-checkbox mdl-js-checkbox mdl-js-ripple-effect mdl-textfield--floating-label "+m+"' for='checkbox-"+d+"' data-id='checkbox-"+d+"'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon' for='"+d+"'>"+t+"</i>"),r+="\t<input type='checkbox' id='checkbox-"+d+"' class='mdl-checkbox__input' name='"+e+"' value='"+a+"' placeholder='"+e+"' "+u+">",e&&(r+="\t<div class='mdl-checkbox__label'>"+e+"</div>"),r+="</label>",i.error&&(r+="\t<span class='mdl-textfield__error'>"+i.error+"</span>")):(r+="<div class='mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon'>"+t+"</i>"),e&&(r+="\t<label class='mdl-checkbox__label'>"+e+"</label>"),a&&(r+="\t<span class='mdl-list__item-sub-title'>"+a+"</span>"),r+="</div>")}else if("switch"===i.type){var u=a===!0||"true"===a?" checked":"",m=a===!0||"true"===a?"is-checked":"";i.isEdit===!0?(r+="<label class='mdl-switch mdl-js-switch mdl-js-ripple-effect mdl-textfield--floating-label "+m+"' for='switch-"+d+"' data-id='switch-"+d+"'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon' for='"+d+"'>"+t+"</i>"),r+="\t<input type='checkbox' id='switch-"+d+"' class='mdl-switch__input' name='"+e+"' value='"+a+"' placeholder='"+e+"' "+u+">",e&&(r+="\t<div class='mdl-switch__label'>"+e+"</div>"),r+="</label>",i.error&&(r+="\t<span class='mdl-textfield__error'>"+i.error+"</span>")):(r+="<div class='mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon'>"+t+"</i>"),
e&&(r+="\t<label class='mdl-switch__label'>"+e+"</label>"),a&&(r+="\t<span class='mdl-list__item-sub-title'>"+a+"</span>"),r+="</div>")}else if("select"===i.type)if(1==i.isEdit){var b=1==i.isMultiple?"multiple":"";if(r+="<div class='mdl-selectfield mdl-js-selectfield mdl-textfield--floating-label'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon' for='"+d+"'>"+t+"</i>"),e&&(r+="\t<label class='mdl-selectfield__label' for='"+d+"'>"+e+"</label>"),r+="\t<select class='mdl-textfield__input mdl-selectfield__select' name='"+e+"' id='"+d+"' "+b+">",i.options)for(var g=0;g<i.options.length;g++){var f=a==i.options[g].name?"selected":"";r+="\t<option "+f+" value='"+i.options[g].name+"' data-stype='"+i.options[g].sType+"'>"+i.options[g].value+"</option>"}r+="\t</select>",i.error&&(r+="\t<span class='mdl-textfield__error'>"+i.error+"</span>"),r+="</div>"}else{var v=i.options.filter(function(t){return t.name===a});v=void 0!==v[0]?v[0].value:"",r+="<div class='mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon'>"+t+"</i>"),e&&(r+="\t<label class='mdl-selectfield__label'>"+e+"</label>"),a&&(r+="\t<span class='mdl-list__item-sub-title'>"+a+"</span>"),r+="</div>"}else if("2inputs"===i.type){var c=new Array;c[0]=void 0!==i.pattern[0]?"pattern='"+i.pattern[0]+"'":"",c[1]=void 0!==i.pattern[1]?"pattern='"+i.pattern[1]+"'":"",1==i.isEdit?(r+="<div class='half mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-list__item-sub-title' style='width: calc(50% - 20px) !important;'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon' for='"+d[0]+"'>"+t+"</i>"),r+="\t<input type='text' value='"+a[0]+"'"+c[0]+" class='mdl-textfield__input' name='"+d[0]+"' id='"+d[0]+"' />",e[0]&&(r+="\t<label class='mdl-textfield__label' for='"+d[0]+"'>"+e[0]+"</label>"),i.error[0]&&(r+="\t<span class='mdl-textfield__error'>"+i.error[0]+"</span>"),r+="</div>",r+="<div class='half mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-list__item-sub-title' style='width: calc(50% - 20px) !important;'>",r+="\t<input type='text' value='"+a[1]+"'"+c[1]+" class='mdl-textfield__input' name='"+d[1]+"' id='"+d[1]+"' />",e[1]&&(r+="\t<label class='mdl-textfield__label' for='"+d[1]+"'>"+e[1]+"</label>"),i.error[1]&&(r+="\t<span class='mdl-textfield__error'>"+i.error[1]+"</span>"),r+="</div>",r+="<div class='half mdl-textfield mdl-js-textfield mdl-textfield--floating-label mdl-list__item-sub-title' style='width: 40px !important;'>",r+="\t<button class='mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' style='position: absolute; bottom: -10px;'><i class='material-icons'>add</i></button>",r+="</div>"):(a=i.options.filter(function(t){return t.name===a})[0].value,r+="<div class='mdl-list__item-sub-title'>",t&&(r+="\t<i class='material-icons mdl-textfield__icon'>"+t+"</i>"),a&&(r+="\t<span class='mdl-list__item-sub-title'>"+a+"</span>"),r+="</div>")}else"progress-status"===i.type&&(r+="<span class='mdl-progress mdl-js-progress' id='progress-status' title=''><br />"+a+"</span>")}else console.log("Error on options: ",i);return void 0!==i.action&&(r+="\t<span class='mdl-list__item-secondary-action'>",r+="\t\t<a href='#' "+i.action+">",r+="\t\t\t<i class='material-icons'>chevron_right</i>",r+="\t\t</a>",r+="\t</span>"),r+="</div>"},app.getSnippet=function(t,e,a){app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"GET",headers:i},o=null!=a?a:app.containers.dashboard.querySelector(".page-content"),s=app.baseUrl+"/"+app.api_version+"/snippets/"+e;fetch(s,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(t.data[0]){var e=t.data[0],a=app.snippetTypes.find(function(t){return t.name.toLowerCase()===e.attributes.type.toLowerCase()}),i=a.getHtml({name:e.attributes.name,id:e.id,icon:e.attributes.icon,color:e.attributes.color}),n=document.createElement("div");n.setAttribute("class","mdl-grid mdl-cell"),n.innerHTML=i,o.appendChild(n),componentHandler.upgradeDom(),e.flowNames=[],e.attributes.flows.map(function(t){if("null"!=localStorage.getItem("flows")&&JSON.parse(localStorage.getItem("flows"))){var a=JSON.parse(localStorage.getItem("flows")).find(function(e){return e.id==t});a&&e.flowNames.push(a.name)}}),void 0!==e.attributes.options&&a.setOptions(e.attributes.options),a.activateOnce(e);var s=document.querySelectorAll(".edit-snippet");for(var l in s)s[l].childElementCount>-1&&s[l].addEventListener("click",function(t){app.resources.snippets.display(t.target.parentNode.getAttribute("data-snippet-id"),!1,!0,!1),t.preventDefault()})}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("getSnippet error out..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},app.refreshFromNow=function(t,e,a){document.getElementById(t)&&(document.getElementById(t).innerHTML=moment(e).format(app.date_format),null!==a&&(document.getElementById(t).innerHTML+="<small>, "+moment(e).fromNow()+"</small>"))},app.getQrcodeImg=function(t,e,a){var i="<div class='mdl-list__item small-padding'>";return i+="\t\t<span class='mdl-list__item-primary-content'>",i+="\t\t\t<i class='material-icons mdl-textfield__icon'>link</i>",i+='\t\t\t<label class="mdl-switch__label">QR Code<sup>TM</sup></label>',i+="\t\t</span>",i+="\t\t<span class='mdl-list__item-secondary-content'>",i+="\t\t\t<img src='' id='qr-"+a+"' class='img-responsive' style='margin:0 auto;' />",i+="\t\t</span>",i+="</div>"},app.getQrcode=function(t,e,a){var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"GET",headers:i},o=app.baseUrl+"/"+app.api_version+"/objects/"+a+"/qrcode/8/H";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(t){document.getElementById("qr-"+a).setAttribute("src",(new DOMParser).parseFromString(t.data,"text/html").images[0].src)}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("fetch Qrcode error out..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},app.getMap=function(t,e,a,i,n,o){var s="<div class='mdl-list__item'>";return s+="\t<span class='mdl-list__item-primary-content map' id='"+e+"' style='width:100%; height:400px;'></span>",s+="</div>"},app.authenticate=function(){var t=new Headers;t.append("Content-Type","application/json"),app.auth.pushSubscription={endpoint:app.getSetting("settings.pushSubscription.endpoint"),keys:{auth:app.getSetting("settings.pushSubscription.keys.auth"),p256dh:app.getSetting("settings.pushSubscription.keys.p256dh")}};var e={method:"POST",headers:t,body:JSON.stringify(app.auth)},a=app.baseUrl+"/"+app.api_version+"/authenticate";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){t.token&&t.refresh_token&&t.refreshTokenExp?(localStorage.setItem("bearer",t.token),localStorage.setItem("refresh_token",t.refresh_token),localStorage.setItem("refreshTokenExp",t.refreshTokenExp),app.isLogged=!0,app.resetSections(),app.fetchProfile(),app.fetchUnsubscriptions(),window.location.hash&&"object_add"===window.location.hash.substr(1)?app.displayAddObject(app.defaultResources.object):window.location.hash&&"flow_add"===window.location.hash.substr(1)?app.displayAddFlow(app.defaultResources.flow):window.location.hash&&"dashboard_add"===window.location.hash.substr(1)?app.displayAddDashboard(app.defaultResources.dashboard):window.location.hash&&"snippet_add"===window.location.hash.substr(1)?app.displayAddSnippet(app.defaultResources.snippet):window.location.hash&&"rule_add"===window.location.hash.substr(1)?app.displayAddRule(app.defaultResources.rule):window.location.hash&&"mqtt_add"===window.location.hash.substr(1)?app.displayAddMqtt(app.defaultResources.mqtt):window.location.hash&&"source_add"===window.location.hash.substr(1)?app.displayAddSource(app.defaultResources.source):window.location.hash&&"login"!==window.location.hash.substr(1)?app.setSection(window.location.hash.substr(1)):app.setSection("index"),app.setHiddenElement("signin_button"),app.setVisibleElement("logout_button"),toast("Hey. Welcome Back! :-)",{timeout:3e3,type:"done"}),"undefined"!=typeof firebase&&(firebase.analytics().setUserProperties({isLoggedIn:1}),firebase.analytics().logEvent("login")),setInterval(app.refreshAuthenticate,app.refreshExpiresInSeconds),app.getUnits(),app.getDatatypes(),app.getFlows(),app.getSnippets(),app.getSources()):("true"==localStorage.getItem("settings.debug")&&toast("Auth internal error",{timeout:3e3,type:"error"}),app.resetDrawer())}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&(toast("We can't process your identification. Please resubmit your credentials!",{timeout:3e3,type:"warning"}),document.querySelectorAll(".mdl-spinner").forEach(function(t){t.parentNode.removeChild(t)}))}),app.auth={}},app.refreshAuthenticate=function(){var t=new Headers;t.append("Content-Type","application/json"),app.auth.pushSubscription={endpoint:app.getSetting("settings.pushSubscription.endpoint"),keys:{auth:app.getSetting("settings.pushSubscription.keys.auth"),p256dh:app.getSetting("settings.pushSubscription.keys.p256dh")}};var e={grant_type:"refresh_token",refresh_token:localStorage.getItem("refresh_token"),pushSubscription:app.auth.pushSubscription},a={method:"POST",headers:t,body:JSON.stringify(e)},i=app.baseUrl+"/"+app.api_version+"/authenticate";fetch(i,a).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){t.token&&t.refresh_token&&t.refreshTokenExp?(localStorage.setItem("bearer",t.token),localStorage.setItem("refresh_token",t.refresh_token),localStorage.setItem("refreshTokenExp",t.refreshTokenExp),app.isLogged=!0,"undefined"!=typeof firebase&&(firebase.analytics().setUserProperties({isLoggedIn:1}),firebase.analytics().logEvent("refreshAuthenticate")),app.fetchProfile(),app.setHiddenElement("signin_button"),app.setVisibleElement("logout_button")):("true"==localStorage.getItem("settings.debug")&&toast("Auth internal error",{timeout:3e3,type:"error"}),app.resetDrawer())}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&(console.log(t),toast("We can't process your identification. Please resubmit your credentials on login page!",{timeout:3e3,type:"warning"}))}),app.auth={}},app.addMenuItem=function(t,e,a,i){var n=document.createElement("a");n.setAttribute("href",a),n.setAttribute("class","mdl-navigation__link");var o=document.createElement("i");o.setAttribute("class","material-icons"),o.appendChild(document.createTextNode(e)),n.appendChild(o),n.appendChild(document.createTextNode(t)),n.addEventListener("click",function(t){app.setSection((null!==t.target.getAttribute("hash")?t.target.getAttribute("hash"):t.target.getAttribute("href")).substr(1)),app.hideMenu()},!1),i&&i>-1||document.querySelector("#drawer nav.mdl-navigation.menu__list").appendChild(n)},app.getSettings=function(){var t="";t+=app.getSubtitle("Application settings"),t+='<section class="mdl-grid mdl-cell--12-col">',t+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',t+='\t<div class="card-header heading-left">&nbsp;</div>',t+=app.getField("radio_button_checked","Floating Action Buttons",null!==app.getSetting("settings.fab_position")?app.getSetting("settings.fab_position"):"fab__bottom",{type:"select",id:"settings.fab_position",options:[{name:"fab__top",value:"Top position"},{name:"fab__bottom",value:"Bottom position"}],isEdit:!0}),t+=app.getField("format_textdirection_l_to_r","Action buttons",null===app.getSetting("settings.isLtr")||app.getSetting("settings.isLtr"),{type:"select",id:"settings.isLtr",options:[{name:"true",value:"Aligned to the right"},{name:"false",value:"Aligned to the left"}],isEdit:!0}),t+=app.getField("date_range","Date Format",null!==app.getSetting("settings.date_format")?app.getSetting("settings.date_format"):app.date_format,{type:"input",id:"settings.date_format",isEdit:!0}),t+=app.getField("subject","Card Chars Limit",null!==app.getSetting("settings.cardMaxChars")?app.getSetting("settings.cardMaxChars"):app.cardMaxChars,{type:"input",id:"settings.cardMaxChars",isEdit:!0,pattern:app.patterns.cardMaxChars,error:"Must be an Integer."}),t+=app.getField("room","false"!=app.getSetting("settings.geolocalization")?"Geolocalization is enabled":"Geolocalization is disabled",null===app.getSetting("settings.geolocalization")||app.getSetting("settings.geolocalization"),{type:"switch",id:"settings.geolocalization",isEdit:!0}),t+=app.getField("bug_report","false"!=app.getSetting("settings.debug")?"Debug is enabled":"Debug is disabled",null!==app.getSetting("settings.debug")?app.getSetting("settings.debug"):app.debug,{type:"switch",id:"settings.debug",options:[{name:"true",value:"True"},{name:"false",value:"False"}],isEdit:!0}),t+=app.getField("voice_over_off","Do Not Track (DNT) header","1"==navigator.doNotTrack?"Enabled, you are not being tracked. This setting is customized on your browser.":"Disabled, you are tracked :-) and it can be customized on your browser settings.",{type:"switch",isEdit:!1}),t+="\t</div>",t+="</section>",t+=app.getSubtitle("API Notifications"),t+='<section class="mdl-grid mdl-cell--12-col">',t+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',t+='\t<div class="card-header heading-left">&nbsp;</div>',t+=app.getField("notifications","false"!=app.getSetting("settings.notifications")?"Notifications are enabled":"Notifications are disabled",void 0===app.getSetting("settings.notifications")||app.getSetting("settings.notifications"),{type:"switch",id:"settings.notifications",isEdit:!0}),app.getSetting("settings.pushSubscription.keys.p256dh")&&"false"!=app.getSetting("settings.notifications")&&"false"!=app.getSetting("settings.debug")&&(t+=app.getField("cloud","Endpoint",app.getSetting("settings.pushSubscription.endpoint"),{type:"input",id:"settings.pushSubscription.endpoint",isEdit:!0,style:"text-transform: none !important;"}),t+=app.getField("vpn_key","Key",app.getSetting("settings.pushSubscription.keys.p256dh"),{type:"input",id:"settings.pushSubscription.keys.p256dh",isEdit:!0,style:"text-transform: none !important;"}),t+=app.getField("vpn_lock","Auth",app.getSetting("settings.pushSubscription.keys.auth"),{type:"input",id:"settings.pushSubscription.keys.auth",isEdit:!0,style:"text-transform: none !important;"})),t+="\t</div>",t+="</section>",app.containers.settings.querySelector(".page-content").innerHTML=t,componentHandler.upgradeDom(),document.getElementById("settings.fab_position")&&document.getElementById("settings.fab_position").addEventListener("change",function(t){app.setSetting("settings.fab_position",t.target.value);var e=document.querySelectorAll(".mdl-button--fab_flinger-container");if("fab__top"==t.target.value){for(var a in e)e[a].childElementCount>-1&&(e[a].classList.add("fab__top"),e[a].classList.remove("fab__bottom"));toast("Floating Button are aligned Top.",{timeout:3e3,type:"done"})}else{for(var a in e)e[a].childElementCount>-1&&(e[a].classList.remove("fab__top"),e[a].classList.add("fab__bottom"));toast("Floating Button are aligned Bottom.",{timeout:3e3,type:"done"})}}),document.getElementById("settings.isLtr")&&document.getElementById("settings.isLtr").addEventListener("change",function(t){app.setSetting("settings.isLtr",t.target.value);document.querySelectorAll(".mdl-button--fab_flinger-container");"true"==t.target.value?(app.setSetting("settings.isLtr",!0),toast("Action buttons are aligned to the right.",{timeout:3e3,type:"done"})):(app.setSetting("settings.isLtr",!1),toast("Action buttons are aligned to the left.",{timeout:3e3,type:"done"}))}),document.getElementById("switch-settings.notifications")&&document.getElementById("switch-settings.notifications").addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");document.getElementById("switch-settings.notifications").checked===!0?(app.setSetting("settings.notifications",!0),app.askPermission(),app.subscribeUserToPush(),e.innerText="Notifications are enabled","true"==localStorage.getItem("settings.debug")&&toast("Awsome, Notifications are enabled.",{timeout:3e3,type:"done"})):(e.innerText="Notifications are disabled",app.setSetting("settings.notifications",!1),toast("Notifications are disabled.",{timeout:3e3,type:"done"}))}),document.getElementById("switch-settings.geolocalization")&&document.getElementById("switch-settings.geolocalization").addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");document.getElementById("switch-settings.geolocalization").checked===!0?(app.setSetting("settings.geolocalization",!0),e.innerText="Geolocalization is enabled",app.getLocation(),"true"==localStorage.getItem("settings.debug")&&toast("Awsome, Geolocalization is enabled.",{timeout:3e3,type:"done"})):(app.setSetting("settings.geolocalization",!1),e.innerText="Geolocalization is disabled",toast("Geolocalization is disabled.",{timeout:3e3,type:"done"}))}),document.getElementById("switch-settings.debug")&&document.getElementById("switch-settings.debug").addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");document.getElementById("switch-settings.debug").checked===!0?(app.setSetting("settings.debug",!0),e.innerText="Debug is enabled",document.dispatchEvent(new Event("clearCache")),app.debug=!0,"true"==localStorage.getItem("settings.debug")&&toast("Awsome, Debug mode is activated and cache is now cleared.",{timeout:3e3,type:"done"})):(app.setSetting("settings.debug",!1),e.innerText="Debug is disabled",app.debug=!1,toast("Debug mode is disabled.",{timeout:3e3,type:"done"}))}),document.getElementById("settings.date_format")&&document.getElementById("settings.date_format").addEventListener("keyup",function(t){app.setSetting("settings.date_format",document.getElementById("settings.date_format").value),app.date_format=document.getElementById("settings.date_format").value,toast("Date Format has been updated on "+moment().format(app.date_format),{timeout:3e3,type:"done"})}),document.getElementById("settings.cardMaxChars")&&document.getElementById("settings.cardMaxChars").addEventListener("keyup",function(t){document.getElementById("settings.cardMaxChars").value.match(app.patterns.cardMaxChars)?(app.setSetting("settings.cardMaxChars",document.getElementById("settings.cardMaxChars").value),app.cardMaxChars=document.getElementById("settings.cardMaxChars").value,toast("Card Limit is set to "+app.cardMaxChars+".",{timeout:3e3,type:"done"})):toast("Card Limit remain "+app.cardMaxChars+".",{timeout:3e3,type:"done"})})},app.getStatus=function(){var t=new Headers;t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/status";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){if(navigator.onLine){var e="";if(e+='<section class="mdl-grid mdl-cell--12-col">',e+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',e+='\t\t<div class="mdl-list__item">',e+="\t\t\t<span class='mdl-list__item-primary-content'>",e+='\t\t\t\t<i class="material-icons">'+app.icons.status+"</i>",e+='\t\t\t\t<h3 class="mdl-card__title-text">'+app.sectionsPageTitles.status+"</h3>",e+="\t\t\t</span>",e+="\t\t\t<span class='mdl-list__item-secondary-action'>",e+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='status-details'>",e+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",e+="\t\t\t\t</button>",e+="\t\t\t</span>",e+="\t\t</div>",e+='\t\t<div class="card-body">',e+="\t\t\t<div class='mdl-list__item--three-line small-padding  mdl-card--expand' id='status-details'>",e+=app.getField("thumb_up","Application Name",t.appName,{type:"text",style:"text-transform: none !important;",isEdit:!1}),e+=app.getField("favorite","Status",t.status,{type:"text",isEdit:!1}),e+=app.getField("volume_down","Mqtt Topic Info",t.mqttInfo,{type:"text",style:"text-transform: none !important;",isEdit:!1}),e+=app.getField("verified_user","Api Version",t.version,{type:"text",style:"text-transform: none !important;",isEdit:!1}),e+=app.getField("verified_user","Build Version",t.t6BuildVersion,{type:"text",style:"text-transform: none !important;",isEdit:!1}),e+=app.getField("alarm","Build Date",moment(t.t6BuildDate,"DD/MM/YYYY HH:mm:ss").format(app.date_format),{type:"text",style:"text-transform: none !important;",isEdit:!1}),e+=app.getField("alarm","Server Last Update",moment(t.started_at,"DD/MM/YYYY HH:mm:ss").format(app.date_format),{type:"text",isEdit:!1}),e+="\t\t\t</div>",e+="\t\t</div>",e+="\t</div>",e+="</section>",app.RateLimit.Limit&&app.RateLimit.Remaining&&(e+='<section class="mdl-grid mdl-cell--12-col">',e+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',e+='\t\t<div class="mdl-list__item">',e+="\t\t\t<span class='mdl-list__item-primary-content'>",e+='\t\t\t\t<i class="material-icons">crop_free</i>',e+='\t\t\t\t<h3 class="mdl-card__title-text">API Usage</h3>',e+="\t\t\t</span>",e+="\t\t\t<span class='mdl-list__item-secondary-action'>",e+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='status-usage'>",e+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",e+="\t\t\t\t</button>",e+="\t\t\t</span>",e+="\t\t</div>",e+="\t\t<div class='mdl-cell--12-col' id='status-usage'>",app.RateLimit.Used&&app.RateLimit.Limit&&(e+=app.getField("center_focus_weak","Used",app.RateLimit.Used+"/"+app.RateLimit.Limit,{type:"progress-status",isEdit:!1})),e+="\t\t</div>",e+="\t</div>",e+="</section>"),app.containers.status.querySelector(".page-content").innerHTML=e,app.RateLimit.Used&&app.RateLimit.Limit){var a=10*Math.ceil(100*app.RateLimit.Used/app.RateLimit.Limit/10);document.querySelector("#progress-status").addEventListener("mdl-componentupgraded",function(){this.MaterialProgress.setProgress(a)})}app.setExpandAction()}else app.containers.status.querySelector(".page-content").innerHTML=app.getCard(app.offlineCard)}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("Can't display Status..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},app.getTerms=function(){var t=new Headers;t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/terms";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var e="",a=0;a<t.length;a++)e+='<section class="mdl-grid mdl-cell--12-col">',e+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',t[a].title&&(e+='\t<div class="mdl-card__title">',e+='\t\t<i class="material-icons">business_center</i></span>',e+='\t\t<h3 class="mdl-card__title-text">'+t[a].title+"</h3>",e+="\t</div>"),e+='\t\t<div class="mdl-card__supporting-text no-padding">',e+=t[a].description,e+="\t\t</div>",e+="\t</div>",e+="</section>";app.containers.terms.querySelector(".page-content").innerHTML=e}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("Can't display Terms..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},app.getCompatibleDevices=function(){var t=new Headers;t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/compatible-devices";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var e="",a=0;a<t.length;a++)e+='<section class="mdl-grid mdl-cell--12-col">',e+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',t[a].title&&(e+='\t<div class="mdl-card__title">',e+='\t\t<i class="material-icons">devices_other</i>',e+='\t\t<h3 class="mdl-card__title-text">'+t[a].title+"</h3>",e+="\t</div>"),e+='\t\t<div class="mdl-card__supporting-text no-padding">',e+='\t\t\t<img src="/img/m/placeholder.png" class="lazyloading img-responsive" data-src="'+app.baseUrlCdn+t[a].image+'" align="left" style="margin-right: 5px;" width="100" alt="'+app.baseUrlCdn+t[a].title+'" />',e+=t[a].description,e+="\t\t</div>",e+="\t</div>",e+="</section>";app.containers.compatibleDevices.querySelector(".page-content").innerHTML=e,app.imageLazyLoading()}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("Can't display compatible devices..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},app.getOpenSourceLicenses=function(){var t=new Headers;t.append("Content-Type","application/json");var e={method:"GET",headers:t},a=app.baseUrl+"/"+app.api_version+"/open-source-licenses";fetch(a,e).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var e="",a=0;a<t.length;a++)e+='<section class="mdl-grid mdl-cell--12-col">',e+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',t[a].title&&(e+='\t<div class="mdl-card__title">',e+='\t\t<i class="material-icons">book</i>',e+='\t\t<h3 class="mdl-card__title-text">'+t[a].title+"</h3>",e+="\t\t<p>"+t[a].license+"</p>",e+="\t</div>"),e+='\t\t<div class="mdl-card__supporting-text no-padding">',e+=t[a].description,e+="\t\t</div>",t[a].dependencies&&(e+="\t\t<pre>",e+=t[a].dependencies,e+="\t\t</pre>"),e+='\t\t<div class="mdl-card__actions mdl-card--border">',e+='\t\t\t<button class="mdl-button mdl-js-button mdl-js-ripple-effect" onclick="document.location.href=\''+t[a].linkFullReport+"';\"> Get dependencies full report</button>",e+="\t\t</div>",e+="\t</div>",e+="</section>";app.containers.openSourceLicenses.querySelector(".page-content").innerHTML=e,app.imageLazyLoading()}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("Can't display Open-Source Licenses..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},app.toggleElement=function(t){document.querySelector("#"+t).classList.toggle("hidden")},app.setHiddenElement=function(t){document.querySelector("#"+t).classList.add("hidden")},app.setVisibleElement=function(t){document.querySelector("#"+t).classList.remove("hidden")},app.showNotification=function(){toast("You are offline.",{timeout:3e3,type:"warning"})},app.sessionExpired=function(){localStorage.setItem("bearer",null),localStorage.setItem("refresh_token",null),localStorage.setItem("refreshTokenExp",null),localStorage.setItem("flows",null),localStorage.setItem("snippets",null),localStorage.setItem("sources",null),localStorage.setItem("currentUserId",null),localStorage.setItem("currentUserName",null),localStorage.setItem("currentUserEmail",null),localStorage.setItem("currentUserHeader",null),localStorage.setItem("notifications.unsubscribed",null),localStorage.setItem("notifications.unsubscription_token",null),localStorage.setItem("notifications.email",null),localStorage.setItem("role",null),app.auth={},app.RateLimit={Limit:null,Remaining:null,Used:null},app.itemsSize={objects:15,flows:15,snippets:15,dashboards:15,mqtts:15,rules:15,sources:15},app.itemsPage={objects:1,flows:1,snippets:1,dashboards:1,mqtts:1,rules:1,sources:1},app.isLogged||toast("Your session has expired. You must sign-in again.",{timeout:3e3,type:"error"}),app.isLogged=!1,app.resetDrawer(),app.setVisibleElement("signin_button"),app.setHiddenElement("logout_button"),app.setDrawer(),app.refreshButtonsSelectors(),componentHandler.upgradeDom(),app.containers.profile&&(app.containers.profile.querySelector(".page-content").innerHTML=""),app.containers.objects&&(app.containers.objects.querySelector(".page-content").innerHTML=app.getCard({title:"Connected Objects",titlecolor:"#ffffff",description:"Connecting anything physical or virtual to t6 Api without any hassle. Embedded, Automatization, Domotic, Sensors, any Objects or Devices can be connected and communicate to t6 via RESTful API. Unic and dedicated application to rules them all and designed to simplify your journey."}),app.displayLoginForm(app.containers.objects.querySelector(".page-content"))),app.containers.flows&&(app.containers.flows.querySelector(".page-content").innerHTML=app.getCard({title:"Time-series Datapoints",titlecolor:"#ffffff",description:"Communication becomes easy in the platform with Timestamped values. Flows allows to retrieve and classify data.",action:{id:"login",label:"Sign-In"},secondaryaction:{id:"signup",label:"Create an account"}}),app.displayLoginForm(app.containers.flows.querySelector(".page-content"))),app.containers.dashboards&&(app.containers.dashboards.querySelector(".page-content").innerHTML=app.getCard({title:"Dashboards",titlecolor:"#ffffff",description:"t6 support multiple Snippets to create your own IoT Dashboards for data visualization. Snippets are ready to Use Html components integrated into the application. Dashboards allows to empower your data-management by Monitoring and Reporting activities.",action:{id:"login",label:"Sign-In"},secondaryaction:{id:"signup",label:"Create an account"}}),app.displayLoginForm(app.containers.dashboards.querySelector(".page-content"))),app.containers.snippets&&(app.containers.snippets.querySelector(".page-content").innerHTML=app.getCard({title:"Snippets",titlecolor:"#ffffff",description:"Snippets are components to embed into your dashboards and displays your data",action:{id:"login",label:"Sign-In"},secondaryaction:{id:"signup",label:"Create an account"}}),app.displayLoginForm(app.containers.snippets.querySelector(".page-content"))),app.containers.rules&&(app.containers.rules.querySelector(".page-content").innerHTML=app.getCard({title:"Decision Rules to get smart",titlecolor:"#ffffff",description:"Trigger action from Mqtt and decision-tree. Let's your Objects talk to the platform as events.",action:{id:"login",label:"Sign-In"},secondaryaction:{id:"signup",label:"Create an account"}}),app.displayLoginForm(app.containers.rules.querySelector(".page-content"))),app.containers.mqtts&&(app.containers.mqtts.querySelector(".page-content").innerHTML=app.getCard({title:"Sense events",titlecolor:"#ffffff",description:"Whether it's your own sensors or external Flows from Internet, sensors collect values and communicate them to t6.",action:{id:"login",label:"Sign-In"},secondaryaction:{id:"signup",label:"Create an account"}}),app.displayLoginForm(app.containers.mqtts.querySelector(".page-content"))),app.containers.sources&&(app.containers.sources.querySelector(".page-content").innerHTML=app.getCard({title:"Code Source",titlecolor:"#ffffff",description:"Deploy Arduino source Over The Air.",action:{id:"login",label:"Sign-In"},secondaryaction:{id:"signup",label:"Create an account"}}),app.displayLoginForm(app.containers.sources.querySelector(".page-content")));for(var t=document.querySelectorAll(".page-content form div.mdl-js-textfield"),e=0;e<t.length;e++)t[e].classList.remove("is-upgraded"),t[e].removeAttribute("data-upgraded");componentHandler.upgradeDom(),app.refreshButtonsSelectors(),app.setLoginAction(),app.setSignupAction()},app.resetSections=function(){"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG","resetSections()"),app.containers.objects&&(app.containers.objects.querySelector(".page-content").innerHTML=""),app.containers.object&&(app.containers.object.querySelector(".page-content").innerHTML=""),app.containers.flows&&(app.containers.flows.querySelector(".page-content").innerHTML=""),app.containers.flow&&(app.containers.flow.querySelector(".page-content").innerHTML=""),app.containers.dashboards&&(app.containers.dashboards.querySelector(".page-content").innerHTML=""),app.containers.dashboard&&(app.containers.dashboard.querySelector(".page-content").innerHTML=""),app.containers.snippets&&(app.containers.snippets.querySelector(".page-content").innerHTML=""),app.containers.snippet&&(app.containers.snippet.querySelector(".page-content").innerHTML=""),
app.containers.profile&&(app.containers.profile.querySelector(".page-content").innerHTML=""),app.containers.rules&&(app.containers.rules.querySelector(".page-content").innerHTML=""),app.containers.rule&&(app.containers.rule.querySelector(".page-content").innerHTML=""),app.containers.mqtts&&(app.containers.mqtts.querySelector(".page-content").innerHTML=""),app.containers.mqtt&&(app.containers.mqtt.querySelector(".page-content").innerHTML=""),app.containers.sources&&(app.containers.sources.querySelector(".page-content").innerHTML=""),app.containers.source&&(app.containers.source.querySelector(".page-content").innerHTML="")},app.showOrientation=function(){"true"==localStorage.getItem("settings.debug")&&toast(screen.orientation.type+" - "+screen.orientation.angle+".",{timeout:3e3,type:"info"})},app.setPosition=function(t){app.defaultResources.object.attributes.longitude=t.coords.longitude,app.defaultResources.object.attributes.latitude=t.coords.latitude,"true"==localStorage.getItem("settings.debug")&&toast("Geolocation (Accuracy="+t.coords.accuracy+") is set to: L"+t.coords.longitude+" - l"+t.coords.latitude,{timeout:3e3,type:"info"})},app.setPositionError=function(t){switch(t.code){case t.TIMEOUT:"true"==localStorage.getItem("settings.debug")&&toast("Browser geolocation error !\n\nTimeout.",{timeout:3e3,type:"error"});break;case t.POSITION_UNAVAILABLE:0==t.message.indexOf("Origin does not have permission to use Geolocation service")?"true"==localStorage.getItem("settings.debug")&&toast("Origin does not have permission to use Geolocation service - no fallback.",{timeout:3e3,type:"error"}):"true"==localStorage.getItem("settings.debug")&&toast("Browser geolocation error !\n\nPosition unavailable.",{timeout:3e3,type:"error"});break;case t.PERMISSION_DENIED:0==t.message.indexOf("Only secure origins are allowed")&&"true"==localStorage.getItem("settings.debug")&&toast("Only secure origins are allowed - no fallback.",{timeout:3e3,type:"error"});break;case t.UNKNOWN_ERROR:"true"==localStorage.getItem("settings.debug")&&toast("Can't find your position - no fallback.",{timeout:3e3,type:"error"})}},app.getLocation=function(){if(navigator.geolocation){var t={enableHighAccuracy:!1,timeout:2e5,maximumAge:5e5};navigator.geolocation.getCurrentPosition(app.setPosition,app.setPositionError,t)}else"true"==localStorage.getItem("settings.debug")&&toast("Geolocation is not supported by this browser.",{timeout:3e3,type:"warning"})},app.getCookie=function(t){for(var e=t+"=",a=document.cookie.split(";"),i=0;i<a.length;i++){for(var n=a[i];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(e))return n.substring(e.length,n.length)}return""},app.imageLazyLoading=function(){if("IntersectionObserver"in window){var t=new IntersectionObserver(e=>{e.map(function(e){e.intersectionRatio>0&&navigator.onLine&&(t.unobserve(e.target),app.preloadImage(e.target))})},{}),e=document.querySelectorAll("img.lazyloading");for(var a in e)e[a].childElementCount>-1&&(e[a].src=app.baseUrlCdn+"/img/m/placeholder.png",t.observe(e[a]))}else{var e=document.querySelectorAll("img.lazyloading");for(var a in e)e[a].childElementCount>-1&&app.preloadImage(e[a])}},null!==localStorage.getItem("refresh_token")&&null!==localStorage.getItem("refreshTokenExp")&&localStorage.getItem("refreshTokenExp")>moment().unix()&&(app.isLogged=!0),app.managePage=function(){var t=localStorage.getItem("currentPage");window.location.hash?(t=window.location.hash.substr(1),"terms"===t?app.onTermsButtonClick():"compatible-devices"===t?(app.getCompatibleDevices(),app.setSection("compatible-devices")):"openSourceLicenses"===t?(app.getOpenSourceLicenses(),app.setSection("openSourceLicenses")):"docs"===t?app.onDocsButtonClick():"status"===t?app.onStatusButtonClick():"settings"===t?app.onSettingsButtonClick():"login"===t?(app.isLogged=!1,localStorage.setItem("bearer",null),app.setSection(t)):app.setSection(t)):t?("object"===t||"objects"===t?app.setSection("objects"):"flow"===t||"flows"===t?app.setSection("flows"):"dashboard"===t||"dashboards"===t?app.setSection("dashboards"):"snippet"===t||"snippets"===t?app.setSection("snippets"):"rule"===t||"rules"===t?app.setSection("rules"):"mqtt"===t||"mqtts"===t?app.setSection("mqtts"):"source"===t||"sources"===t?app.setSection("sources"):app.setSection(t),"true"==localStorage.getItem("settings.debug")&&toast("Back to last page view if available in browser storage",{timeout:3e3,type:"info"})):app.setSection("index")},document.addEventListener("DOMContentLoaded",app.managePage),app.fetchIndex("index"),app.refreshButtonsSelectors(),app.setLoginAction(),app.setSignupAction(),app.refreshButtonsSelectors(),app.setPasswordResetAction(),app.setForgotAction(),app.isLogged&&void 0!==app.auth.username||(null!==localStorage.getItem("refresh_token")&&null!==localStorage.getItem("refreshTokenExp")&&localStorage.getItem("refreshTokenExp")>moment().unix()?(app.refreshAuthenticate(),app.setHiddenElement("signin_button"),app.setVisibleElement("logout_button"),app.getUnits(),app.getDatatypes(),app.getSnippets(),app.getFlows(),app.getSources(),setInterval(app.refreshAuthenticate,app.refreshExpiresInSeconds),"admin"==localStorage.getItem("role")&&app.addMenuItem("Users Accounts","supervisor_account","#users-list",null)):app.sessionExpired());for(var e in app.buttons.notifications)app.buttons.notifications[e].childElementCount>-1&&app.buttons.notifications[e].addEventListener("click",function(t){var e="",a="";if(e=getParameterByName("email",null)?decodeURI(getParameterByName("email",null)):app.getSetting("notifications.email"),a=getParameterByName("token",null)?decodeURI(getParameterByName("token",null)):app.getSetting("notifications.unsubscription_token"),e&&a){var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"GET",headers:i},o=t.target.parentNode.classList.contains("is-checked")?"unsubscribe":"subscribe",s=app.baseUrl+"/mail/"+e+"/"+o+"/"+t.target.getAttribute("name")+"/"+a+"/";fetch(s,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){console.log(t),toast("Settings updated.",{timeout:3e3,type:"done"})}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("Error occured on saving Notifications..."+t,{timeout:3e3,type:"error"})})}else"true"==localStorage.getItem("settings.debug")&&toast("Error occured on saving Notifications..."+error,{timeout:3e3,type:"error"})},!1);app.refreshButtonsSelectors(),document.querySelector(".sticky")&&(window.getComputedStyle(document.querySelector(".sticky")).position.match("sticky")||"true"==localStorage.getItem("settings.debug")&&toast("Your browser does not support 'position: sticky'!!.",{timeout:3e3,type:"info"})),document.getElementById("search-exp")&&document.getElementById("search-exp").addEventListener("keypress",function(t){if(13===t.keyCode){t.preventDefault();var e=this.value;"true"==localStorage.getItem("settings.debug")&&alert("Searching for "+e)}}),document.getElementById("filter-exp")&&document.getElementById("filter-exp").addEventListener("keypress",function(t){if(13===t.keyCode){t.preventDefault();var e,a=(this.value,"objects");document.querySelector("section#objects").classList.contains("is-active")?(a="objects",e=app.itemsSize.objects):document.querySelector("section#flows").classList.contains("is-active")&&(a="flows",e=app.itemsSize.flows),app.fetchItemsPaginated(a,this.value,1,e)}}),window.addEventListener("hashchange",function(){if(window.history&&window.history.pushState){localStorage.setItem("currentPage",window.location.hash.substr(1));var t=getParameterByName("id",null),e=window.location.hash;t?localStorage.setItem("currentResourceId",t):localStorage.setItem("currentResourceId",null),app.managePage()}"true"==localStorage.getItem("settings.debug")&&(console.log("[History]","hashchange"),console.log("[History]","resource id",e))},!1);for(var e in app.buttons.status)app.buttons.status[e].childElementCount>-1&&(app.buttons.status[e].removeEventListener("click",app.onStatusButtonClick,!1),app.buttons.status[e].addEventListener("click",app.onStatusButtonClick,!1));for(var e in app.buttons.settings)app.buttons.settings[e].childElementCount>-1&&(app.buttons.settings[e].removeEventListener("click",app.onSettingsButtonClick,!1),app.buttons.settings[e].addEventListener("click",app.onSettingsButtonClick,!1));for(var e in app.buttons.docs)app.buttons.docs[e].childElementCount>-1&&(app.buttons.docs[e].removeEventListener("click",app.onDocsButtonClick,!1),app.buttons.docs[e].addEventListener("click",app.onDocsButtonClick,!1));for(var e in app.buttons.terms)app.buttons.terms[e].childElementCount>-1&&(app.buttons.terms[e].removeEventListener("click",app.onTermsButtonClick,!1),app.buttons.terms[e].addEventListener("click",app.onTermsButtonClick,!1));var a=function(t,e){var a=document.createEvent("CustomEvent");return a.initCustomEvent(e,!0,!0,t.target),t.target.dispatchEvent(a),a=null,!1},i=!0,n={x:0,y:0},o={x:0,y:0},s={touchstart:function(t){n={x:t.touches[0].pageX,y:t.touches[0].pageY}},touchmove:function(t){i=!1,o={x:t.touches[0].pageX,y:t.touches[0].pageY}},touchend:function(t){if(i)a(t,"fc");else{var e=o.x-n.x,s=Math.abs(e),l=o.y-n.y,r=Math.abs(l);Math.max(s,r)>20&&a(t,s>r?e<0?"swl":"swr":l<0?"swu":"swd")}i=!0},touchcancel:function(t){i=!1}};for(var l in s)document.addEventListener(l,s[l],!1);void 0!==screen.orientation&&screen.orientation.addEventListener("change",app.showOrientation);var r=new Date;if(r.setTime(r.getTime()+24*app.cookieconsent*60*60*1e3),document.getElementById("cookieconsent.agree").addEventListener("click",function(t){document.getElementById("cookieconsent").remove(),document.cookie="cookieconsent=true;expires="+r.toUTCString()+";path=/",document.cookie="cookieconsentNoGTM=false;expires="+r.toUTCString()+";path=/",t.preventDefault()},!1),document.getElementById("cookieconsent.noGTM").addEventListener("click",function(t){document.getElementById("cookieconsent").remove(),document.cookie="cookieconsent=true;expires="+r.toUTCString()+";path=/",document.cookie="cookieconsentNoGTM=true;expires="+r.toUTCString()+";path=/","undefined"!=typeof mixpanel&&mixpanel.opt_out_tracking(),t.preventDefault()},!1),document.getElementById("cookieconsent.read").addEventListener("click",function(t){app.getTerms(),app.setSection("terms"),t.preventDefault()},!1),"true"!==app.getCookie("cookieconsent")?(document.getElementById("cookieconsent").classList.add("is-visible"),document.getElementById("cookieconsent").classList.remove("hidden")):(document.getElementById("cookieconsent").classList.add("hidden"),document.getElementById("cookieconsent").classList.remove("is-visible")),app.showMenu=function(){app.containers.menuElement.style.transform="translateX(0) !important",app.containers.menuElement.classList.add("menu--show"),app.containers.menuOverlayElement.classList.add("menu__overlay--show"),app.containers.drawerObfuscatorElement.remove()},app.hideMenu=function(){app.containers.menuElement.style.transform="translateX(-120%) !important",app.containers.menuElement.classList.remove("menu--show"),app.containers.menuOverlayElement.classList.add("menu__overlay--hide"),app.containers.menuOverlayElement.classList.remove("menu__overlay--show"),app.containers.menuElement.addEventListener("transitionend",app.onTransitionEnd,!1),app.containers.menuElement.classList.remove("is-visible")},app.onTransitionEnd=function(){touchStartPoint<10&&(app.containers.menuElement.style.transform="translateX(0)",app.containers.menuOverlayElement.classList.add("menu__overlay--show"),app.containers.menuElement.removeEventListener("transitionend",app.onTransitionEnd,!1))},app.updateNetworkStatus=function(){let t="",e="";navigator.onLine?(t="You are now online...",e="done",app.setHiddenElement("notification")):(t="You are now offline...",e="warning",app.setVisibleElement("notification")),toast(t,{timeout:3e3,type:e})},logout_button.addEventListener("click",function(t){app.auth={},app.resetDrawer(),app.sessionExpired(),toast("You have been disconnected :-(",{timeout:3e3,type:"done"}),app.setSection((null!==t.currentTarget.querySelector("a").getAttribute("hash")?t.currentTarget.querySelector("a").getAttribute("hash"):t.currentTarget.querySelector("a").getAttribute("href")).substr(1))},!1),signin_button.addEventListener("click",function(t){app.auth={},app.setSection("login")},!1),app.buttons.notification.addEventListener("click",function(t){app.showNotification()},!1),profile_button.addEventListener("click",function(t){app.isLogged?app.setSection((null!==t.currentTarget.querySelector("a").getAttribute("hash")?t.currentTarget.querySelector("a").getAttribute("hash"):t.currentTarget.querySelector("a").getAttribute("href")).substr(1)):app.setSection("login")},!1),app.setHiddenElement("notification"),app.refreshContainers(),app.containers.menuIconElement){app.containers.menuIconElement.addEventListener("click",app.showMenu,!1),app.containers.menuIconElement.querySelector("i.material-icons").setAttribute("id","imgIconMenu"),app.containers.menuOverlayElement.addEventListener("click",app.hideMenu,!1),app.containers.menuElement.addEventListener("transitionend",app.onTransitionEnd,!1);for(var d in app.containers.menuItems)app.containers.menuItems[d].childElementCount>-1&&app.containers.menuItems[d].addEventListener("click",function(t){app.setSection(t.currentTarget.getAttribute("href").substr(1)),app.hideMenu()},!1)}for(var d in app.containers.menuTabItems)app.containers.menuTabItems[d].childElementCount>-1&&(app.initNewSection(app.containers.menuTabItems[d].getAttribute("for")),app.containers.menuTabItems[d].addEventListener("click",function(t){app.setSection((null!==t.target.parentNode.getAttribute("hash")?t.target.parentNode.getAttribute("hash"):t.target.parentNode.getAttribute("href")).substr(1))},!1));document.body.addEventListener("touchstart",function(t){touchStartPoint=t.changedTouches[0].pageX,touchMovePoint=touchStartPoint;var e=document.querySelectorAll("section.is-active div.page-content.mdl-grid .mdl-button--fab, div.play-fab");for(var a in e)e[a].classList&&(e[a].classList.remove("is-here"),e[a].classList.add("is-not-here"))},!1),document.body.addEventListener("touchmove",function(t){touchMovePoint=t.touches[0].pageX,touchStartPoint<10&&touchMovePoint>100&&app.containers.menuElement.classList.add("is-visible")},!1),document.body.addEventListener("touchend",function(t){var e=document.querySelectorAll("section.is-active div.page-content.mdl-grid .mdl-button--fab, div.play-fab");for(var a in e)e[a].classList&&(e[a].classList.remove("is-not-here"),e[a].classList.add("is-here"))},!1),Array(Array(app.containers.objects,"objects"),Array(app.containers.flows,"flows"),Array(app.containers.snippets,"snippets"),Array(app.containers.dashboards,"dashboards"),Array(app.containers.mqtts,"mqtts"),Array(app.containers.sources,"sources"),Array(app.containers.rules,"rules")).map(function(t){t[0]&&t[0].addEventListener("DOMMouseScroll",function(e){var a=document.body.scrollHeight||window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0;document.querySelector("section#"+t[1]).getBoundingClientRect().bottom<=a&&t[0].classList.contains("is-active")})}),app.imageLazyLoading();var p=document.querySelectorAll(".passmatch");for(var c in p)p[c].childElementCount>-1&&p[c].addEventListener("input",function(t){""!=document.querySelector("#p2").value&&document.querySelector("#p1").value!=document.querySelector("#p2").value?(document.querySelector("#p2").parentNode.classList.add("is-invalid"),document.querySelector("#p2").parentNode.classList.add("is-dirty")):(document.querySelector("#p2").parentNode.classList.remove("is-invalid"),document.querySelector("#p2").parentNode.classList.remove("is-dirty"))});app.setDrawer(),""!==app.gtm&&"true"!==app.getCookie("cookieconsentNoGTM")&&(function(t,e,a,i,n){t[i]=t[i]||[],t[i].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var o=e.getElementsByTagName(a)[0],s=e.createElement(a);s.async=!0,s.src="//www.googletagmanager.com/gtm.js?id="+n,o.parentNode.insertBefore(s,o)}(window,document,"script","dataLayer",app.gtm),"true"==localStorage.getItem("settings.debug")&&console.log("[gtm]","gtm.start")),"serviceWorker"in navigator?"PushManager"in window?("true"==localStorage.getItem("settings.debug")&&console.log("[pushSubscription]","askPermission && subscribeUserToPush"),app.askPermission(),app.subscribeUserToPush(),document.addEventListener("clearCache",function(t){"true"==localStorage.getItem("settings.debug")&&console.log("[clearCache]","Please clear cache manually... :-)")},!1),void document.addEventListener("DOMContentLoaded",function(t){window.addEventListener("online",app.updateNetworkStatus,!1),window.addEventListener("offline",app.updateNetworkStatus,!1)})):void("true"==localStorage.getItem("settings.debug")&&console.log("[pushSubscription]","Push isn't supported on this browser.")):void("true"==localStorage.getItem("settings.debug")&&console.log("[ServiceWorker]","Service Worker isn't supported on this browser."))}(),app.resources.objects={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode,i={type:a.querySelector("select[name='Type']").value,name:a.querySelector("input[name='Name']").value,description:a.querySelector("textarea[name='Description']").value,position:null!==a.querySelector("input[name='Position']")?a.querySelector("input[name='Position']").value:"",longitude:null!==a.querySelector("input[name='Longitude']")?a.querySelector("input[name='Longitude']").value:"",latitude:null!==a.querySelector("input[name='Latitude']")?a.querySelector("input[name='Latitude']").value:"",ipv4:null!==a.querySelector("input[name='IPv4']")?a.querySelector("input[name='IPv4']").value:"",ipv6:null!==a.querySelector("input[name='IPv6']")?a.querySelector("input[name='IPv6']").value:"",secret_key_crypt:null!==a.querySelector("input[id='secret_key_crypt']")?a.querySelector("input[id='secret_key_crypt']").value:"",secret_key:null!==a.querySelector("input[id='secret_key']")?a.querySelector("input[id='secret_key']").value:"",isPublic:a.querySelector("label.mdl-switch").classList.contains("is-checked")===!0?"true":"false",fqbn:null!==a.querySelector("input[id='fqbn']")?a.querySelector("input[id='fqbn']").value:"",source_id:null!==a.querySelector("select[id='source_id']")?a.querySelector("select[id='source_id']").value:"",source_version:null!==a.querySelector("select[id='source_version']")?a.querySelector("select[id='source_version']").value:"",communication:{allowed_commands:[],interface:null!==a.querySelector("select[id='interface']")?a.querySelector("select[id='interface']").value:""},meta:{revision:a.querySelector("input[name='meta.revision']").value}};a.querySelector("label.mdl-checkbox[data-id='checkbox-communication.command_onoff']").classList.contains("is-checked")===!0&&i.communication.allowed_commands.push("onoff"),a.querySelector("label.mdl-checkbox[data-id='checkbox-communication.command_lowerupper']").classList.contains("is-checked")===!0&&i.communication.allowed_commands.push("lowerupper"),a.querySelector("label.mdl-checkbox[data-id='checkbox-communication.command_openclose']").classList.contains("is-checked")===!0&&i.communication.allowed_commands.push("openclose"),a.querySelector("label.mdl-checkbox[data-id='checkbox-communication.command_setvalgetval']").classList.contains("is-checked")===!0&&i.communication.allowed_commands.push("setvalgetval");var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"PUT",headers:n,body:JSON.stringify(i)},s=app.baseUrl+"/"+app.api_version+"/objects/"+e;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("objects"),toast("Object has been saved.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Object has not been saved.",{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Object id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={type:e.querySelector("select[name='Type']").value,name:e.querySelector("input[name='Name']").value,description:e.querySelector("textarea[name='Description']").value,position:null!==e.querySelector("input[name='Position']")?e.querySelector("input[name='Position']").value:"",longitude:null!==e.querySelector("input[name='Longitude']")?e.querySelector("input[name='Longitude']").value:"",latitude:null!==e.querySelector("input[name='Latitude']")?e.querySelector("input[name='Latitude']").value:"",ipv4:null!==e.querySelector("input[name='IPv4']")?e.querySelector("input[name='IPv4']").value:"",ipv6:null!==e.querySelector("input[name='IPv6']")?e.querySelector("input[name='IPv6']").value:"",secret_key:null!==e.querySelector("input[id='secret_key']")?e.querySelector("input[id='secret_key']").value:"",secret_key_crypt:null!==e.querySelector("input[id='secret_key_crypt']")?e.querySelector("input[id='secret_key_crypt']").value:"",isPublic:e.querySelector("label.mdl-switch").classList.contains("is-checked")===!0?"true":"false",fqbn:null!==e.querySelector("input[id='fqbn']")?e.querySelector("input[id='fqbn']").value:"",source_id:null!==e.querySelector("select[id='source_id']")?e.querySelector("select[id='source_id']").value:"",source_version:null!==e.querySelector("select[id='source_version']")?e.querySelector("select[id='source_version']").value:"",communication:{allowed_commands:[],interface:null!==e.querySelector("select[id='interface']")?e.querySelector("select[id='interface']").value:""}};"-"===a.source_id&&(a.source_id=""),e.querySelector("label.mdl-checkbox[data-id='checkbox-communication.command_onoff']").classList.contains("is-checked")===!0&&a.communication.allowed_commands.push("onoff"),e.querySelector("label.mdl-checkbox[data-id='checkbox-communication.command_lowerupper']").classList.contains("is-checked")===!0&&a.communication.allowed_commands.push("lowerupper"),e.querySelector("label.mdl-checkbox[data-id='checkbox-communication.command_openclose']").classList.contains("is-checked")===!0&&a.communication.allowed_commands.push("openclose"),e.querySelector("label.mdl-checkbox[data-id='checkbox-communication.command_setvalgetval']").classList.contains("is-checked")===!0&&a.communication.allowed_commands.push("setvalgetval");var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"POST",headers:i,body:JSON.stringify(a)},o=app.baseUrl+"/"+app.api_version+"/objects/";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("objects"),toast("Object has been added.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Object has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){},onDeploy:function(t,e){var a=new Headers;a.append("Authorization","Bearer "+localStorage.getItem("bearer")),a.append("Content-Type","application/json");var i={method:"POST",headers:a},n=app.baseUrl+"/"+app.api_version+"/ota/"+t+"/deploy/"+e;fetch(n,i).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){toast("Source is deploying to 1 available Object. This can take several minutes.",{timeout:1e4,type:"info"})})},onBuild:function(t,e){var a=new Headers;a.append("Authorization","Bearer "+localStorage.getItem("bearer")),a.append("Content-Type","application/json");var i={method:"POST",headers:a},n=app.baseUrl+"/"+app.api_version+"/objects/"+e+"/build";fetch(n,i).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){toast("Source is building 1 Object. This can take several minutes.",{timeout:1e4,type:"info"})})},onViewUi:function(t){window.open(app.baseUrl+"/"+app.api_version+"/objects/"+t+"/show/")},display:function(t,e,a,i){window.scrollTo(0,0),i&&displayPublic(t,e,a,i),t instanceof Object&&e?displayAdd(t,e,a,i):history.pushState({section:"object"},window.location.hash.substr(1),"#object?id="+t),app.initNewSection("object"),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"GET",headers:n},s=app.baseUrl+"/"+app.api_version+"/objects/"+t;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var e=0;e<t.data.length;e++){var i=t.data[e],n=void 0!==i.attributes.description?i.attributes.description:"";document.title=app.sectionsPageTitles.object.replace(/%s/g,i.attributes.name),app.containers.object&&(app.containers.object.querySelector(".page-content").innerHTML="");var o="";if(o='<section class="mdl-grid mdl-cell--12-col" data-id="'+i.id+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t<div class="mdl-list__item">',o+="\t\t\t<span class='mdl-list__item-primary-content'>",o+='\t\t\t\t<i class="material-icons mdl-textfield__icon">'+app.icons.objects+"</i>",o+='\t\t\t\t<h2 class="mdl-card__title-text">'+i.attributes.name+"</h2>",o+="\t\t\t</span>",o+="\t\t\t<span class='mdl-list__item-secondary-action'>",o+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+i.id+"'>",o+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t\t\t</button>",o+="\t\t\t</span>",o+="\t\t</div>",o+="\t\t<div class='mdl-cell--12-col hidden' id='description-"+i.id+"'>",o+=app.getField(app.icons.code,"Id",i.id,{type:"text",style:"text-transform: none !important;"}),i.attributes.description&&a!==!0&&(o+=app.getField(app.icons.description,"Description",n,{type:"text"})),i.attributes.meta.created&&(o+=app.getField(app.icons.date,"Created",moment(i.attributes.meta.created).format(app.date_format),{type:"text"})),i.attributes.meta.updated&&(o+=app.getField(app.icons.date,"Updated",moment(i.attributes.meta.updated).format(app.date_format),{type:"text"})),i.attributes.meta.revision&&(o+=app.getField(app.icons.update,"Revision",i.attributes.meta.revision,{type:"text"})),o+="\t\t</div>",o+="\t</div>",o+="</section>",o+=app.getSubtitle("Parameters"),o+='<section class="mdl-grid mdl-cell--12-col">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',a===!0&&(o+=app.getField(null,"meta.revision",i.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),o+=app.getField(app.icons.name,"Name",i.attributes.name,{type:"text",id:"Name",isEdit:a,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."})),i.attributes.type){var s=app.types.find(function(t){return t.name==i.attributes.type});s=void 0!==s?s:"",o+=a===!0?app.getField(app.icons.type,"Type",s.name,{type:"select",id:"Type",isEdit:a,options:app.types}):app.getField(app.icons.type,"Type",s.value,{type:"select",id:"Type",isEdit:a,options:app.types})}if(a===!0&&(o+=app.getField(app.icons.description,"Description",n,{type:"textarea",id:"Description",isEdit:a})),o+="\t</div>",o+="</section>",o+=app.getSubtitle("Security"),o+='<section class="mdl-grid mdl-cell--12-col">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',(i.attributes.secret_key||a===!0)&&(o+=app.getField("verified_user","Secret Key in symmetric signature",void 0!==i.attributes.secret_key?i.attributes.secret_key:"",{type:"text",style:"text-transform: none !important;",id:"secret_key",isEdit:a,pattern:app.patterns.secret_key,error:""}),o+=app.getField("","","When flow require signed payload, you should provide your secret to verify signature.",{type:"text",isEdit:!1})),(i.attributes.secret_key_crypt||a===!0)&&(o+=app.getField("vpn_key","Secret Key in symmetric cryptography",void 0!==i.attributes.secret_key_crypt?i.attributes.secret_key_crypt:"",{type:"text",style:"text-transform: none !important;",id:"secret_key_crypt",isEdit:a,pattern:app.patterns.secret_key_crypt,error:"This must be a 64 hexadecimal chars length A-F & 0-9"})),"true"==i.attributes.is_public&&a===!1?(o+=app.getField("visibility","true"==i.attributes.is_public?"Object is having a public url":"Object is only visible to you",i.attributes.is_public,{type:"switch",id:"Visibility",isEdit:a}),o+=app.getQrcodeImg(app.icons.date,"",i.id,{type:"text",isEdit:a}),app.getQrcode(app.icons.date,"",i.id,{type:"text",isEdit:a})):o+=app.getField("visibility","true"==i.attributes.is_public?"Object is having a public url":"Object is only visible to you",i.attributes.is_public,{type:"switch",id:"Visibility",isEdit:a}),o+="\t</div>",o+="</section>",(a||void 0!==i.attributes.communication&&i.attributes.communication.length>-1)&&(o+=app.getSubtitle("Communication"),o+='<section class="mdl-grid mdl-cell--12-col">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField("add_to_home_screen","Interface","",{type:"select",id:"interface",options:[{name:"restAPI",value:"restAPI"},{name:"messageQueue",value:"messageQueue"}],isEdit:a}),o+=app.getField("developer_mode","Allow command on/off","",{type:"checkbox",id:"communication.command_onoff",isEdit:a}),o+=app.getField("developer_mode","Allow command lower/upper","",{type:"checkbox",id:"communication.command_lowerupper",isEdit:a}),o+=app.getField("developer_mode","Allow command open/close","",{type:"checkbox",id:"communication.command_openclose",isEdit:a}),o+=app.getField("developer_mode","Allow command setVal/getVal","",{type:"checkbox",id:"communication.command_setvalgetval",isEdit:a}),o+="\t</div>",o+="</section>"),a||void 0!==i.attributes.fqbn){o+=app.getSubtitle("Over The Air (OTA)"),o+='<section class="mdl-grid mdl-cell--12-col">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField("code","Fqbn string",void 0!==i.attributes.fqbn?i.attributes.fqbn:"",{type:"text",style:"text-transform: none !important;",id:"fqbn",isEdit:a});let t=new Array,e=new Array({value:"-",name:"-"});"null"!=localStorage.getItem("sources")&&JSON.parse(localStorage.getItem("sources")).map(function(a){return a.id==i.attributes.source_id&&a.subversions.map(function(e){t.push({value:`Version ${e.version} - ${e.name}`,name:e.version})}),e.push({value:a.name,name:a.id})}),t.push({value:"Version 0",name:"0"}),o+=app.getField(app.icons.sources,"Arduino Source",void 0!==i.attributes.source_id?String(i.attributes.source_id):"-",{type:"select",id:"source_id",isEdit:a,options:e}),o+=app.getField(app.icons.version,"Source version",void 0!==i.attributes.source_version?String(i.attributes.source_version):"0",{type:"select",id:"source_version",isEdit:a,options:t}),(i.attributes.ipv4||a===!0)&&(o+=app.getField("my_location","IPv4",i.attributes.ipv4,{type:"text",id:"IPv4",isEdit:a,inputmode:"numeric",pattern:app.patterns.ipv4,error:"IPv4 should be valid."})),(i.attributes.ipv6||a===!0)&&(o+=app.getField("my_location","IPv6",i.attributes.ipv6,{type:"text",id:"IPv6",isEdit:a,inputmode:"numeric",pattern:app.patterns.ipv6,error:"IPv6 should be valid."})),i.attributes.otahist&&(o+=app.getField(app.icons.date,"OTA latest event",`${i.attributes.otahist.event}: ${i.attributes.otahist.status} (${i.attributes.otahist.date})`,{type:"text",id:"latest_event",isEdit:!1}))}if(!a&&void 0!==i.attributes.fqbn&&i.attributes.ipv4&&(o+='\t\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t\t<div class="mdl-list__item--three-line small-padding  mdl-card--expand pull-right">',o+='\t\t\t\t<button data-id="'+i.id+'" class="object_build_btn mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">',o+='\t\t\t\t\t<i class="arduino-icon build"> </i>Build',o+="\t\t\t\t</button>",o+='\t\t\t\t<button data-id="'+i.id+'" class="object_deploy_btn mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">',
o+='\t\t\t\t\t<i class="arduino-icon deploy"> </i>Deploy',o+="\t\t\t\t</button>",o+="\t\t\t</div>",o+="\t\t</div>"),o+="\t</div>",o+="</section>",a||void 0!==i.attributes.parameters&&i.attributes.parameters.length>-1){o+=app.getSubtitle("Custom Parameters"),o+='<section class="mdl-grid mdl-cell--12-col">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">';for(var e in i.attributes.parameters)o+=app.getField("note",i.attributes.parameters[e].name,i.attributes.parameters[e].value,{type:"text",id:i.attributes.parameters[e].name,isEdit:a});a&&(o+=app.getField("note",["Name","Value"],["",""],{type:"2inputs",pattern:[app.patterns.customAttributeName,app.patterns.customAttributeValue],error:["Name should not contains any space nor special char.","Value is free."],id:["Name[]","Value[]"],isEdit:!0})),o+="\t</div>",o+="</section>"}(a||i.attributes.longitude||i.attributes.latitude||i.attributes.position)&&(o+=app.getSubtitle("Localization"),o+='<section class="mdl-grid mdl-cell--12-col" style="padding-bottom: 50px !important;">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField("place","Longitude",i.attributes.longitude,{type:"text",id:"Longitude",isEdit:a,inputmode:"numeric",pattern:app.patterns.longitude,error:"Longitude should be valid."}),o+=app.getField("place","Latitude",i.attributes.latitude,{type:"text",id:"Latitude",isEdit:a,inputmode:"numeric",pattern:app.patterns.latitude,error:"Latitude should be valid."}),o+=app.getField("pin_drop","Position",i.attributes.position,{type:"text",id:"Position",isEdit:a,pattern:app.patterns.position,error:"Should not be longer than 255 chars."}),o+=app.getMap("my_location","osm",i.attributes.longitude,i.attributes.latitude,!1,!1,!1),o+="\t</div>",o+="</section>");var l=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];a?(o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+i.id+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+l[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>View</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[0]+"'>View Object</label>",o+="\t\t</button>",o+="\t</div>",""!==i.attributes.ui_id&&(o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+l[1]+"' class='viewui-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>View UI</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[1]+"'>View Object UI</label>",o+="\t\t</button>",o+="\t</div>"),o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+l[2]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>save</i>",o+="\t\t\t<label>Save</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[2]+"'>Save changes to Object</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>"):(o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+i.id+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+l[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>List</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[0]+"'>List all Objects</label>",o+="\t\t</button>",o+="\t</div>",void 0!==i.attributes.ui_id&&(o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+l[1]+"' class='viewui-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>web</i>",o+="\t\t\t<label>View UI</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[1]+"'>View Object UI</label>",o+="\t\t</button>",o+="\t</div>"),o+="\t<div class='mdl-cell--1-col-phone delete-button'>",o+="\t\t<button id='"+l[2]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>delete</i>",o+="\t\t\t<label>Delete</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[2]+"'>Delete Object...</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+l[3]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>edit</i>",o+="\t\t\t<label>Edit</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[3]+"'>Edit Object</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>"),app.containers.object.querySelector(".page-content").innerHTML=o,componentHandler.upgradeDom(),app.refreshButtonsSelectors();var r=document.getElementById("source_id");if(r&&r.addEventListener("change",function(t){if("-"!==t.srcElement.value){let e=JSON.parse(localStorage.getItem("sources")).find(e=>e.id==t.srcElement.value),a=document.getElementById("source_version");for(let t=a.options.length-1;t>=0;t--)a.options[t]=null;if(e.subversions.length<=0){let t=document.createElement("option");t.appendChild(document.createTextNode("Version 0")),t.value=0,a.appendChild(t)}else e.subversions.map(function(t){let e=document.createElement("option");e.appendChild(document.createTextNode(`Version ${t.version} - ${t.name}`)),e.value=t.version,a.appendChild(e)})}else{let t=document.getElementById("source_version");for(let e=t.options.length-1;e>=0;e--)t.options[e]=null;let e=document.createElement("option");e.appendChild(document.createTextNode("Version 0")),e.value=0,t.appendChild(e)}}),void 0!==i.attributes.ui_id&&app.buttons.viewuiObject&&app.buttons.viewuiObject.addEventListener("click",function(t){app.resources.objects.onViewUi(t.target.parentNode.getAttribute("data-id")),t.preventDefault()},!1),a){app.buttons.backObject.addEventListener("click",function(t){app.resources.objects.display(i.id,!1,!1,!1)},!1),app.buttons.saveObject.addEventListener("click",function(t){app.resources.objects.onEdit(t)},!1);var d=document.getElementById("switch-Visibility").parentNode;d&&d.addEventListener("change",function(t){t.target.parentElement.querySelector("div.mdl-switch__label").innerText=d.classList.contains("is-checked")!==!1?"Object is having a public url":"Object is only visible to you"})}else{for(var e in app.buttons.deploySourceObject)app.buttons.deploySourceObject[e].childElementCount>-1&&app.buttons.deploySourceObject[e].addEventListener("click",function(t){app.resources.objects.onDeploy(i.attributes.source_id,t.target.parentNode.getAttribute("data-id")),t.preventDefault()},!1);for(var e in app.buttons.buildSourceObject)app.buttons.buildSourceObject[e].childElementCount>-1&&app.buttons.buildSourceObject[e].addEventListener("click",function(t){app.resources.objects.onBuild(i.attributes.source_id,t.target.parentNode.getAttribute("data-id")),t.preventDefault()},!1);app.buttons.listObject.addEventListener("click",function(t){app.setSection("objects"),t.preventDefault()},!1),app.buttons.editObject2.addEventListener("click",function(t){app.resources.objects.display(i.id,!1,!0,!1),t.preventDefault()},!1)}if(i.attributes.longitude&&i.attributes.latitude){var p=L.map("osm").setView([parseFloat(i.attributes.latitude),parseFloat(i.attributes.longitude)],13);L.tileLayer("https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",{attribution:' <a href="//osm.org/copyright">OpenStreetMap</a>',minZoom:1,maxZoom:20,trackResize:!0,dragging:a}).addTo(p);var c=(L.popup(),L.Icon.extend({options:{shadowUrl:"/img/m/marker-shadow.png",iconSize:[25,41],shadowSize:[41,41],iconAnchor:[20,20],shadowAnchor:[20,20],popupAnchor:[-3,-76]}})),u=new c({iconUrl:"/img/m/marker-icon.png"}),m=L.marker([parseFloat(i.attributes.latitude),parseFloat(i.attributes.longitude)],{icon:u,draggable:a}).addTo(p);a!==!0?p.dragging.disable():m.on("dragend",function(t){var e=m.getLatLng();m.setLatLng(e,{draggable:!0}).bindPopup(e).update(),document.getElementById("Latitude").value=parseFloat(e.lat,10).toFixed(6),document.getElementById("Longitude").value=parseFloat(e.lng,10).toFixed(6)}),setTimeout(function(){p.invalidateSize(!0)},1e3)}app.setExpandAction(),app.setSection("object")}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayObject error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){window.scrollTo(0,0),history.pushState({section:"object"},window.location.hash.substr(1),"#object?id="+t),app.initNewSection("object"),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"GET",headers:n},s=app.baseUrl+"/"+app.api_version+"/objects/"+t+"/public";fetch(s,o).then(fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var e=0;e<t.data.length;e++){var i=t.data[e];document.title=app.sectionsPageTitles.object.replace(/%s/g,i.attributes.name),app.containers.object&&(app.containers.object.querySelector(".page-content").innerHTML="");var n="";if(n='<section class="mdl-grid mdl-cell--12-col" data-id="'+i.id+'">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+='\t\t<div class="mdl-list__item">',n+="\t\t\t<span class='mdl-list__item-primary-content'>",n+='\t\t\t\t<i class="material-icons">'+app.icons.objects+"</i>",n+='\t\t\t\t<h2 class="mdl-card__title-text">'+i.attributes.name+"</h2>",n+="\t\t\t</span>",n+="\t\t\t<span class='mdl-list__item-secondary-action'>",n+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+i.id+"'>",n+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",n+="\t\t\t\t</button>",n+="\t\t\t</span>",n+="\t\t</div>",n+="\t\t<div class='mdl-cell--12-col hidden' id='description-"+i.id+"'>",n+=app.getField(app.icons.code,"Id",i.id,{type:"input"}),i.attributes.description||a!==!0){var o=void 0!==i.attributes.description?i.attributes.description:"";n+=app.getField(app.icons.description,"Description",o,{type:"text"})}if(i.attributes.meta.created&&(n+=app.getField(app.icons.date,"Created",moment(i.attributes.meta.created).format(app.date_format),{type:"text"})),i.attributes.meta.updated&&(n+=app.getField(app.icons.date,"Updated",moment(i.attributes.meta.updated).format(app.date_format),{type:"text"})),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Parameters"),n+='<section class="mdl-grid mdl-cell--12-col">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',(i.attributes.ipv4||a===!0)&&(n+=app.getField("my_location","IPv4",i.attributes.ipv4,{type:"text",isEdit:a,inputmode:"numeric",pattern:app.patterns.ipv4,error:"IPv4 should be valid."})),(i.attributes.ipv6||a===!0)&&(n+=app.getField("my_location","IPv6",i.attributes.ipv6,{type:"text",isEdit:a,inputmode:"numeric",pattern:app.patterns.ipv6,error:"IPv6 should be valid."})),n+="\t</div>",n+="</section>",i.attributes.parameters&&i.attributes.parameters.length>-1){n+=app.getSubtitle("Custom Parameters"),n+='<section class="mdl-grid mdl-cell--12-col">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">';for(var s in i.attributes.parameters)n+=app.getField("note",i.attributes.parameters[s].name,i.attributes.parameters[s].value,{type:"text"});n+="\t</div>",n+="</section>"}if((i.attributes.longitude||i.attributes.latitude||i.attributes.position)&&(n+=app.getSubtitle("Localization"),n+='<section class="mdl-grid mdl-cell--12-col" style="padding-bottom: 50px !important;">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',i.attributes.longitude&&(n+=app.getField("place","Longitude",i.attributes.longitude,{type:"text"})),i.attributes.latitude&&(n+=app.getField("place","Latitude",i.attributes.latitude,{type:"text"})),i.attributes.position&&(n+=app.getField("pin_drop","Position/Localization (should be descriptive)",i.attributes.position,{type:"text"})),i.attributes.longitude&&i.attributes.latitude&&(n+=app.getMap("my_location","osm",i.attributes.longitude,i.attributes.latitude,!1,!1,!1)),n+="\t</div>",n+="</section>"),app.containers.object.querySelector(".page-content").innerHTML=n,componentHandler.upgradeDom(),i.attributes.longitude&&i.attributes.latitude){var l=L.map("osm").setView([parseFloat(i.attributes.latitude),parseFloat(i.attributes.longitude)],13);L.tileLayer("https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",{attribution:' <a href="//osm.org/copyright">OpenStreetMap</a>',minZoom:1,maxZoom:20,trackResize:!0,dragging:!1}).addTo(l);L.popup(),L.marker([parseFloat(i.attributes.latitude),parseFloat(i.attributes.longitude)],{draggable:!1}).addTo(l);setTimeout(function(){l.invalidateSize(!0)},1e3)}app.setExpandAction()}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayObject error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayAdd:function(t,e,a,i){history.pushState({section:"object_add"},window.location.hash.substr(1),"#object_add"),app.initNewSection("object_add");var n="";t.id=""!==t.id?t.id:app.getUniqueId(),t.attributes.longitude=parseFloat(""!==t.attributes.longitude?t.attributes.longitude:0).toFixed(6),t.attributes.latitude=parseFloat(""!==t.attributes.latitude?t.attributes.latitude:0).toFixed(6);var o=void 0!==t.attributes.description?t.attributes.description:"";n+=app.getSubtitle("Description"),n+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField(app.icons.name,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),n+=app.getField(app.icons.description,"Description",o,{type:"textarea",id:"Description",isEdit:!0}),n+=app.getField(app.icons.type,"Type",t.attributes.type,{type:"select",id:"Type",options:app.types,isEdit:!0}),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Security"),n+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField("verified_user","Secret Key in symmetric signature",void 0!==t.attributes.secret_key?t.attributes.secret_key:"",{type:"text",id:"secret_key",style:"text-transform: none !important;",isEdit:!0,pattern:app.patterns.secret_key,error:""}),n+=app.getField("","","When flow require signed payload, you should provide your secret to verify signature.",{type:"text",isEdit:!1}),n+=app.getField("vpn_key","Secret Key in symmetric cryptography",void 0!==t.attributes.secret_key_crypt?t.attributes.secret_key_crypt:"",{type:"text",id:"secret_key_crypt",style:"text-transform: none !important;",isEdit:!0,pattern:app.patterns.secret_key_crypt,error:""}),n+=app.getField("visibility","Object is only visible to you",void 0!==t.attributes.is_public&&t.attributes.is_public,{type:"switch",id:"Visibility",isEdit:!0}),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Communication"),n+='<section class="mdl-grid mdl-cell--12-col">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField("add_to_home_screen","Interface","",{type:"select",id:"interface",options:[{name:"restAPI",value:"restAPI"},{name:"messageQueue",value:"messageQueue"}],isEdit:!0}),n+=app.getField("developer_mode","Allow command on/off","",{type:"checkbox",id:"communication.command_onoff",isEdit:!0}),n+=app.getField("developer_mode","Allow command lower/upper","",{type:"checkbox",id:"communication.command_lowerupper",isEdit:!0}),n+=app.getField("developer_mode","Allow command open/close","",{type:"checkbox",id:"communication.command_openclose",isEdit:!0}),n+=app.getField("developer_mode","Allow command setVal/getVal","",{type:"checkbox",id:"communication.command_setvalgetval",isEdit:!0}),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Over The Air (OTA)"),n+='<section class="mdl-grid mdl-cell--12-col">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField(app.icons.code,"Fqbn string",void 0!==t.attributes.fqbn?t.attributes.fqbn:"",{type:"text",style:"text-transform: none !important;",id:"fqbn",isEdit:!0});let s=new Array,l=new Array;"null"!=localStorage.getItem("sources")&&(JSON.parse(localStorage.getItem("sources")).map(function(e){return e.id==t.attributes.source_id&&e.subversions.map(function(t){s.push({value:`Version ${t.version} - ${t.name}`,name:t.id})}),l.push({value:e.name,name:e.id})}),l.push({value:"-",name:"-"})),s.push({value:"Version 0",name:"0"}),n+=app.getField(app.icons.sources,"Arduino Source",t.attributes.source_id,{type:"select",id:"source_id",isEdit:!0,options:l}),n+=app.getField(app.icons.version,"Source version",t.attributes.source_version,{type:"select",id:"source_version",isEdit:!0,options:s}),n+=app.getField("my_location","IPv4",t.attributes.ipv4,{type:"text",id:"IPv4",isEdit:!0,inputmode:"numeric",pattern:app.patterns.ipv4,error:"IPv4 should be valid."}),n+=app.getField("my_location","IPv6",t.attributes.ipv6,{type:"text",id:"IPv6",isEdit:!0,inputmode:"numeric",pattern:app.patterns.ipv6,error:"IPv6 should be valid."}),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Custom Parameters"),n+='<section class="mdl-grid mdl-cell--12-col">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField("note",["Name","Value"],["",""],{type:"2inputs",pattern:[app.patterns.customAttributeName,app.patterns.customAttributeValue],error:["Name should not contains any space nor special char.","Value is free."],id:["Name[]","Value[]"],isEdit:!0}),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Localization"),n+='<section class="mdl-grid mdl-cell--12-col" style="padding-bottom: 50px !important;">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField("place","Longitude",t.attributes.longitude,{type:"text",id:"Longitude",isEdit:!0,inputmode:"numeric",pattern:app.patterns.longitude,error:"Longitude should be valid."}),n+=app.getField("place","Latitude",t.attributes.latitude,{type:"text",id:"Latitude",isEdit:!0,inputmode:"numeric",pattern:app.patterns.latitude,error:"Latitude should be valid."}),n+=app.getField("pin_drop","Position/Localization (should be descriptive)",t.attributes.position,{type:"text",id:"Position",isEdit:!0,pattern:app.patterns.position,error:"Should not be longer than 255 chars."}),n+=app.getMap("my_location","osmAdd",t.attributes.longitude,t.attributes.latitude,!1,!1,!1),n+="\t</div>",n+="</section>";var r=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];n+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(n+="\t<div class='mdl-layout-spacer'></div>"),n+="\t<div class='mdl-cell--1-col-phone pull-left'>",n+="\t\t<button id='"+r[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>chevron_left</i>",n+="\t\t\t<label>List</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+r[0]+"'>List all Objects</label>",n+="\t\t</button>",n+="\t</div>",n+="\t<div class='mdl-cell--1-col-phone pull-right'>",n+="\t\t<button id='"+r[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>edit</i>",n+="\t\t\t<label>Save</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+r[1]+"'>Save new Object</label>",n+="\t\t</button>",n+="\t</div>",app.isLtr()||(n+="\t<div class='mdl-layout-spacer'></div>"),n+="</section>",app.containers.object_add.querySelector(".page-content").innerHTML=n,componentHandler.upgradeDom();var d=document.getElementById("source_id");d&&d.addEventListener("change",function(t){if("-"!==t.srcElement.value){let e=JSON.parse(localStorage.getItem("sources")).find(e=>e.id==t.srcElement.value),a=document.getElementById("source_version");for(let t=a.options.length-1;t>=0;t--)a.options[t]=null;if(e.subversions.length<=0){let t=document.createElement("option");t.appendChild(document.createTextNode("Version 0")),t.value=0,a.appendChild(t)}else e.subversions.map(function(t){let e=document.createElement("option");e.appendChild(document.createTextNode(`Version ${t.version} - ${t.name}`)),e.value=t.version,a.appendChild(e)})}else{let t=document.getElementById("source_version");for(let e=t.options.length-1;e>=0;e--)t.options[e]=null;let e=document.createElement("option");e.appendChild(document.createTextNode("Version 0")),e.value=0,t.appendChild(e)}}),app.getLocation();var p=L.map("osmAdd").setView([parseFloat(t.attributes.latitude),parseFloat(t.attributes.longitude)],13);L.tileLayer("https://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",{attribution:" <a href='//osm.org/copyright'>OpenStreetMap</a>",minZoom:1,maxZoom:20,trackResize:!0,dragging:!0}).addTo(p);var c=(L.popup(),L.Icon.extend({options:{shadowUrl:"/img/m/marker-shadow.png",iconSize:[25,41],shadowSize:[41,41],iconAnchor:[20,20],shadowAnchor:[20,20],popupAnchor:[-3,-76]}})),u=new c({iconUrl:"/img/m/marker-icon.png"}),m=L.marker([parseFloat(t.attributes.latitude),parseFloat(t.attributes.longitude)],{icon:u,draggable:!0}).addTo(p);m.on("dragend",function(t){var e=m.getLatLng();m.setLatLng(e,{draggable:!0}).bindPopup(e).update(),document.getElementById("Latitude").value=parseFloat(e.lat,10).toFixed(6),document.getElementById("Longitude").value=parseFloat(e.lng,10).toFixed(6)}),setTimeout(function(){p.invalidateSize(!0)},1e3),app.refreshButtonsSelectors(),app.buttons.addObjectBack.addEventListener("click",function(t){app.setSection("objects"),t.preventDefault()},!1),app.buttons.addObject.addEventListener("click",function(t){app.resources.objects.onAdd(t)},!1);var b=document.getElementById("switch-Visibility").parentNode;b&&b.addEventListener("change",function(t){t.target.parentElement.querySelector("div.mdl-switch__label").innerText=b.classList.contains("is-checked")!==!1?"Object is having a public url":"Object is only visible to you"}),app.setExpandAction()},displayItem:function(t){var e=void 0!==t.attributes.name?t.attributes.name:"",a=void 0!==t.attributes.description?t.attributes.description.substring(0,app.cardMaxChars):"",i=(void 0!==t.attributes.type&&t.attributes.type,"");if(i+='<div class="mdl-grid mdl-cell" data-action="view" data-type="objects" data-id="'+t.id+'">',i+='\t<div class="mdl-card mdl-shadow--2dp">',i+='\t\t<div class="mdl-card__title">',i+='\t\t\t<i class="material-icons">'+app.icons.objects+"</i>",i+='\t\t\t<h3 class="mdl-card__title-text">'+e+"</h3>",i+="\t\t</div>",i+=app.getField(null,null,a,{type:"textarea",isEdit:!1}),i+="<div class='mdl-list__item--three-line small-padding'>",i+="\t\t<span class='type' id='"+t.id+"-connected'><i class='material-icons md-32'>"+(t.attributes.is_connected===!0?"flash_on":"flash_off")+"</i></span>",i+="\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+t.id+"-connected'>"+(t.attributes.is_connected===!0?"Connected":"Disconnected")+"</div>",t.attributes.type){var n=app.types.find(function(e){return e.name==t.attributes.type});n=void 0!==n?n:"",i+="\t<span class='type' id='"+t.id+"-type'><i class='material-icons md-32'>"+n.name+"</i></span>",i+="\t<div class='mdl-tooltip mdl-tooltip--top' for='"+t.id+"-type'>"+n.value+"</div>"}return"true"==t.attributes.is_public&&(i+="\t<span class='isPublic' id='"+t.id+"-isPublic'><i class='material-icons md-32'>visibility</i></span>",i+="\t<div class='mdl-tooltip mdl-tooltip--top' for='"+t.id+"-isPublic'>Public</div>"),(t.attributes.longitude&&t.attributes.latitude||t.attributes.position)&&(i+="\t<span class='isLocalized' id='"+t.id+"-isLocalized'><i class='material-icons md-32'>location_on</i></span>",i+="\t<div class='mdl-tooltip mdl-tooltip--top' for='"+t.id+"-isLocalized'>Localized</div>"),""!=t.attributes.secret_key&&(i+="\t<span class='Signature' id='"+t.id+"-Signature'><i class='material-icons md-32'>verified_user</i></span>",i+="\t<div class='mdl-tooltip mdl-tooltip--top' for='"+t.id+"-Signature'>Signature Secret Key</div>"),""!=t.attributes.secret_key_crypt&&(i+="\t<span class='Crypt' id='"+t.id+"-Crypt'><i class='material-icons md-32'>vpn_key</i></span>",i+="\t<div class='mdl-tooltip mdl-tooltip--top' for='"+t.id+"-Crypt'>Encryption Secret Key</div>"),i+="</div>",i+='\t\t<div class="mdl-card__actions mdl-card--border">',i+='\t\t\t<span class="pull-left mdl-card__date">',i+='\t\t\t\t<button data-id="'+t.id+'" class="swapDate mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',i+='\t\t\t\t\t<i class="material-icons">update</i>',i+="\t\t\t\t</button>",i+='\t\t\t\t<span data-date="created" class="visible">Created on '+moment(t.attributes.meta.created).format(app.date_format)+"</span>",i+=t.attributes.meta.updated?'\t\t\t\t<span data-date="updated" class="hidden">Updated on '+moment(t.attributes.meta.updated).format(app.date_format)+"</span>":'\t\t\t\t<span data-date="updated" class="hidden">Never been updated yet.</span>',i+="\t\t\t</span>",i+='\t\t\t<span class="pull-right mdl-card__menuaction">',i+='\t\t\t\t<button id="menu_'+t.id+'" class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',i+='\t\t\t\t\t<i class="material-icons">'+app.icons.menu+"</i>",i+="\t\t\t\t</button>",i+="\t\t\t</span>",i+='\t\t\t<ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="menu_'+t.id+'">',i+='\t\t\t\t<li class="mdl-menu__item delete-button">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons delete-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.delete+"</i>Delete</a>",i+="\t\t\t\t</li>",i+='\t\t\t\t<li class="mdl-menu__item">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons edit-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.edit+"</i>Edit</a>",i+="\t\t\t\t</li>",i+='\t\t\t\t<li class="mdl-menu__item">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons copy-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'">'+app.icons.copy+'</i><textarea class="copytextarea">'+t.id+"</textarea>Copy ID to clipboard</a>",i+="\t\t\t\t</li>",i+="\t\t\t</ul>",i+="\t\t</div>",i+="\t</div>",i+="</div>"}},app.resources.flows={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode;console.log(a.querySelector("input[name='MQTT Topic']").value);var i={name:a.querySelector("input[name='Name']").value,mqtt_topic:a.querySelector("input[name='MQTT Topic']").value,data_type:a.querySelector("select[name='DataType']").value,unit:a.querySelector("select[name='Unit']").value,require_signed:a.querySelector("label.mdl-switch[data-id='switch-edit_require_signed']").classList.contains("is-checked")===!0?"true":"false",require_encrypted:a.querySelector("label.mdl-switch[data-id='switch-edit_require_encrypted']").classList.contains("is-checked")===!0?"true":"false",meta:{revision:a.querySelector("input[name='meta.revision']").value}},n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"PUT",headers:n,body:JSON.stringify(i)},s=app.baseUrl+"/"+app.api_version+"/flows/"+e;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("flows");var a=JSON.parse(localStorage.getItem("flows"));app.flows=[],a.map(function(a){a.id==e?app.flows.push({id:a.id,name:t.flow.data.attributes.name,type:t.flow.data.type}):app.flows.push({id:a.id,name:a.name,type:a.type})}),localStorage.setItem("flows",JSON.stringify(app.flows)),toast("Flow has been saved.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Flow has not been saved."+t,{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Flow id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,mqtt_topic:e.querySelector("input[name='MQTT Topic']").value,data_type:e.querySelector("select[name='DataType']").value,unit:e.querySelector("select[name='Unit']").value,require_signed:e.querySelector("label.mdl-switch[data-id='switch-add_require_signed']").classList.contains("is-checked")===!0?"true":"false",require_encrypted:e.querySelector("label.mdl-switch[data-id='switch-add_require_encrypted']").classList.contains("is-checked")===!0?"true":"false"};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onAddFlow",JSON.stringify(a));var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"POST",headers:i,body:JSON.stringify(a)},o=app.baseUrl+"/"+app.api_version+"/flows/";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("flows");var e=new Array;"null"!=JSON.parse(localStorage.getItem("flows"))&&JSON.parse(localStorage.getItem("flows")).length>-1&&(e=JSON.parse(localStorage.getItem("flows"))),e.push({id:t.flow.data.id,name:t.flow.data.attributes.name,type:t.flow.data.type}),localStorage.setItem("flows",JSON.stringify(e)),toast("Flow has been added.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Flow has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){var e=JSON.parse(localStorage.getItem("flows"));app.flows=[],e.filter(function(e){e.id!=t&&app.flows.push({id:e.id,name:e.name,type:e.type})}),localStorage.setItem("flows",JSON.stringify(app.flows))},display:function(t,e,a,i){history.pushState({section:"flow"},window.location.hash.substr(1),"#flow?id="+t),app.initNewSection("flow"),window.scrollTo(0,0),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"GET",headers:n},s=app.baseUrl+"/"+app.api_version+"/flows/"+t;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var i=0;i<e.data.length;i++){var n=e.data[i];document.title=app.sectionsPageTitles.flow.replace(/%s/g,n.attributes.name),app.containers.flow&&(app.containers.flow.querySelector(".page-content").innerHTML="");var s="",l="";l='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'">',l+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+='\t\t<div class="mdl-list__item">',l+="\t\t\t<span class='mdl-list__item-primary-content'>",l+='\t\t\t\t<i class="material-icons mdl-textfield__icon">'+app.icons.flows+"</i>",l+='\t\t\t\t<h2 class="mdl-card__title-text">'+n.attributes.name+"</h2>",l+="\t\t\t</span>",l+="\t\t\t<span class='mdl-list__item-secondary-action'>",l+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+n.id+"'>",l+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",l+="\t\t\t\t</button>",l+="\t\t\t</span>",l+="\t\t</div>",l+="\t\t<div class='mdl-cell--12-col hidden' id='description-"+n.id+"'>",l+=app.getField(app.icons.code,"Id",n.id,{type:"text",
style:"text-transform: none !important;"}),n.attributes.description&&a!==!0&&(l+=app.getField(app.icons.description,"Description",app.nl2br(n.attributes.description),{type:"text"})),n.attributes.meta.created&&(l+=app.getField(app.icons.date,"Created",moment(n.attributes.meta.created).format(app.date_format),{type:"text"})),n.attributes.meta.updated&&(l+=app.getField(app.icons.date,"Updated",moment(n.attributes.meta.updated).format(app.date_format),{type:"text"})),n.attributes.meta.revision&&(l+=app.getField(app.icons.update,"Revision",n.attributes.meta.revision,{type:"text"})),l+="\t\t</div>",l+="\t</div>",l+="</section>";var r=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];if(a){localStorage.getItem("units")||app.getUnits();var d=JSON.parse(localStorage.getItem("units"));localStorage.getItem("datatypes")||app.getDatatypes();var p=JSON.parse(localStorage.getItem("datatypes"));l+='<section class="mdl-grid mdl-cell--12-col">',l+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',l+=app.getField(null,"meta.revision",n.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),l+=app.getField(app.icons.name,"Name",void 0!==n.attributes.name?n.attributes.name:"",{type:"text",id:"Name",isEdit:a}),l+=app.getField(app.icons.mqtts,"MQTT Topic",void 0!==n.attributes.mqtt_topic?n.attributes.mqtt_topic:"",{type:"text",style:"text-transform: none !important;",id:"MQTTTopic",isEdit:a}),l+=app.getField(app.icons.units,"Unit",n.attributes.unit,{type:"select",id:"Unit",isEdit:!0,options:d}),l+=app.getField(app.icons.datatypes,"DataType",n.attributes.data_type,{type:"select",id:"DataType",isEdit:!0,options:p}),l+=app.getField("verified_user",n.attributes.require_signed!==!1?"Require signed payload from Object":"Does not require signed payload from Object",n.attributes.require_signed,{type:"switch",id:"edit_require_signed",isEdit:a}),l+=app.getField("vpn_key",n.attributes.require_encrypted!==!1?"Require encrypted payload from Object":"Does not require encrypted payload from Object",n.attributes.require_encrypted,{type:"switch",id:"edit_require_encrypted",isEdit:a}),l+="\t</div>",l+="</section>",l+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t+"'>",app.isLtr()&&(l+="\t<div class='mdl-layout-spacer'></div>"),l+="\t<div class='mdl-cell--1-col-phone pull-left'>",l+="\t\t<button id='"+r[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",l+="\t\t\t<i class='material-icons'>chevron_left</i>",l+="\t\t\t<label>View</label>",l+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+r[0]+"'>View Flow</div>",l+="\t\t</button>",l+="\t</div>",l+="\t<div class='mdl-cell--1-col-phone pull-right'>",l+="\t\t<button id='"+r[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",l+="\t\t\t<i class='material-icons'>save</i>",l+="\t\t\t<label>Save</label>",l+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+r[1]+"'>Save Flow</div>",l+="\t\t</button>",l+="\t</div>",app.isLtr()||(l+="\t<div class='mdl-layout-spacer'></div>"),l+="</section>"}else{if(l+='<section class="mdl-grid mdl-cell--12-col">',l+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n.attributes.type&&(l+=app.getField("extension","Type",n.attributes.type,{type:"text",id:"Type",isEdit:a})),n.attributes.mqtt_topic&&(l+=app.getField(app.icons.mqtts,"MQTT Topic",n.attributes.mqtt_topic,{type:"text",style:"text-transform: none !important;",id:"MQTTTopic",isEdit:a})),n.attributes.unit&&"null"!==localStorage.getItem("units")&&JSON.parse(localStorage.getItem("units"))){var c=JSON.parse(localStorage.getItem("units")).find(function(t){return t.name==n.attributes.unit});l+=app.getField(app.icons.units,"Unit",c.value,{type:"select",id:"Unit",isEdit:a,options:app.units})}else app.getUnits();if(n.attributes.data_type){var u=JSON.parse(localStorage.getItem("datatypes")).find(function(t){return t.name==n.attributes.data_type}).value;l+=app.getField(app.icons.datatypes,"DataType",u,{type:"select",id:"DataType",isEdit:a,options:app.datatypes})}l+=app.getField("verified_user",n.attributes.require_signed!==!1?"Require signed payload from Object":"Does not require signed payload from Object",n.attributes.require_signed,{type:"switch",id:"show_require_signed",isEdit:a}),l+=app.getField("vpn_key",n.attributes.require_encrypted!==!1?"Require encrypted payload from Object":"Does not require encrypted payload from Object",n.attributes.require_encrypted,{type:"switch",id:"show_require_encrypted",isEdit:a}),l+="\t</div>",l+="</section>",l+="<section class='mdl-grid mdl-cell--12-col' id='"+n.id+"'>",l+="\t<div class='mdl-cell--12-col mdl-card mdl-shadow--2dp'>",l+="\t\t<span class='mdl-list__item mdl-list__item--two-line'>",l+="\t\t\t<span class='mdl-list__item-primary-content'>",l+="\t\t\t\t<span>"+n.attributes.name+" ("+c.value+"/"+u+")</span>",l+="\t\t\t\t<span class='mdl-list__item-sub-title' id='flow-graph-time-"+n.id+"'></span>",l+="\t\t\t</span>",l+="\t\t</span>",l+="\t\t<span class='mdl-list__item' id='flow-graph-"+n.id+"' style='width:100%; height:200px;'>",l+="\t\t\t<span class='mdl-list__item-sub-title mdl-chip mdl-chip__text'></span>",l+="\t\t</span>";var m=(""!==n.attributes.color&&n.attributes.color,app.baseUrl+"/"+app.api_version+"/data/"+n.id+"?limit=100&sort=desc");fetch(m,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){s+="\t<div class='mdl-cell--12-col mdl-card mdl-shadow--2dp'>",s+="\t\t<div class='mdl-list__item small-padding'>",s+="\t\t\t<span class='mdl-list__item-primary-content'>",s+="\t\t\t\t<i class='material-icons'>"+app.icons.datapoints+"</i>",s+="\t\t\t\tData Points",s+="\t\t\t</span>",s+="\t\t\t<span class='mdl-list__item-secondary-action'>",s+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='datapoints-"+n.id+"'>",s+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",s+="\t\t\t\t</button>",s+="\t\t\t</span>",s+="\t\t</div>",s+="\t\t<div class='mdl-cell mdl-cell--12-col hidden' id='datapoints-"+n.id+"'>";t&&t.data&&"errors"!==t.data.type&&t.data.map(function(t){var e;if("geo"==u){var a={longitude:"",latitude:""};[a.longitude,a.latitude]=t.attributes.value.split(";"),e=a.longitude+", "+a.latitude}else e=c.format.replace(/%s/g,t.attributes.value);return s+=app.getField(app.icons.datapoints,moment(t.attributes.timestamp).format(app.date_format),e,{type:"text",isEdit:!1}),[t.attributes.timestamp,t.attributes.value]}),componentHandler.upgradeDom(),s+="\t\t</div>",s+="\t</div>";var e=document.createElement("div");e.className="mdl-grid mdl-cell--12-col",e.dataset.id="last-datapoints_"+n.id,e.innerHTML=s,app.containers.flow.querySelector(".page-content").appendChild(e),componentHandler.upgradeDom(),app.setExpandAction()}).catch(function(t){"Error: Not Found"==t?toast("No data found, graph remain empty.",{timeout:3e3,type:"warning"}):"true"==localStorage.getItem("settings.debug")&&toast("displayFlow error out..."+t,{timeout:3e3,type:"error"})}),l+="\t</div>",l+="</section>",l+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+n.id+"'>",app.isLtr()&&(l+="\t<div class='mdl-layout-spacer'></div>"),l+="\t<div class='mdl-cell--1-col-phone pull-left'>",l+="\t\t<button id='"+r[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",l+="\t\t\t<i class='material-icons'>chevron_left</i>",l+="\t\t\t<label>List</label>",l+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+r[0]+"'>List all Flows</div>",l+="\t\t</button>",l+="\t</div>",l+="\t<div class='mdl-cell--1-col-phone delete-button'>",l+="\t\t<button id='"+r[1]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",l+="\t\t\t<i class='material-icons'>delete</i>",l+="\t\t\t<label>Delete</label>",l+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+r[1]+"'>Delete Flow...</div>",l+="\t\t</button>",l+="\t</div>",l+="\t<div class='mdl-cell--1-col-phone pull-right'>",l+="\t\t<button id='"+r[2]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",l+="\t\t\t<i class='material-icons'>edit</i>",l+="\t\t\t<label>Edit</label>",l+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+r[2]+"'>Edit Flow</div>",l+="\t\t</button>",l+="\t</div>",app.isLtr()||(l+="\t<div class='mdl-layout-spacer'></div>"),l+="</section>"}var b=document.createElement("div");if(b.className="page-content mdl-grid mdl-grid--no-spacing",b.dataset.idsupercoollllll=n.id,b.innerHTML=l,app.containers.flow.querySelector(".page-content").remove(),app.containers.flow.appendChild(b),app.refreshButtonsSelectors(),a){app.buttons.backFlow.addEventListener("click",function(t){app.resources.flows.display(n.id,!1,!1,!1)},!1),app.buttons.saveFlow.addEventListener("click",function(t){app.resources.flows.onEdit(t)},!1);var g=document.getElementById("switch-edit_require_signed").parentNode;g&&g.addEventListener("change",function(t){t.target.parentElement.querySelector("div.mdl-switch__label").innerText=g.classList.contains("is-checked")!==!1?"Require signed payload from Object":"Does not require signed payload from Object"});var f=document.getElementById("switch-edit_require_encrypted").parentNode;f&&f.addEventListener("change",function(t){t.target.parentElement.querySelector("div.mdl-switch__label").innerText=f.classList.contains("is-checked")!==!1?"Require encrypted payload from Object":"Does not require encrypted payload from Object"})}else app.buttons.listFlow.addEventListener("click",function(t){app.setSection("flows"),t.preventDefault()},!1),app.buttons.editFlow2.addEventListener("click",function(t){app.resources.flows.display(n.id,!1,!0,!1)},!1);componentHandler.upgradeDom(),app.setExpandAction(),app.setSection("flow")}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayFlow error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){history.pushState({section:"flow_add"},window.location.hash.substr(1),"#flow_add"),app.initNewSection("flow_add"),localStorage.getItem("units")||app.getUnits();var n=JSON.parse(localStorage.getItem("units"));localStorage.getItem("datatypes")||app.getDatatypes();var o=JSON.parse(localStorage.getItem("datatypes")),s="";s='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',s+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',s+=app.getField(app.icons.flows,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),s+=app.getField(app.icons.mqtts,"MQTT Topic",t.attributes.mqtt_topic,{type:"text",id:"MQTTTopic",isEdit:!0}),s+=app.getField(app.icons.units,"Unit",t.attributes.unit,{type:"select",id:"Unit",isEdit:!0,options:n}),s+=app.getField(app.icons.datatypes,"DataType",t.attributes.datatype,{type:"select",id:"DataType",isEdit:!0,options:o}),s+=app.getField("verified_user",t.attributes.require_signed!==!1?"Does not require signed payload  from Object":"Does not require signed payload from Object",t.attributes.require_signed,{type:"switch",id:"add_require_signed",isEdit:!0}),s+=app.getField("vpn_key",(t.attributes.require_encrypted,"Does not require encrypted payload from Object"),t.attributes.require_encrypted,{type:"switch",id:"add_require_encrypted",isEdit:!0}),s+="\t</div>",s+="</section>";var l=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];s+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(s+="\t<div class='mdl-layout-spacer'></div>"),s+="\t<div class='mdl-cell--1-col-phone pull-left'>",s+="\t\t<button id='"+l[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",s+="\t\t\t<i class='material-icons'>chevron_left</i>",s+="\t\t\t<label>List</label>",s+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[0]+"'>List all Flows</label>",s+="\t\t</button>",s+="\t</div>",s+="\t<div class='mdl-cell--1-col-phone pull-right'>",s+="\t\t<button id='"+l[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",s+="\t\t\t<i class='material-icons'>edit</i>",s+="\t\t\t<label>Save</label>",s+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[1]+"'>Save new Flow</label>",s+="\t\t</button>",s+="\t</div>",app.isLtr()||(s+="\t<div class='mdl-layout-spacer'></div>"),s+="</section>",app.containers.flow_add.querySelector(".page-content").innerHTML=s,componentHandler.upgradeDom(),app.refreshButtonsSelectors(),app.buttons.addFlowBack.addEventListener("click",function(t){app.setSection("flows"),t.preventDefault()},!1),app.buttons.addFlow.addEventListener("click",function(t){app.resources.flows.onAdd(t)},!1);var r=document.getElementById("switch-add_require_signed").parentNode;r&&r.addEventListener("change",function(t){t.target.parentElement.querySelector("div.mdl-switch__label").innerText=r.classList.contains("is-checked")!==!1?"Require signed payload from Object":"Does not require signed payload from Object"});var d=document.getElementById("switch-add_require_encrypted").parentNode;d&&d.addEventListener("change",function(t){t.target.parentElement.querySelector("div.mdl-switch__label").innerText=d.classList.contains("is-checked")!==!1?"Require encrypted payload from Object":"Does not require encrypted payload from Object"}),app.setExpandAction()},displayItem:function(t){var e=void 0!==t.attributes.name?t.attributes.name:"",a=(void 0!==t.attributes.description&&t.attributes.description.substring(0,app.cardMaxChars),void 0!==t.attributes.type&&t.attributes.type,"");return a+='<div class="mdl-grid mdl-cell" data-action="view" data-type="flows" data-id="'+t.id+'">',a+='\t<div class="mdl-card mdl-shadow--2dp">',a+='\t\t<div class="mdl-card__title">',a+='\t\t\t<i class="material-icons">'+app.icons.flows+"</i>",a+='\t\t\t<h3 class="mdl-card__title-text">'+e+"</h3>",a+="\t\t</div>",a+="<div class='mdl-list__item--three-line small-padding'>",t.attributes.unit&&(a+="\t<div class='mdl-list__item-sub-title'>",a+="null"!==localStorage.getItem("units")&&JSON.parse(localStorage.getItem("units"))?"\t\t<i class='material-icons md-28'>"+app.icons.units+"</i>"+JSON.parse(localStorage.getItem("units")).find(function(e){return e.name==t.attributes.unit}).value:"\t\t<i class='material-icons md-28'>"+app.icons.units+"</i> ?",a+="\t</div>"),t.attributes.data_type&&(a+="\t<div class='mdl-list__item-sub-title'>",a+="\t\t<i class='material-icons md-28'>"+app.icons.datatypes+"</i>"+JSON.parse(localStorage.getItem("datatypes")).find(function(e){return e.name==t.attributes.data_type}).value,a+="\t</div>"),t.attributes.require_signed===!0&&(a+="\t<div class='mdl-list__item-sub-title'>",a+="\t\t<i class='material-icons md-28'>verified_user</i> Require signed payload from Object",a+="\t</div>"),t.attributes.require_encrypted===!0&&(a+="\t<div class='mdl-list__item-sub-title'>",a+="\t\t<i class='material-icons md-28'>vpn_key</i> Require encrypted payload from Object",a+="\t</div>"),a+="</div>",a+='\t\t<div class="mdl-card__actions mdl-card--border">',a+='\t\t\t<span class="pull-left mdl-card__date">',a+='\t\t\t\t<button data-id="'+t.id+'" class="swapDate mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',a+='\t\t\t\t\t<i class="material-icons">update</i>',a+="\t\t\t\t</button>",a+='\t\t\t\t<span data-date="created" class="visible">Created on '+moment(t.attributes.meta.created).format(app.date_format)+"</span>",a+=t.attributes.meta.updated?'\t\t\t\t<span data-date="updated" class="hidden">Updated on '+moment(t.attributes.meta.updated).format(app.date_format)+"</span>":'\t\t\t\t<span data-date="updated" class="hidden">Never been updated yet.</span>',a+="\t\t\t</span>",a+='\t\t\t<span class="pull-right mdl-card__menuaction">',a+='\t\t\t\t<button id="menu_'+t.id+'" class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',a+='\t\t\t\t\t<i class="material-icons">'+app.icons.menu+"</i>",a+="\t\t\t\t</button>",a+="\t\t\t</span>",a+='\t\t\t<ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="menu_'+t.id+'">',a+='\t\t\t\t<li class="mdl-menu__item delete-button">',a+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons delete-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.delete+"</i>Delete</a>",a+="\t\t\t\t</li>",a+='\t\t\t\t<li class="mdl-menu__item">',a+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons edit-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.edit+"</i>Edit</a>",a+="\t\t\t\t</li>",a+='\t\t\t\t<li class="mdl-menu__item">',a+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons copy-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'">'+app.icons.copy+'</i><textarea class="copytextarea">'+t.id+"</textarea>Copy ID to clipboard</a>",a+="\t\t\t\t</li>",a+="\t\t\t</ul>",a+="\t\t</div>",a+="\t</div>",a+="</div>"}},app.resources.snippets={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode,i={name:a.querySelector("input[name='Name']").value,type:a.querySelector("select[name='Type']").value,icon:a.querySelector("select[name='Icon']").value,color:a.querySelector("input[name='Color']").value,flows:Array.prototype.map.call(a.querySelectorAll(".mdl-chips .mdl-chip"),function(t){return JSON.parse(localStorage.getItem("flows"))[t.getAttribute("data-id")].id}),options:a.querySelector("textarea[name='Graph Options']").value&&"undefined"!==JSON.parse(a.querySelector("textarea[name='Graph Options']").value)?JSON.parse(a.querySelector("textarea[name='Graph Options']").value):void 0,meta:{revision:a.querySelector("input[name='meta.revision']").value}},n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"PUT",headers:n,body:JSON.stringify(i)},s=app.baseUrl+"/"+app.api_version+"/snippets/"+e;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("snippets");var a=JSON.parse(localStorage.getItem("snippets"));app.snippets=[],a.map(function(a){a.id==e?app.snippets.push({id:a.id,name:t.snippet.data.attributes.name,type:t.snippet.data.type,sType:t.snippet.data.attributes.type}):app.snippets.push({id:a.id,name:a.name,type:a.type})}),localStorage.setItem("snippets",JSON.stringify(app.snippets)),toast("Snippet has been saved.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Snippet has not been saved.",{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Snippet id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,type:e.querySelector("select[name='Type']").value,icon:e.querySelector("select[name='Icon']").value,color:e.querySelector("input[name='Color']").value,options:e.querySelector("textarea[name='Graph Options']").value&&"undefined"!==JSON.parse(e.querySelector("textarea[name='Graph Options']").value)?JSON.parse(e.querySelector("textarea[name='Graph Options']").value):void 0,flows:Array.prototype.map.call(e.querySelectorAll(".mdl-chips .mdl-chip"),function(t){return JSON.parse(localStorage.getItem("flows"))[t.getAttribute("data-id")].id})};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onAddSnippet",JSON.stringify(a));var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"POST",headers:i,body:JSON.stringify(a)},o=app.baseUrl+"/"+app.api_version+"/snippets/";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("snippets");var e=new Array;"null"!=JSON.parse(localStorage.getItem("snippets"))&&JSON.parse(localStorage.getItem("snippets")).length>-1&&(e=JSON.parse(localStorage.getItem("snippets"))),e.push({id:t.snippet.data.id,name:t.snippet.data.attributes.name,type:t.snippet.data.type,sType:t.snippet.data.attributes.type}),localStorage.setItem("snippets",JSON.stringify(e)),toast("Snippet has been added.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Snippet has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){var e=JSON.parse(localStorage.getItem("snippets"));app.snippets=[],e.filter(function(e){e.id!=t&&app.snippets.push({id:e.id,name:e.name,type:e.type})}),localStorage.setItem("snippets",JSON.stringify(app.snippets))},display:function(t,e,a,i){history.pushState({section:"snippet"},window.location.hash.substr(1),"#snippet?id="+t),app.initNewSection("snippet"),window.scrollTo(0,0),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"GET",headers:n},s=app.baseUrl+"/"+app.api_version+"/snippets/"+t;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var i=0;i<e.data.length;i++){var n=e.data[i];document.title=app.sectionsPageTitles.snippet.replace(/%s/g,n.attributes.name);var o,s=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];if(a){if(o='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t<div class="mdl-list__item">',o+="\t\t\t<span class='mdl-list__item-primary-content'>",o+='\t\t\t\t<i class="material-icons mdl-textfield__icon">'+app.icons.snippets+"</i>",o+='\t\t\t\t<h2 class="mdl-card__title-text">'+n.attributes.name+"</h2>",o+="\t\t\t</span>",o+="\t\t\t<span class='mdl-list__item-secondary-action'>",o+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+n.id+"'>",o+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t\t\t</button>",o+="\t\t\t</span>",o+="\t\t</div>",o+="\t\t<div class='mdl-cell--12-col hidden' id='description-"+n.id+"'>",o+=app.getField(app.icons.code,"Id",n.id,{type:"text",style:"text-transform: none !important;"}),n.attributes.meta.created&&(o+=app.getField(app.icons.date,"Created",moment(n.attributes.meta.created).format(app.date_format),{type:"text"})),n.attributes.meta.updated&&(o+=app.getField(app.icons.date,"Updated",moment(n.attributes.meta.updated).format(app.date_format),{type:"text"})),n.attributes.meta.revision&&(o+=app.getField(app.icons.update,"Revision",n.attributes.meta.revision,{type:"text"})),o+="\t</div>",o+="</section>",o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField(null,"meta.revision",n.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),o+=app.getField(app.icons.name,"Name",n.attributes.name,{type:"text",id:"Name",isEdit:a,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),o+=app.getField(app.icons.icon,"Icon",n.attributes.icon,{type:"select",id:"Icon",isEdit:a,options:app.types}),o+=app.getField(app.icons.color,"Color",n.attributes.color,{type:"text",style:"text-transform: none !important;",id:"Color",isEdit:a}),o+=app.getField("add_circle_outline","Type",n.attributes.type,{type:"select",id:"Type",options:app.snippetTypes,isEdit:a}),"null"!==localStorage.getItem("flows")){var l=JSON.parse(localStorage.getItem("flows")).map(function(t){return{value:t.name,name:t.id}});o+=app.getField(app.icons.flows,"Flows to add","",{type:"select",id:"flowsChipsSelect",isEdit:!0,options:l})}else app.getFlows(),o+=app.getField(app.icons.flows,"Flows to add (you should add some flows first)","",{type:"select",id:"flowsChipsSelect",isEdit:!0,options:{}});if(o+=app.getField(null,"Sample",null,{type:"container",id:"TypeSample",options:{},isEdit:!1}),o+="\t\t<div class='mdl-list__item--three-line small-padding  mdl-card--expand mdl-chips chips-initial input-field' id='flowsChips'>",o+="\t\t\t<span class='mdl-chips__arrow-down__container mdl-selectfield__arrow-down__container'><span class='mdl-chips__arrow-down'></span></span>",o+="\t\t</div>",o+="\t</div>",o+="</section>",o+=app.getSubtitle("Graph Options"),o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'_parameters">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField(app.icons.description,"Graph Options",void 0!==n.attributes.options?JSON.stringify(n.attributes.options):"",{type:"textarea",id:"Graph_Options",isEdit:!0}),o+="\t</div>",o+="</section>",o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+s[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>View</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>View Snippet</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+s[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",o+="\t\t\t<i class='material-icons'>save</i>",o+="\t\t\t<label>Save</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Save changes to Snippet</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>",app.containers.snippet.querySelector(".page-content").innerHTML=o,componentHandler.upgradeDom(),app.setExpandAction(),app.refreshButtonsSelectors(),app.buttons.backSnippet.addEventListener("click",function(t){app.resources.snippets.display(n.id,!1,!1,!1)},!1),app.buttons.saveSnippet.addEventListener("click",function(t){app.resources.snippets.onEdit(t)},!1),document.getElementById("flowsChipsSelect").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){var e=t.target.getAttribute("data-value"),a=t.target.innerText;app.addChipTo("flowsChips",{name:a,id:e,type:"flows"}),t.preventDefault()},!1),document.getElementById("Type").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){var e=(t.target.getAttribute("data-value"),t.target.innerText),a=app.snippetTypes.find(function(t){return t.value.toLowerCase()===e.toLowerCase()});app.containers.snippet.querySelector("#TypeSample").innerHTML=a.getHtml({id:n.id,icon:n.attributes.icon,name:n.attributes.name,color:n.attributes.color}),a.activateOnce(n),t.preventDefault()},!1),n.attributes.type){var r=app.snippetTypes.find(function(t){return t.name.toLowerCase()===n.attributes.type.toLowerCase()});app.containers.snippet.querySelector("#TypeSample").innerHTML=r.getHtml({id:n.id,icon:n.attributes.icon,name:n.attributes.name,color:n.attributes.color}),r.activateOnce(n)}n.attributes.flows&&n.attributes.flows.length>-1&&"null"!==localStorage.getItem("flows")&&n.attributes.flows.map(function(t){var e=0,a=JSON.parse(localStorage.getItem("flows")).find(function(a){return a.index=e++,a.id==t});a&&app.addChipTo("flowsChips",{name:a.name,id:a.index,type:"flows"})})}else{o='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t<div class="mdl-list__item">',o+="\t\t\t<span class='mdl-list__item-primary-content'>",o+='\t\t\t\t<h2 class="mdl-card__title-text">',o+='\t\t\t\t\t<i class="material-icons">'+app.icons.snippets+"</i>",o+="\t\t\t\t\t"+n.attributes.name+"</h2>",o+="\t\t\t</span>",o+="\t\t\t<span class='mdl-list__item-secondary-action'>",o+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+t+"'>",o+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t\t\t</button>",o+="\t\t\t</span>",o+="\t\t</div>",o+="\t\t<div class='mdl-cell mdl-cell--12-col hidden' id='description-"+t+"'>",o+=app.getField(app.icons.code,"Id",n.id,{type:"text",style:"text-transform: none !important;"}),n.attributes.meta.created&&(o+=app.getField(app.icons.date,"Created",moment(n.attributes.meta.created).format(app.date_format),{type:"text"})),n.attributes.meta.updated&&(o+=app.getField(app.icons.date,"Updated",moment(n.attributes.meta.updated).format(app.date_format),{type:"text"})),n.attributes.meta.revision&&(o+=app.getField(app.icons.update,"Revision",n.attributes.meta.revision,{type:"text"})),o+=app.getField(app.icons.icon,"Icon",n.attributes.icon,{type:"select",id:"Icon",isEdit:a,options:app.types}),o+=app.getField(app.icons.color,"Color",n.attributes.color,{type:"text",style:"text-transform: none !important;",id:"Color",isEdit:a}),o+=app.getField("add_circle_outline","Type",n.attributes.type,{type:"select",id:"Type",options:app.snippetTypes,isEdit:a}),o+=app.getField(app.icons.flows,"Linked Flows #",n.attributes.flows.length,{type:"text"}),o+="\t</div>",o+="</section>",o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+n.id+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+s[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>List</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>List all Snippets</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone delete-button'>",o+="\t\t<button id='"+s[1]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",o+="\t\t\t<i class='material-icons'>delete</i>",o+="\t\t\t<label>Delete</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Delete Snippet</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+s[2]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",o+="\t\t\t<i class='material-icons'>edit</i>",o+="\t\t\t<label>Edit</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[2]+"'>Edit Snippet</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>",app.getSnippet(app.icons.snippets,n.id,app.containers.snippet.querySelector(".page-content")),app.containers.snippet.querySelector(".page-content").innerHTML=o,componentHandler.upgradeDom();var r=app.snippetTypes.find(function(t){return t.name.toLowerCase()===n.attributes.type.toLowerCase()});void 0!==n.attributes.options&&r.setOptions(n.attributes.options);app.setExpandAction(),app.refreshButtonsSelectors(),app.buttons.listSnippet.addEventListener("click",function(t){app.setSection("snippets"),t.preventDefault()},!1),app.buttons.editSnippet2.addEventListener("click",function(t){app.resources.snippets.display(n.id,!1,!0,!1),t.preventDefault()},!1)}app.setSection("snippet")}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("displaySnippet error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},
displayAdd:function(t,e,a,i){history.pushState({section:"snippet_add"},window.location.hash.substr(1),"#snippet_add"),app.initNewSection("snippet_add");var n="";if(n="<section class='mdl-grid mdl-cell--12-col' data-id='"+t.id+"'>",n+="\t<div class='mdl-cell--12-col mdl-card mdl-shadow--2dp'>",n+=app.getField(app.icons.name,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),n+=app.getField(app.icons.icon,"Icon",t.attributes.icon,{type:"select",id:"Icon",isEdit:!0,options:app.types}),n+=app.getField(app.icons.color,"Color",t.attributes.color,{type:"text",id:"Color",isEdit:!0}),n+=app.getField("add_circle_outline","Type",t.attributes.type,{type:"select",id:"Type",options:app.snippetTypes,isEdit:!0}),n+=app.getField(null,"Sample",null,{type:"container",id:"TypeSample",options:{},isEdit:!1}),"null"!=localStorage.getItem("flows")){var o=JSON.parse(localStorage.getItem("flows")).map(function(t){return{value:t.name,name:t.id}});n+=app.getField(app.icons.flows,"Flows to add","",{type:"select",id:"flowsChipsSelect",isEdit:!0,options:o})}else app.getFlows(),n+=app.getField(app.icons.flows,"Flows to add (you should add flow first)","",{type:"select",id:"flowsChipsSelect",isEdit:!0,options:{}});n+="\t\t<div class='mdl-list__item--three-line small-padding  mdl-card--expand mdl-chips chips-initial input-field' id='flowsChips'>",n+="\t\t\t<span class='mdl-chips__arrow-down__container mdl-selectfield__arrow-down__container'><span class='mdl-chips__arrow-down'></span></span>",n+="\t\t</div>",n+="\t</div>",n+="</section>",n+=app.getSubtitle("Graph Options"),n+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'_parameters">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField(app.icons.description,"Graph Options",void 0!==t.attributes.options?JSON.stringify(t.attributes.options):"",{type:"textarea",id:"Graph_Options",isEdit:!0}),n+="\t</div>",n+="</section>";var s=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];n+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(n+="\t<div class='mdl-layout-spacer'></div>"),n+="\t<div class='mdl-cell--1-col-phone pull-left'>",n+="\t\t<button id='"+s[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>chevron_left</i>",n+="\t\t\t<label>List</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>List all Snippets</label>",n+="\t\t</button>",n+="\t</div>",n+="\t<div class='mdl-cell--1-col-phone pull-right'>",n+="\t\t<button id='"+s[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>edit</i>",n+="\t\t\t<label>Save</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Save new Snippet</label>",n+="\t\t</button>",n+="\t</div>",app.isLtr()||(n+="\t<div class='mdl-layout-spacer'></div>"),n+="</section>",app.containers.snippet_add.querySelector(".page-content").innerHTML=n,componentHandler.upgradeDom(),document.getElementById("flowsChipsSelect").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){var e=t.target.getAttribute("data-value"),a=t.target.innerText;app.addChipTo("flowsChips",{name:a,id:e,type:"flows"}),t.preventDefault()},!1),document.getElementById("Type").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(e){var a=(e.target.getAttribute("data-value"),e.target.innerText),i=app.snippetTypes.find(function(t){return t.value===a});app.containers.snippet_add.querySelector("#TypeSample").innerHTML=i.getHtml({id:t.id,icon:t.icon,name:t.name,color:t.color}),i.activateOnce(t),e.preventDefault()},!1),app.refreshButtonsSelectors(),app.buttons.addSnippetBack.addEventListener("click",function(t){app.setSection("snippets"),t.preventDefault()},!1),app.buttons.addSnippet.addEventListener("click",function(t){app.resources.snippets.onAdd(t)},!1),app.setExpandAction()},displayItem:function(t){var e=void 0!==t.attributes.name?t.attributes.name:"",a=(void 0!==t.attributes.description&&t.attributes.description.substring(0,app.cardMaxChars),void 0!==t.attributes.type&&t.attributes.type,"");if(a+='<div class="mdl-grid mdl-cell" data-action="view" data-type="snippets" data-id="'+t.id+'">',a+='\t<div class="mdl-card mdl-shadow--2dp">',a+='\t\t<div class="mdl-card__title">',a+='\t\t\t<i class="material-icons">'+app.icons.objects+"</i>",a+='\t\t\t<h3 class="mdl-card__title-text">'+e+"</h3>",a+="\t\t</div>",a+="<div class='mdl-list__item--three-line small-padding'>",t.attributes.type){a+="\t<div class='mdl-list__item-sub-title'>";app.snippetTypes.find(function(e){return e.name.toLowerCase()===t.attributes.type.toLowerCase()})||console.log("DEBUG","type not found !!!",t.attributes.type.toLowerCase()),a+="\t\t<i class='material-icons md-28'>add_circle_outline</i>"+app.snippetTypes.find(function(e){return e.name.toLowerCase()==t.attributes.type.toLowerCase()}).value,a+="\t</div>"}return t.attributes.color&&(a+="\t<div class='mdl-list__item-sub-title'>",a+="\t\t<i class='material-icons md-28'>format_color_fill</i><span style='text-transform:uppercase; color:"+t.attributes.color+"'>"+t.attributes.color+"</span>",a+="\t</div>"),a+="\t<span class='mdl-list__item-sub-title'>",a+="\t\t<i class='material-icons md-28'>"+t.attributes.icon+"</i>"+app.types.find(function(e){return e.name==t.attributes.icon}).value,a+="\t</span>",a+="</div>",a+='\t\t<div class="mdl-card__actions mdl-card--border">',a+='\t\t\t<span class="pull-left mdl-card__date">',a+='\t\t\t\t<button data-id="'+t.id+'" class="swapDate mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',a+='\t\t\t\t\t<i class="material-icons">update</i>',a+="\t\t\t\t</button>",a+='\t\t\t\t<span data-date="created" class="visible">Created on '+moment(t.attributes.meta.created).format(app.date_format)+"</span>",a+=t.attributes.meta.updated?'\t\t\t\t<span data-date="updated" class="hidden">Updated on '+moment(t.attributes.meta.updated).format(app.date_format)+"</span>":'\t\t\t\t<span data-date="updated" class="hidden">Never been updated yet.</span>',a+="\t\t\t</span>",a+='\t\t\t<span class="pull-right mdl-card__menuaction">',a+='\t\t\t\t<button id="menu_'+t.id+'" class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',a+='\t\t\t\t\t<i class="material-icons">'+app.icons.menu+"</i>",a+="\t\t\t\t</button>",a+="\t\t\t</span>",a+='\t\t\t<ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="menu_'+t.id+'">',a+='\t\t\t\t<li class="mdl-menu__item delete-button">',a+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons delete-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.delete+"</i>Delete</a>",a+="\t\t\t\t</li>",a+='\t\t\t\t<li class="mdl-menu__item">',a+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons edit-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.edit+"</i>Edit</a>",a+="\t\t\t\t</li>",a+='\t\t\t\t<li class="mdl-menu__item">',a+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons copy-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'">'+app.icons.copy+'</i><textarea class="copytextarea">'+t.id+"</textarea>Copy ID to clipboard</a>",a+="\t\t\t\t</li>",a+="\t\t\t</ul>",a+="\t\t</div>",a+="\t</div>",a+="</div>"}},app.resources.dashboards={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode,i={name:a.querySelector("input[name='Name']").value,description:a.querySelector("textarea[name='Description']").value,snippets:Array.prototype.map.call(a.querySelectorAll(".mdl-chips .mdl-chip"),function(t){return JSON.parse(localStorage.getItem("snippets"))[t.getAttribute("data-id")].id}),meta:{revision:a.querySelector("input[name='meta.revision']").value}};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onEditDashboard",JSON.stringify(i));var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"PUT",headers:n,body:JSON.stringify(i)},s=app.baseUrl+"/"+app.api_version+"/dashboards/"+e;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("dashboards"),toast("Dashboard has been saved.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Dashboard has not been saved.",{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Dashboard id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,description:e.querySelector("textarea[name='Description']").value,snippets:Array.prototype.map.call(e.querySelectorAll(".mdl-chips .mdl-chip"),function(t){return JSON.parse(localStorage.getItem("snippets"))[t.getAttribute("data-id")].id})};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onAddDashboard",JSON.stringify(a));var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"POST",headers:i,body:JSON.stringify(a)},o=app.baseUrl+"/"+app.api_version+"/dashboards/";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("dashboards"),toast("Dashboard has been added.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Dashboard has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){},display:function(t,e,a,i){history.pushState({section:"dashboard"},window.location.hash.substr(1),"#dashboard?id="+t),app.initNewSection("dashboard"),window.scrollTo(0,0),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"GET",headers:n},s=app.baseUrl+"/"+app.api_version+"/dashboards/"+t;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var i=0;i<e.data.length;i++){var n=e.data[i];document.title=app.sectionsPageTitles.dashboard.replace(/%s/g,n.attributes.name);var o;if(o='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t<div class="mdl-list__item">',o+="\t\t\t<span class='mdl-list__item-primary-content'>",o+='\t\t\t\t<i class="material-icons mdl-textfield__icon">'+app.icons.dashboards+"</i>",o+='\t\t\t\t<h2 class="mdl-card__title-text">'+n.attributes.name+"</h2>",o+="\t\t\t</span>",o+="\t\t\t<span class='mdl-list__item-secondary-action'>",o+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+t+"'>",o+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t\t\t</button>",o+="\t\t\t</span>",o+="\t\t</div>",o+="\t\t<div class='mdl-cell mdl-cell--12-col hidden' id='description-"+t+"'>",o+=app.getField(app.icons.code,"Id",n.id,{type:"text",style:"text-transform: none !important;"}),n.attributes.description){var s=app.nl2br(n.attributes.description);o+=app.getField(app.icons.description,"Description",s,{type:"text",isEdit:!1})}n.attributes.meta.created&&(o+=app.getField(app.icons.date,"Created",moment(n.attributes.meta.created).format(app.date_format),{type:"text",isEdit:!1})),n.attributes.meta.updated&&(o+=app.getField(app.icons.date,"Updated",moment(n.attributes.meta.updated).format(app.date_format),{type:"text",isEdit:!1})),n.attributes.meta.revision&&(o+=app.getField(app.icons.update,"Revision",n.attributes.meta.revision,{type:"text",isEdit:!1})),o+="\t\t</div>",o+="\t</div>",o+="</section>";var l=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];if(a){if(o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField(null,"meta.revision",n.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),o+=app.getField(app.icons.name,"Name",n.attributes.name,{type:"text",id:"Name",isEdit:a,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),o+=app.getField(app.icons.description,"Description",app.nl2br(n.attributes.description),{type:"textarea",id:"Description",isEdit:a}),"null"!=localStorage.getItem("snippets")){var r=JSON.parse(localStorage.getItem("snippets")).map(function(t){return{value:t.name,name:t.id,sType:t.sType}});o+=app.getField(app.icons.snippets,"Snippets to add","",{type:"select",id:"snippetsChipsSelect",isEdit:!0,options:r})}else app.getSnippets(),o+=app.getField(app.icons.snippets,"Snippets to add (you should add some snippets first)","",{type:"select",id:"snippetsChipsSelect",isEdit:!0,options:{}});o+="\t\t<div class='mdl-list__item--three-line small-padding  mdl-card--expand mdl-chips chips-initial input-field' id='snippetsChips'>",o+="\t\t\t<span class='mdl-chips__arrow-down__container mdl-selectfield__arrow-down__container'><span class='mdl-chips__arrow-down'></span></span>",o+="\t\t</div>",o+="\t</div>",o+="</section>",o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+l[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>View</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[0]+"'>View Dashboard</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+l[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",o+="\t\t\t<i class='material-icons'>save</i>",o+="\t\t\t<label>Save</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+l[1]+"'>Save changes to Dashboard</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>"}else for(var d=0;d<n.attributes.snippets.length;d++)app.getSnippet(app.icons.snippets,n.attributes.snippets[d],app.containers.dashboard.querySelector(".page-content"));app.containers.dashboard.querySelector(".page-content").innerHTML=o,app.setExpandAction(),componentHandler.upgradeDom(),app.refreshButtonsSelectors(),a&&(app.buttons.backDashboard.addEventListener("click",function(t){app.resources.dashboards.display(n.id,!1,!1,!1)},!1),app.buttons.saveDashboard.addEventListener("click",function(t){app.resources.dashboards.onEdit(t)},!1),document.getElementById("snippetsChipsSelect").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){var e=t.target.getAttribute("data-value"),a=0;if("null"!=localStorage.getItem("snippets"))var i=JSON.parse(localStorage.getItem("snippets")).find(function(t){if(a==e)return t;a++});i.sType,t.target.innerText;app.addChipSnippetTo("snippetsChips",{name:i.name,id:e,sType:i.sType,type:"snippets"}),t.preventDefault()},!1),n.attributes.snippets&&n.attributes.snippets.length>-1&&n.attributes.snippets.map(function(t){var e=0;if("null"!=localStorage.getItem("snippets")){var a=JSON.parse(localStorage.getItem("snippets")).find(function(a){return a.index=e++,a.id==t});a&&app.addChipSnippetTo("snippetsChips",{name:a.name,id:a.index,sType:a.sType,type:"snippets"})}})),componentHandler.upgradeDom(),app.setExpandAction();var p=document.querySelectorAll("#snippetsChips .mdl-chip");[].forEach.call(p,app.addDnDHandlers),app.setSection("dashboard")}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayDashboard error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){history.pushState({section:"dashboard_add"},window.location.hash.substr(1),"#dashboard_add"),app.initNewSection("dashboard_add");var n="";n='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField(app.icons.name,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),n+=app.getField(app.icons.description,"Description",app.nl2br(t.attributes.description),{type:"textarea",id:"Description",isEdit:!0});var o;"null"!=localStorage.getItem("snippets")?o=JSON.parse(localStorage.getItem("snippets")).map(function(t){return{value:t.name,name:t.id,sType:t.sType}}):(app.getSnippets(),toast('You should add a Snippet first, it seems you don" have any yet.',{timeout:3e3,type:"warning"}),o=[{value:"undefined",name:"undefined",sType:"undefined"}]),n+=app.getField(app.icons.snippets,"Snippets to add","",{type:"select",id:"snippetsChipsSelect",isEdit:!0,options:o}),n+="\t\t<div class='mdl-list__item--three-line small-padding  mdl-card--expand mdl-chips chips-initial input-field' id='snippetsChips'>",n+="\t\t\t<span class='mdl-chips__arrow-down__container mdl-selectfield__arrow-down__container'><span class='mdl-chips__arrow-down'></span></span>",n+="\t\t</div>",n+="\t</div>",n+="</section>";var s=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];n+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(n+="\t<div class='mdl-layout-spacer'></div>"),n+="\t<div class='mdl-cell--1-col-phone pull-left'>",n+="\t\t<button id='"+s[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>chevron_left</i>",n+="\t\t\t<label>List</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>List all Dashboards</label>",n+="\t\t</button>",n+="\t</div>",n+="\t<div class='mdl-cell--1-col-phone pull-right'>",n+="\t\t<button id='"+s[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>edit</i>",n+="\t\t\t<label>Save</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Save new Dashboard</label>",n+="\t\t</button>",n+="\t</div>",app.isLtr()||(n+="\t<div class='mdl-layout-spacer'></div>"),n+="</section>",app.containers.dashboard_add.querySelector(".page-content").innerHTML=n,componentHandler.upgradeDom(),document.getElementById("snippetsChipsSelect").parentNode.querySelector("div.mdl-selectfield__list-option-box ul").addEventListener("click",function(t){var e=t.target.getAttribute("data-value"),a=0,i=JSON.parse(localStorage.getItem("snippets")).find(function(t){if(a==e)return t;a++}),n=i.sType,o=t.target.innerText;app.addChipSnippetTo("snippetsChips",{name:o,id:e,sType:n,type:"snippets"}),t.preventDefault()},!1),app.refreshButtonsSelectors(),app.buttons.addDashboardBack.addEventListener("click",function(t){app.setSection("dashboards"),t.preventDefault()},!1),app.buttons.addDashboard.addEventListener("click",function(t){app.resources.dashboards.onAdd(t)},!1),app.setExpandAction()},displayItem:function(t){var e=void 0!==t.attributes.name?t.attributes.name:"",a=void 0!==t.attributes.description?t.attributes.description.substring(0,app.cardMaxChars):"",i=(void 0!==t.attributes.type&&t.attributes.type,"");return i+='<div class="mdl-grid mdl-cell" data-action="view" data-type="dashboards" data-id="'+t.id+'">',i+='\t<div class="mdl-card mdl-shadow--2dp">',i+='\t\t<div class="mdl-card__title">',i+='\t\t\t<i class="material-icons">'+app.icons.objects+"</i>",i+='\t\t\t<h3 class="mdl-card__title-text">'+e+"</h3>",i+="\t\t</div>",i+=app.getField(null,null,a,{type:"textarea",isEdit:!1}),i+='\t\t<div class="mdl-card__actions mdl-card--border">',i+='\t\t\t<span class="pull-left mdl-card__date">',i+='\t\t\t\t<button data-id="'+t.id+'" class="swapDate mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',i+='\t\t\t\t\t<i class="material-icons">update</i>',i+="\t\t\t\t</button>",i+='\t\t\t\t<span data-date="created" class="visible">Created on '+moment(t.attributes.meta.created).format(app.date_format)+"</span>",i+=t.attributes.meta.updated?'\t\t\t\t<span data-date="updated" class="hidden">Updated on '+moment(t.attributes.meta.updated).format(app.date_format)+"</span>":'\t\t\t\t<span data-date="updated" class="hidden">Never been updated yet.</span>',i+="\t\t\t</span>",i+='\t\t\t<span class="pull-right mdl-card__menuaction">',i+='\t\t\t\t<button id="menu_'+t.id+'" class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',i+='\t\t\t\t\t<i class="material-icons">'+app.icons.menu+"</i>",i+="\t\t\t\t</button>",i+="\t\t\t</span>",i+='\t\t\t<ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="menu_'+t.id+'">',i+='\t\t\t\t<li class="mdl-menu__item delete-button">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons delete-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.delete+"</i>Delete</a>",i+="\t\t\t\t</li>",i+='\t\t\t\t<li class="mdl-menu__item">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons edit-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.edit+"</i>Edit</a>",i+="\t\t\t\t</li>",i+='\t\t\t\t<li class="mdl-menu__item">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons copy-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'">'+app.icons.copy+'</i><textarea class="copytextarea">'+t.id+"</textarea>Copy ID to clipboard</a>",i+="\t\t\t\t</li>",i+="\t\t\t</ul>",i+="\t\t</div>",i+="\t</div>",i+="</div>"}},app.resources.rules={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode,i={name:a.querySelector("input[name='Name']").value,active:!!a.querySelector("input[id='switch-active']").parentNode.classList.contains("is-checked"),rule:{priority:a.querySelector("input[name='Priority']").value,conditions:JSON.parse(a.querySelector("textarea[name='Event Conditions']").value),event:{type:a.querySelector("select[name='Event Type']").value,params:JSON.parse(a.querySelector("textarea[name='Event Parameters']").value)}},meta:{revision:a.querySelector("input[name='meta.revision']").value}};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onEditRule",JSON.stringify(i));var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"PUT",headers:n,body:JSON.stringify(i)},s=app.baseUrl+"/"+app.api_version+"/rules/"+e;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("rules"),toast("Rule has been edited.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Rule has not been edited.",{timeout:3e3,type:"error"})}),t.preventDefault()}else toast("No Rule id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,active:!!e.querySelector("input[id='switch-active']").parentNode.classList.contains("is-checked"),rule:{priority:e.querySelector("input[name='Priority']").value,conditions:JSON.parse(e.querySelector("textarea[name='Event Conditions']").value),event:{type:e.querySelector("select[name='Event Type']").value,params:JSON.parse(e.querySelector("textarea[name='Event Parameters']").value)}}};"true"==localStorage.getItem("settings.debug")&&console.log("DEBUG onAddRule",JSON.stringify(a));var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"POST",headers:i,body:JSON.stringify(a)},o=app.baseUrl+"/"+app.api_version+"/rules/";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("rules"),toast("Rule has been added.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Rule has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault()},onDelete:function(t){},display:function(t,e,a,i){history.pushState({section:"rule"},window.location.hash.substr(1),"#rule?id="+t),app.initNewSection("rule"),window.scrollTo(0,0),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"GET",headers:n},s=app.baseUrl+"/"+app.api_version+"/rules/"+t;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var i=0;i<e.data.length;i++){var n=e.data[i];document.title=app.sectionsPageTitles.rule.replace(/%s/g,n.attributes.name);var o,s=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];a?(o='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t<div class="mdl-list__item">',o+="\t\t\t<span class='mdl-list__item-primary-content'>",o+='\t\t\t\t<i class="material-icons mdl-textfield__icon">'+app.icons.rules+"</i>",o+='\t\t\t\t<h2 class="mdl-card__title-text">'+n.attributes.name+"</h2>",o+="\t\t\t</span>",o+="\t\t\t<s&pan class='mdl-list__item-secondary-action'>",o+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+n.id+"'>",o+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t\t\t</button>",o+="\t\t\t</span>",o+="\t\t</div>",o+="\t\t<div class='mdl-cell--12-col hidden' id='description-"+n.id+"'>",o+=app.getField(app.icons.code,"Id",n.id,{type:"text",style:"text-transform: none !important;"}),n.attributes.meta.created&&(o+=app.getField(app.icons.date,"Created",moment(n.attributes.meta.created).format(app.date_format),{type:"text"})),n.attributes.meta.updated&&(o+=app.getField(app.icons.date,"Updated",moment(n.attributes.meta.updated).format(app.date_format),{type:"text"})),n.attributes.meta.revision&&(o+=app.getField(app.icons.update,"Revision",n.attributes.meta.revision,{type:"text"})),o+="\t</div>",o+="</section>",o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField(null,"meta.revision",n.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),o+=app.getField(app.icons.name,"Name",n.attributes.name,{type:"text",id:"Name",isEdit:a,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),o+=app.getField("add_circle_outline","Event Type",n.attributes.rule.event.type,{type:"select",id:"EventType",options:app.EventTypes,isEdit:a}),o+=app.getField("swap_vert","Priority",n.attributes.rule.priority,{type:"text",id:"Priority",isEdit:a,pattern:app.patterns.integerNotNegative,error:"Should be a positive integer."}),o+=app.getField("traffic",n.attributes.active!==!1?"Rule is active":"Rule is disabled",n.attributes.active!==!1,{type:"switch",id:"active",isEdit:a}),o+="\t</div>",o+="</section>",o+=app.getSubtitle("Event Conditions"),o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'_parameters">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField(app.icons.description,"Event Conditions",JSON.stringify(n.attributes.rule.conditions),{type:"textarea",id:"EventConditions",isEdit:!0}),o+="\t</div>",o+="</section>",o+=app.getSubtitle("Event Parameters"),o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'_parameters">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField(app.icons.description,"Event Parameters",JSON.stringify(n.attributes.rule.event.params),{type:"textarea",id:"EventParams",isEdit:!0}),o+="\t</div>",o+="</section>",o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+s[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>View</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>View Rule</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+s[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t+"'>",o+="\t\t\t<i class='material-icons'>save</i>",o+="\t\t\t<label>Save</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Save changes to Rule</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>",app.containers.rule.querySelector(".page-content").innerHTML=o,componentHandler.upgradeDom(),app.setExpandAction(),app.refreshButtonsSelectors(),document.getElementById("switch-active")&&document.getElementById("switch-active").addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");document.getElementById("switch-active").checked===!0?e.innerText="Rule is active":e.innerText="Rule is disabled"}),app.buttons.backRule.addEventListener("click",function(t){app.resources.rules.display(n.id,!1,!1,!1)},!1),app.buttons.saveRule.addEventListener("click",function(t){app.resources.rules.onEdit(t)},!1)):(o='<section class="mdl-grid mdl-cell--12-col" data-id="'+t+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t<div class="mdl-list__item">',o+="\t\t\t<span class='mdl-list__item-primary-content'>",o+='\t\t\t\t<h2 class="mdl-card__title-text">',o+='\t\t\t\t\t<i class="material-icons">'+app.icons.rules+"</i>",o+="\t\t\t\t\t"+n.attributes.name+"</h2>",o+="\t\t\t</span>",o+="\t\t\t<span class='mdl-list__item-secondary-action'>",o+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+t+"'>",o+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t\t\t</button>",o+="\t\t\t</span>",o+="\t\t</div>",o+="\t\t<div class='mdl-cell mdl-cell--12-col hidden' id='description-"+t+"'>",o+=app.getField(app.icons.rules,"Id",n.id,{type:"text"}),n.attributes.meta.created&&(o+=app.getField(app.icons.date,"Created",moment(n.attributes.meta.created).format(app.date_format),{type:"text"})),n.attributes.meta.updated&&(o+=app.getField(app.icons.date,"Updated",moment(n.attributes.meta.updated).format(app.date_format),{type:"text"})),n.attributes.meta.revision&&(o+=app.getField(app.icons.update,"Revision",n.attributes.meta.revision,{type:"text"})),o+="\t</div>",o+="</section>",o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField("add_circle_outline","Event Type",n.attributes.rule.event.type,{type:"select",id:"EventType",options:app.EventTypes,isEdit:a}),o+=app.getField("swap_vert","Priority",n.attributes.rule.priority,{type:"text",id:"Priority",isEdit:a,pattern:app.patterns.integerNotNegative,error:"Should be a positive integer."}),o+=app.getField("traffic",n.attributes.active!==!1?"Rule is active":"Rule is disabled","",{
type:"switch",id:"active",isEdit:a}),o+="\t</div>",o+="</section>",o+=app.getSubtitle("Event Conditions"),o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'_parameters">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+="\t\t<pre>",o+="\t\t\t<code class='nostyle'>",o+=app.getField(app.icons.description,"Event Conditions",app.nl2br(JSON.stringify(n.attributes.rule.conditions,null,"\t")),{type:"textarea",id:"EventConditions",isEdit:a}),o+="\t\t\t</code>",o+="\t\t</pre>",o+="\t</div>",o+="</section>",o+=app.getSubtitle("Event Parameters"),o+='<section class="mdl-grid mdl-cell--12-col" data-id="'+n.id+'_parameters">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+="\t\t<pre>",o+="\t\t\t<code class='nostyle'>",o+=app.getField(app.icons.description,"Event Parameters",app.nl2br(JSON.stringify(n.attributes.rule.event.params,null,"\t")),{type:"textarea",id:"EventParams",isEdit:a}),o+="\t\t\t</code>",o+="\t\t</pre>",o+="\t</div>",o+="</section>",o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+n.id+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+s[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>List</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>List all Rules</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone delete-button'>",o+="\t\t<button id='"+s[1]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",o+="\t\t\t<i class='material-icons'>delete</i>",o+="\t\t\t<label>Delete</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Delete Rule</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+s[2]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+n.id+"'>",o+="\t\t\t<i class='material-icons'>edit</i>",o+="\t\t\t<label>Edit</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[2]+"'>Edit Rule</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>",app.containers.rule.querySelector(".page-content").innerHTML=o,componentHandler.upgradeDom(),app.setExpandAction(),app.refreshButtonsSelectors(),app.buttons.listRule.addEventListener("click",function(t){app.setSection("rules"),t.preventDefault()},!1),app.buttons.editRule2.addEventListener("click",function(t){app.resources.rules.display(n.id,!1,!0,!1),t.preventDefault()},!1)),app.setSection("rule")}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("displayRule error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){history.pushState({section:"rule_add"},window.location.hash.substr(1),"#rule_add"),app.initNewSection("ruled_add");var n="";n='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField(app.icons.name,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),n+=app.getField("add_circle_outline","Event Type",t.attributes.event.type,{type:"select",id:"EventType",options:app.EventTypes,isEdit:!0}),n+=app.getField("swap_vert","Priority",t.attributes.priority,{type:"text",id:"Priority",isEdit:!0,pattern:app.patterns.integerNotNegative,error:"Should be a positive integer."}),n+=app.getField("traffic","false"!=t.attributes.active?"Rule is active":"Rule is disabled",void 0===t.attributes.active||t.attributes.active,{type:"switch",id:"active",isEdit:!0}),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Event Conditions"),n+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'_parameters">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField(app.icons.description,"Event Conditions",app.nl2br(t.attributes.event.conditions),{type:"textarea",id:"EventConditions",isEdit:!0}),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Event Parameters"),n+='<section class="mdl-grid mdl-cell--12-col" data-id="'+t.id+'_parameters">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField("note",["Name","Value"],["",""],{type:"2inputs",pattern:[app.patterns.customAttributeName,app.patterns.customAttributeValue],error:["Name should not contains any space nor special char.","Value is free."],id:["Name[]","Value[]"],isEdit:!0}),n+=app.getField(app.icons.description,"Event Parameters",app.nl2br(t.attributes.event.parameters),{type:"textarea",id:"EventParams",isEdit:!0}),n+="\t</div>",n+="</section>";var o=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];n+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(n+="\t<div class='mdl-layout-spacer'></div>"),n+="\t<div class='mdl-cell--1-col-phone pull-left'>",n+="\t\t<button id='"+o[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>chevron_left</i>",n+="\t\t\t<label>List</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+o[0]+"'>List all Rules</label>",n+="\t\t</button>",n+="\t</div>",n+="\t<div class='mdl-cell--1-col-phone pull-right'>",n+="\t\t<button id='"+o[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>edit</i>",n+="\t\t\t<label>Save</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+o[1]+"'>Save new Rule</label>",n+="\t\t</button>",n+="\t</div>",app.isLtr()||(n+="\t<div class='mdl-layout-spacer'></div>"),n+="</section>",app.containers.rule_add.querySelector(".page-content").innerHTML=n,componentHandler.upgradeDom(),app.refreshButtonsSelectors(),document.getElementById("switch-active")&&document.getElementById("switch-active").addEventListener("change",function(t){var e=t.target.parentElement.querySelector("div.mdl-switch__label");document.getElementById("switch-active").checked===!0?e.innerText="Rule is active":e.innerText="Rule is disabled"}),app.buttons.addRuleBack.addEventListener("click",function(t){app.setSection("rules"),t.preventDefault()},!1),app.buttons.addRule.addEventListener("click",function(t){app.resources.rules.onAdd(t)},!1),app.setExpandAction()},displayItem:function(t){var e=void 0!==t.attributes.name?t.attributes.name:"",a=void 0!==t.attributes.description?t.attributes.description.substring(0,app.cardMaxChars):"",i=(void 0!==t.attributes.type&&t.attributes.type,t.attributes.active!==!0?"is-disabled":""),n="";return n+='<div class="mdl-grid mdl-cell" data-action="view" data-type="rules" data-id="'+t.id+'">',n+='\t<div class="mdl-card mdl-shadow--2dp '+i+'">',n+='\t\t<div class="mdl-card__title">',n+='\t\t\t<i class="material-icons">'+app.icons.objects+"</i>",n+='\t\t\t<h3 class="mdl-card__title-text">'+e+"</h3>",n+="\t\t</div>",n+=app.getField(null,null,a,{type:"textarea",isEdit:!1}),n+='\t\t<div class="mdl-card__actions mdl-card--border">',n+='\t\t\t<span class="pull-left mdl-card__date">',n+='\t\t\t\t<button data-id="'+t.id+'" class="swapDate mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',n+='\t\t\t\t\t<i class="material-icons">update</i>',n+="\t\t\t\t</button>",n+='\t\t\t\t<span data-date="created" class="visible">Created on '+moment(t.attributes.meta.created).format(app.date_format)+"</span>",n+=t.attributes.meta.updated?'\t\t\t\t<span data-date="updated" class="hidden">Updated on '+moment(t.attributes.meta.updated).format(app.date_format)+"</span>":'\t\t\t\t<span data-date="updated" class="hidden">Never been updated yet.</span>',n+="\t\t\t</span>",n+='\t\t\t<span class="pull-right mdl-card__menuaction">',n+='\t\t\t\t<button id="menu_'+t.id+'" class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',n+='\t\t\t\t\t<i class="material-icons">'+app.icons.menu+"</i>",n+="\t\t\t\t</button>",n+="\t\t\t</span>",n+='\t\t\t<ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="menu_'+t.id+'">',n+='\t\t\t\t<li class="mdl-menu__item delete-button">',n+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons delete-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.delete+"</i>Delete</a>",n+="\t\t\t\t</li>",n+='\t\t\t\t<li class="mdl-menu__item">',n+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons edit-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.edit+"</i>Edit</a>",n+="\t\t\t\t</li>",n+='\t\t\t\t<li class="mdl-menu__item">',n+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons copy-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'">'+app.icons.copy+'</i><textarea class="copytextarea">'+t.id+"</textarea>Copy ID to clipboard</a>",n+="\t\t\t\t</li>",n+="\t\t\t</ul>",n+="\t\t</div>",n+="\t</div>",n+="</div>"}},app.resources.mqtts={onEdit:function(t){},onAdd:function(t){},onDelete:function(t){},display:function(t,e,a,i){},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){},displayItem:function(t){var e=void 0!==t.attributes.name?t.attributes.name:"",a=void 0!==t.attributes.description?t.attributes.description.substring(0,app.cardMaxChars):"",i=(void 0!==t.attributes.type&&t.attributes.type,"");return i+='<div class="mdl-grid mdl-cell" data-action="view" data-type="mqtts" data-id="'+t.id+'">',i+='\t<div class="mdl-card mdl-shadow--2dp">',i+='\t\t<div class="mdl-card__title">',i+='\t\t\t<i class="material-icons mdl-textfield__icon">'+app.icons.objects+"</i>",i+='\t\t\t<h3 class="mdl-card__title-text">'+e+"</h3>",i+="\t\t</div>",i+=app.getField(null,null,a,{type:"textarea",isEdit:!1}),i+='\t\t<div class="mdl-card__actions mdl-card--border">',i+='\t\t\t<span class="pull-left mdl-card__date">',i+='\t\t\t\t<button data-id="'+t.id+'" class="swapDate mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',i+='\t\t\t\t\t<i class="material-icons">update</i>',i+="\t\t\t\t</button>",i+='\t\t\t\t<span data-date="created" class="visible">Created on '+moment(t.attributes.meta.created).format(app.date_format)+"</span>",i+=t.attributes.meta.updated?'\t\t\t\t<span data-date="updated" class="hidden">Updated on '+moment(t.attributes.meta.updated).format(app.date_format)+"</span>":'\t\t\t\t<span data-date="updated" class="hidden">Never been updated yet.</span>',i+="\t\t\t</span>",i+='\t\t\t<span class="pull-right mdl-card__menuaction">',i+='\t\t\t\t<button id="menu_'+t.id+'" class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',i+='\t\t\t\t\t<i class="material-icons">'+app.icons.menu+"</i>",i+="\t\t\t\t</button>",i+="\t\t\t</span>",i+='\t\t\t<ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="menu_'+t.id+'">',i+='\t\t\t\t<li class="mdl-menu__item delete-button">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons delete-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.delete+"</i>Delete</a>",i+="\t\t\t\t</li>",i+='\t\t\t\t<li class="mdl-menu__item">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons edit-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.edit+"</i>Edit</a>",i+="\t\t\t\t</li>",i+='\t\t\t\t<li class="mdl-menu__item">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons copy-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'">'+app.icons.copy+'</i><textarea class="copytextarea">'+t.id+"</textarea>Copy ID to clipboard</a>",i+="\t\t\t\t</li>",i+="\t\t\t</ul>",i+="\t\t</div>",i+="\t</div>",i+="</div>"}},app.resources.sources={onEdit:function(t){var e=t.target.parentNode.getAttribute("data-id")?t.target.parentNode.getAttribute("data-id"):t.target.getAttribute("data-id");if(e){var a=t.target.parentNode.parentNode.parentNode.parentNode,i={name:a.querySelector("input[name='Name']").value,content:a.querySelector("textarea[id='Code']").value,password:null!==a.querySelector("input[id='password']")?a.querySelector("input[id='password']").value:""},n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"PUT",headers:n,body:JSON.stringify(i)},s=app.baseUrl+"/"+app.api_version+"/sources/"+e;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("sources"),toast("Source has been saved.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Source has not been saved.",{timeout:3e3,type:"error"})}),t.preventDefault(),app.getSources()}else toast("No Source id found!",{timeout:3e3,type:"error"})},onAdd:function(t){var e=t.target.parentNode.parentNode.parentNode.parentNode,a={name:e.querySelector("input[name='Name']").value,content:e.querySelector("textarea[id='Code']").value,password:null!==e.querySelector("input[id='password']")?e.querySelector("input[id='password']").value:""},i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"POST",headers:i,body:JSON.stringify(a)},o=app.baseUrl+"/"+app.api_version+"/sources/";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){app.setSection("sources"),toast("Source has been added.",{timeout:3e3,type:"done"})}).catch(function(t){toast("Source has not been added.",{timeout:3e3,type:"error"})}),t.preventDefault(),app.getSources()},onDelete:function(t){app.getSources()},onBuild:function(t,e){var a=new Headers;a.append("Authorization","Bearer "+localStorage.getItem("bearer")),a.append("Content-Type","application/json");var i={method:"GET",headers:a},n=app.baseUrl+"/"+app.api_version+"/ota/"+t;fetch(n,i).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var a=0;a<t.data.length;a++){let s=t.data[a].id;if(null===e||e===s){var i=new Headers;i.append("Authorization","Bearer "+localStorage.getItem("bearer")),i.append("Content-Type","application/json");var n={method:"POST",headers:i},o=app.baseUrl+"/"+app.api_version+"/objects/"+s+"/build";fetch(o,n).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){})}}var s=null===e?t.data.length:1;toast("Source is building all "+s+" Object(s). This can take several minutes.",{timeout:1e4,type:"info"})})},onUnlinkObject:function(t,e){var a=new Headers;a.append("Authorization","Bearer "+localStorage.getItem("bearer")),a.append("Content-Type","application/json");var i={method:"POST",headers:a},n=app.baseUrl+"/"+app.api_version+"/objects/"+e+"/unlink/"+t;fetch(n,i).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){document.getElementById("object_"+e).classList.add("removed"),toast("Object is unlinked from this source.",{timeout:3e3,type:"info"})})},onDeploy:function(t,e){var a=new Headers;a.append("Authorization","Bearer "+localStorage.getItem("bearer")),a.append("Content-Type","application/json");var i={method:"POST",headers:a},n=null!==e?"/"+e:"",o=app.baseUrl+"/"+app.api_version+"/ota/"+t+"/deploy"+n;fetch(o,i).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){toast("Source is deploying to all "+t.deploying_to_objects.data.length+" available Object(s). This can take several minutes.",{timeout:1e4,type:"info"})})},display:function(t,e,a,i){window.scrollTo(0,0),t instanceof Object&&e?displayAdd(t,e,a,i):history.pushState({section:"source"},window.location.hash.substr(1),"#source?id="+t),app.initNewSection("source"),app.containers.spinner.removeAttribute("hidden"),app.containers.spinner.classList.remove("hidden");var n=new Headers;n.append("Authorization","Bearer "+localStorage.getItem("bearer")),n.append("Content-Type","application/json");var o={method:"GET",headers:n},s=app.baseUrl+"/"+app.api_version+"/sources/"+t;fetch(s,o).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){for(var e=0;e<t.data.length;e++){var i=t.data[e],n=void 0!==i.attributes.content?i.attributes.content:"";n=a?n:app.nl2br(app.escapeHtml(n)),document.title=app.sectionsPageTitles.source.replace(/%s/g,i.attributes.name);var o="";o='<section class="mdl-grid mdl-cell--12-col" data-id="'+i.id+'">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t<div class="mdl-list__item">',o+="\t\t\t<span class='mdl-list__item-primary-content'>",o+='\t\t\t\t<i class="material-icons mdl-textfield__icon">'+app.icons.sources+"</i>",o+='\t\t\t\t<h2 class="mdl-card__title-text">'+i.attributes.name+"</h2>",o+="\t\t\t</span>",o+="\t\t\t<span class='mdl-list__item-secondary-action'>",o+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showdescription_button' for='description-"+i.id+"'>",o+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t\t\t</button>",o+="\t\t\t</span>",o+="\t\t</div>",o+="\t\t<div class='mdl-cell--12-col hidden' id='description-"+i.id+"'>",o+=app.getField(app.icons.code,"Id",i.id,{type:"text",style:"text-transform: none !important;"}),i.attributes.meta.created&&(o+=app.getField(app.icons.date,"Created",moment(i.attributes.meta.created).format(app.date_format),{type:"text"})),i.attributes.meta.updated&&(o+=app.getField(app.icons.date,"Updated",moment(i.attributes.meta.updated).format(app.date_format),{type:"text"})),i.attributes.meta.revision&&(o+=app.getField(app.icons.update,"Revision",i.attributes.meta.revision,{type:"text"})),o+="\t\t</div>",o+="\t</div>",o+="</section>",o+=app.getSubtitle("Security"),o+='<section class="mdl-grid mdl-cell--12-col">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField("verified_user","OTA Password",void 0!==i.attributes.password?i.attributes.password:"",{type:"text",style:"text-transform: none !important;",id:"password",isEdit:a,pattern:app.patterns.password,error:""}),o+="\t</div>",o+="</section>",o+=app.getSubtitle("Parameters"),o+='<section class="mdl-grid mdl-cell--12-col">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+=app.getField(null,"meta.revision",i.attributes.meta.revision,{type:"hidden",id:"meta.revision",pattern:app.patterns.meta_revision}),o+=app.getField(app.icons.name,"Name",i.attributes.name,{type:"text",id:"Name",isEdit:a,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),o+="\t\t</div>",o+="\t</div>",o+="</section>",o+='<section class="mdl-grid mdl-cell--12-col">',o+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',o+='\t\t<div class="mdl-list__item">',o+="\t\t\t<span class='mdl-list__item-primary-content'>",o+='\t\t\t\t<i class="material-icons mdl-textfield__icon">'+app.icons.sources+"</i>",o+='\t\t\t\t<h2 class="mdl-card__title-text">Arduino Source Code (version '+i.attributes.version+")</h2>",o+="\t\t\t</span>",o+="\t\t\t<span class='mdl-list__item-secondary-action'>",o+="\t\t\t\t<button role='button' class='mdl-button mdl-js-button mdl-button--icon right showsource_button' for='source_of_"+i.id+"'>",o+="\t\t\t\t\t<i class='material-icons'>expand_more</i>",o+="\t\t\t\t</button>",o+="\t\t\t</span>",o+="\t\t</div>",o+="\t\t<div class='mdl-cell--12-col hidden' id='source_of_"+i.id+"'>",o+=app.getField(app.icons.code,"Arduino Source Code",n,{type:"textarea",id:"Code",isEdit:a}),o+="\t\t</div>",o+="\t</div>",o+="</section>",o+='<section class="mdl-cell--12-col" id="children">',o+="</section>",o+='<section class="mdl-cell--12-col" id="objects_linked">',o+="</section>";var s=new Headers;s.append("Authorization","Bearer "+localStorage.getItem("bearer")),s.append("Content-Type","application/json");var l={method:"GET",headers:s},r=app.baseUrl+"/"+app.api_version+"/sources/"+i.id+"/child";fetch(r,l).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){var e="";if(t.data.length>0){var a=document.createElement("div");a.innerHTML=app.getSubtitle("Source children"),document.getElementById("children").appendChild(a)}for(var i=0;i<t.data.length;i++){var n=t.data[i];e+='<section class="mdl-grid mdl-cell--12-col">',e+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',e+='\t<span class="pull-left mdl-card__date">',e+=app.getField(app.icons.code,"Name",void 0!==n.attributes.name?n.attributes.name:"",{type:"text",isEdit:!1}),e+=app.getField(app.icons.version,"Version",void 0!==n.attributes.version?n.attributes.version:"",{type:"text",isEdit:!1}),e+=app.getField(app.icons.date,"Created",moment(n.attributes.meta.created).format(app.date_format),{type:"text",isEdit:!1}),e+="\t</span>",e+='\t<span class="pull-right mdl-card__menuaction edit_children_source">',e+='\t\t<button data-id="'+n.id+'" class="child_edit_btn mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',e+='\t\t\t<i class="material-icons">'+app.icons.edit+"</i>",e+="\t\t</button>",e+="\t</span>",e+="\t</div>",e+="</section>"}document.getElementById("children").innerHTML+=e,app.refreshButtonsSelectors();for(var i in app.buttons.editSourceChild)app.buttons.editSourceChild[i].childElementCount>-1&&app.buttons.editSourceChild[i].addEventListener("click",function(t){app.resources.sources.display(t.target.parentNode.getAttribute("data-id"),!1,!0,!1),t.preventDefault()},!1)});var s=new Headers;s.append("Authorization","Bearer "+localStorage.getItem("bearer")),s.append("Content-Type","application/json");var l={method:"GET",headers:s},r=app.baseUrl+"/"+app.api_version+"/ota/"+i.id+"?ota-status=true";fetch(r,l).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(t){var e="";if(t.data.length>0){var a=document.createElement("div");a.innerHTML=app.getSubtitle("Objects linked"),document.getElementById("objects_linked").appendChild(a)}for(var n=0;n<t.data.length;n++){var o=t.data[n];e+='<section class="mdl-grid mdl-cell--12-col" id="object_'+o.id+'" data-type="linkedObject">',e+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',e+='\t\t<div class="mdl-list__item--three-line small-padding  mdl-card--expand">',e+=app.getField(app.icons.objects,null,void 0!==o.attributes.name?o.attributes.name:"",{type:"text",isEdit:!1}),e+=app.getField("my_location","IPv4",void 0!==o.attributes.ipv4?o.attributes.ipv4:"",{type:"text",isEdit:!1}),e+=app.getField(app.icons.code,"Fqbn string",void 0!==o.attributes.fqbn?o.attributes.fqbn:"",{type:"text",isEdit:!1}),e+=app.getField(app.icons.code,"version",void 0!==o.attributes.source_version?o.attributes.source_version:"",{type:"text",isEdit:!1}),e+=app.getField(o.attributes.is_connected===!0?"flash_on":"flash_off","Status",o.attributes.is_connected===!0?"Active":"Inactive",{type:"text",isEdit:!1}),e+="\t\t</div>",e+='\t\t<div class="mdl-card__actions mdl-card--border">',e+='\t\t\t<button data-id="'+o.id+'" class="object_link_off_btn mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">',e+='\t\t\t\t<i class="material-icons">'+app.icons.link_off+"</i>Unlink",e+="\t\t\t</button>",e+='\t\t\t<button data-id="'+o.id+'" class="object_build_btn mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">',e+='\t\t\t\t<i class="arduino-icon build"> </i> Build',e+="\t\t\t</button>",e+='\t\t\t<button data-id="'+o.id+'" class="object_deploy_btn mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">',e+='\t\t\t\t<i class="arduino-icon deploy"> </i> Deploy',e+="\t\t\t</button>",e+='\t\t\t<button data-id="'+o.id+'" class="object_edit_btn mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect">',e+='\t\t\t\t<i class="material-icons">'+app.icons.edit+"</i>Edit",e+="\t\t\t</button>",e+="\t\t</div>",e+="\t</div>",e+="</section>"}document.getElementById("objects_linked").innerHTML+=e,app.refreshButtonsSelectors();for(var n in app.buttons.editSourceObject)app.buttons.editSourceObject[n].childElementCount>-1&&app.buttons.editSourceObject[n].addEventListener("click",function(t){app.resources.objects.display(t.target.parentNode.getAttribute("data-id"),!1,!0,!1),t.preventDefault()},!1);for(var n in app.buttons.expandSourceButtons)app.buttons.expandSourceButtons[n].childElementCount>-1&&app.buttons.expandSourceButtons[n].addEventListener("click",app.expand,!1);for(var n in app.buttons.link_offSourceObject)app.buttons.link_offSourceObject[n].childElementCount>-1&&app.buttons.link_offSourceObject[n].addEventListener("click",function(t){app.resources.sources.onUnlinkObject(i.id,t.target.parentNode.getAttribute("data-id")),t.preventDefault()},!1);for(var n in app.buttons.deploySourceObject)app.buttons.deploySourceObject[n].childElementCount>-1&&app.buttons.deploySourceObject[n].addEventListener("click",function(t){app.resources.sources.onDeploy(i.id,t.target.parentNode.getAttribute("data-id")),t.preventDefault()},!1);for(var n in app.buttons.buildSourceObject)app.buttons.buildSourceObject[n].childElementCount>-1&&app.buttons.buildSourceObject[n].addEventListener("click",function(t){app.resources.sources.onBuild(i.id,t.target.parentNode.getAttribute("data-id")),t.preventDefault()},!1)});var d=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];a?(o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+i.id+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+d[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>View</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+d[0]+"'>View Source</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+d[1]+"' class='save-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>save</i>",o+="\t\t\t<label>Save</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+d[1]+"'>Save changes to Source</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>"):(o+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+i.id+"'>",app.isLtr()&&(o+="\t<div class='mdl-layout-spacer'></div>"),o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+d[0]+"' class='list-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>chevron_left</i>",o+="\t\t\t<label>List</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+d[0]+"'>List all Sources</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone delete-button'>",o+="\t\t<button id='"+d[1]+"' class='delete-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>delete</i>",o+="\t\t\t<label>Delete</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+d[1]+"'>Delete Source...</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+d[2]+"' class='build-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='arduino-icon build'> </i>",o+="\t\t\t<label>Build All</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+d[2]+"'>Build Arduino</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-left'>",o+="\t\t<button id='"+d[3]+"' class='deploy-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='arduino-icon deploy'> </i>",o+="\t\t\t<label>Deploy All</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+d[3]+"'>Deploy to Objects</label>",o+="\t\t</button>",o+="\t</div>",o+="\t<div class='mdl-cell--1-col-phone pull-right'>",o+="\t\t<button id='"+d[4]+"' class='edit-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+i.id+"'>",o+="\t\t\t<i class='material-icons'>edit</i>",o+="\t\t\t<label>Edit</label>",o+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+d[4]+"'>Edit Source</label>",o+="\t\t</button>",o+="\t</div>",app.isLtr()||(o+="\t<div class='mdl-layout-spacer'></div>"),o+="</section>"),app.containers.source.querySelector(".page-content").innerHTML=o,componentHandler.upgradeDom(),app.refreshButtonsSelectors(),a?(app.buttons.backSource.addEventListener("click",function(t){app.resources.sources.display(i.id,!1,!1,!1)},!1),app.buttons.saveSource.addEventListener("click",function(t){app.resources.sources.onEdit(t)},!1)):(app.buttons.listSource.addEventListener("click",function(t){app.setSection("sources"),t.preventDefault()},!1),app.buttons.editSource2.addEventListener("click",function(t){app.resources.sources.display(i.id,!1,!0,!1),t.preventDefault()},!1),app.buttons.buildSource.addEventListener("click",function(t){app.resources.sources.onBuild(i.id,null),t.preventDefault()},!1),app.buttons.deploySource.addEventListener("click",function(t){app.resources.sources.onDeploy(i.id,null),t.preventDefault()},!1)),app.setExpandAction(),app.setSection("source")}}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("displaySource error occured..."+t,{timeout:3e3,type:"error"})}),app.containers.spinner.setAttribute("hidden",!0)},displayPublic:function(t,e,a,i){},displayAdd:function(t,e,a,i){history.pushState({section:"source_add"},window.location.hash.substr(1),"#source_add"),app.initNewSection("source_add");var n="";t.id=""!==t.id?t.id:app.getUniqueId();var o=void 0!==t.attributes.content?t.attributes.content:"";n+=app.getSubtitle("Security"),n+='<section class="mdl-grid mdl-cell--12-col">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField("verified_user","OTA Password",void 0!==t.attributes.password?t.attributes.password:"",{type:"text",style:"text-transform: none !important;",id:"password",isEdit:!0,pattern:app.patterns.password,error:""}),n+="\t</div>",n+="</section>",n+=app.getSubtitle("Parameters"),n+='<section class="mdl-grid mdl-cell--12-col">',n+='\t<div class="mdl-cell--12-col mdl-card mdl-shadow--2dp">',n+=app.getField(app.icons.name,"Name",t.attributes.name,{type:"text",id:"Name",isEdit:!0,pattern:app.patterns.name,error:"Name should be set and more than 3 chars length."}),n+=app.getField(app.icons.code,"Arduino Source Code",o,{type:"textarea",id:"Code",isEdit:!0}),n+="\t</div>",n+="</section>";var s=[app.getUniqueId(),app.getUniqueId(),app.getUniqueId()];n+="<section class='mdl-grid mdl-cell--12-col fixedActionButtons' data-id='"+t.id+"'>",app.isLtr()&&(n+="\t<div class='mdl-layout-spacer'></div>"),n+="\t<div class='mdl-cell--1-col-phone pull-left'>",n+="\t\t<button id='"+s[0]+"' class='back-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>chevron_left</i>",n+="\t\t\t<label>List</label>",n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[0]+"'>List all Sources</label>",n+="\t\t</button>",n+="\t</div>",n+="\t<div class='mdl-cell--1-col-phone pull-right'>",n+="\t\t<button id='"+s[1]+"' class='add-button mdl-cell mdl-button mdl-button--colored mdl-js-button mdl-js-ripple-effect' data-id='"+t.id+"'>",n+="\t\t\t<i class='material-icons'>edit</i>",n+="\t\t\t<label>Save</label>",
n+="\t\t\t<div class='mdl-tooltip mdl-tooltip--top' for='"+s[1]+"'>Save new Source</label>",n+="\t\t</button>",n+="\t</div>",app.isLtr()||(n+="\t<div class='mdl-layout-spacer'></div>"),n+="</section>",app.containers.source_add.querySelector(".page-content").innerHTML=n,componentHandler.upgradeDom(),app.refreshButtonsSelectors(),app.buttons.addSourceBack.addEventListener("click",function(t){app.setSection("sources"),t.preventDefault()},!1),app.buttons.addSource.addEventListener("click",function(t){app.resources.sources.onAdd(t)},!1),app.setExpandAction()},displayItem:function(t){var e=void 0!==t.attributes.name?t.attributes.name:"",a=void 0!==t.attributes.content?t.attributes.content.substring(0,app.cardMaxChars):"",i="";return i+='<div class="mdl-grid mdl-cell" data-action="view" data-type="sources" data-id="'+t.id+'">',i+='\t<div class="mdl-card mdl-shadow--2dp">',i+='\t\t<div class="mdl-card__title">',i+='\t\t\t<i class="material-icons">'+app.icons.sources+"</i>",i+='\t\t\t<h3 class="mdl-card__title-text">'+e+"</h3>",i+="\t\t</div>",i+=app.getField(null,null,a,{type:"textarea",isEdit:!1}),i+='\t\t<div class="mdl-card__actions mdl-card--border">',i+='\t\t\t<span class="pull-left mdl-card__date">',i+='\t\t\t\t<button data-id="'+t.id+'" class="swapDate mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',i+='\t\t\t\t\t<i class="material-icons">update</i>',i+="\t\t\t\t</button>",i+='\t\t\t\t<span data-date="created" class="visible">Created on '+moment(t.attributes.meta.created).format(app.date_format)+"</span>",i+=t.attributes.meta.updated?'\t\t\t\t<span data-date="updated" class="hidden">Updated on '+moment(t.attributes.meta.updated).format(app.date_format)+"</span>":'\t\t\t\t<span data-date="updated" class="hidden">Never been updated yet.</span>',i+="\t\t\t</span>",i+='\t\t\t<span class="pull-right mdl-card__menuaction">',i+='\t\t\t\t<button id="menu_'+t.id+'" class="mdl-button mdl-js-button mdl-button--icon mdl-js-ripple-effect">',i+='\t\t\t\t\t<i class="material-icons">'+app.icons.menu+"</i>",i+="\t\t\t\t</button>",i+="\t\t\t</span>",i+='\t\t\t<ul class="mdl-menu mdl-menu--top-right mdl-js-menu mdl-js-ripple-effect" for="menu_'+t.id+'">',i+='\t\t\t\t<li class="mdl-menu__item delete-button">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons delete-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.delete+"</i>Delete</a>",i+="\t\t\t\t</li>",i+='\t\t\t\t<li class="mdl-menu__item">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons edit-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'" data-name="'+e+'">'+app.icons.edit+"</i>Edit</a>",i+="\t\t\t\t</li>",i+='\t\t\t\t<li class="mdl-menu__item">',i+='\t\t\t\t\t<a class=\'mdl-navigation__link\'><i class="material-icons copy-button mdl-js-button mdl-js-ripple-effect" data-id="'+t.id+'">'+app.icons.copy+'</i><textarea class="copytextarea">'+t.id+"</textarea>Copy ID to clipboard</a>",i+="\t\t\t\t</li>",i+="\t\t\t</ul>",i+="\t\t</div>",i+="\t</div>",i+="</div>"}};var snippet={name:"valueDisplay",value:"Value Display",options:{width:{default_value:"6",type:"select",available_values:["4","6","8","12"]},color:{defaultValue:"#FF0000",type:"text"},legend:{defaultValue:"top",type:"select",availableValues:[!0,!1,"top","bottom"]}},activateOnce:function(t){void 0!==t.attributes.options?this.options.width.value=void 0!==t.attributes.options.width.value?t.attributes.options.width.value:this.options.width.default_value:this.options.width.value="12",document.getElementById(t.id).parentNode.classList.add("mdl-cell--"+this.options.width.value+"-col");var e=new Headers;e.append("Authorization","Bearer "+localStorage.getItem("bearer")),e.append("Content-Type","application/json");var a={method:"GET",headers:e},i=app.baseUrl+"/"+app.api_version+"/data/"+t.attributes.flows[0]+"?sort=desc&limit=4";fetch(i,a).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){for(var a=(e.data[0].attributes.id,e.data[0].attributes.time),i=void 0!==e.links.unit?e.links.unit:"",n=e.links.ttl,o=[],s=0;s<3;s++){var l=s,r=s+1;e.data[l].attributes.value===e.data[r].attributes.value?o[r]="<i class='material-icons md-48'>trending_flat</i> "+sprintf(i,e.data[l].attributes.value):e.data[l].attributes.value<e.data[r].attributes.value?o[r]="<i class='material-icons md-48'>trending_down</i> "+sprintf(i,e.data[l].attributes.value):e.data[l].attributes.value>e.data[r].attributes.value&&(o[r]="<i class='material-icons md-48'>trending_up</i> "+sprintf(i,e.data[l].attributes.value)),moment().subtract(n,"seconds")>moment(a)?(document.getElementById("snippet-value"+r+"-"+t.id).parentNode.parentNode.parentNode.classList.remove("is-ontime"),document.getElementById("snippet-value"+r+"-"+t.id).parentNode.parentNode.parentNode.classList.add("is-outdated")):(document.getElementById("snippet-value"+r+"-"+t.id).parentNode.parentNode.parentNode.classList.remove("is-outdated"),document.getElementById("snippet-value"+r+"-"+t.id).parentNode.parentNode.parentNode.classList.add("is-ontime")),document.getElementById("snippet-value"+r+"-"+t.id).innerHTML=o[r]}setInterval(function(){app.refreshFromNow("snippet-time-"+t.id,a,!0)},2e3)}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("getSnippet Inside error..."+t,{timeout:3e3,type:"error"})})},getHtml:function(t){return t||(t={}),t.time=moment().format(app.date_format),`
\t\t<div id="${t.id}" class="valuedisplay tile card-valuedisplay material-animate margin-top-4 material-animated mdl-shadow--2dp is-ontime">
\t\t\t<div class="contextual">
\t\t\t\t<div class="mdl-list__item-primary-content">
\t\t\t\t\t<i class="material-icons">${t.icon}</i>
\t\t\t\t\t<span class="heading">${t.name}</span>
\t\t\t\t\t<span class="heading pull-right">
\t\t\t\t\t\t<button data-snippet-id="${t.id}" class="edit-snippet mdl-button mdl-js-button mdl-button--icon">
\t\t\t\t\t\t\t<i class="material-icons">settings</i>
\t\t\t\t\t\t</button>
\t\t\t\t\t</span>
\t\t\t\t</div>
\t\t\t\t<div class="mdl-list__item-secondary-content">
\t\t\t\t\t<span class="snippet-value1" id="snippet-value1-${t.id}" style="color:${t.color} !important">
\t\t\t\t\t\t<i class="material-icons md-48">trending_flat</i>  
\t\t\t\t\t</span>
\t\t\t\t\t<hr style="">
\t\t\t\t\t<span class="snippet-value2" id="snippet-value2-${t.id}" style="color:${t.color} !important">
\t\t\t\t\t\t<i class="material-icons">trending_flat</i>  
\t\t\t\t\t</span>
\t\t\t\t\t<hr style="">
\t\t\t\t\t<span class="snippet-value3" id="snippet-value3-${t.id}" style="color:${t.color} !important">
\t\t\t\t\t\t<i class="material-icons">trending_flat</i>  
\t\t\t\t\t</span>
\t\t\t\t</div>
\t\t\t</div>
\t\t\t<div class="mdl-list__item-sub-title" id="snippet-time-${t.id}">// ::</div>
\t\t</div>`}};snippet.getOptions=function(t){return t.options},snippet.setOptions=function(t){var e={},a=this;for(var i in a.options)e[i]=a.options[i];for(var i in t)e[i]=t[i];return this.options=e,e},app.snippetTypes.push(snippet);var snippet={name:"graphDisplay",value:"Graph DEPRECATED !!!!",options:{width:{default_value:"12",type:"select",available_values:["4","6","8","12"]}},activateOnce:function(t){},getHtml:function(t){}},snippet={name:"flowgraph",value:"Graph a Flow over axis",options:{width:{default_value:"12",type:"select",available_values:["4","6","8","12"]},type:{default_value:"line",type:"select",available_values:["bar","line","radar","pie","polarArea","bubble","scatter"]},color:{default_value:"#FF0000",type:"text"},legend_font_color:{default_value:"#FF0000",type:"text"},border_color:{default_value:"#FF0000",type:"text"},border_width:{default_value:4,type:"select",available_values:[2,4,6,8,10,12]},background_color:{default_value:"#FF0000",type:"text"},point_background_color:{default_value:"#FF0000",type:"text"},limit:{default_value:15,type:"integer"},fill:{default_value:!1,type:"switch",available_values:[!0,!1,"origin","start","end"]},show_line:{default_value:!1,type:"switch",available_values:[!0,!1]},stepped_line:{default_value:!1,type:"select",available_values:[!0,!1,"before","after"]},title_display:{default_value:!1,type:"switch",available_values:[!0,!1]},title_font_size:{default_value:12,type:"integer"},title_font_family:{default_value:"Helvetica",type:"select",available_values:["Helvetica","Helvetica Neue","Arial","sans-serif"]},legend_display:{default_value:!1,type:"select",available_values:[!0,!1]},legend_position:{default_value:!1,type:"select",available_values:["top","bottom","left","right"]},legend_align:{default_value:!1,type:"select",available_values:["start","center","end"]}},activateOnce:function(t){void 0!==t.attributes.options?this.options.width.value=void 0!==t.attributes.options.width.value?t.attributes.options.width.value:this.options.width.default_value:this.options.width.value="12",document.getElementById(t.id).parentNode.classList.add("mdl-cell--"+this.options.width.value+"-col");var e=new Headers;e.append("Authorization","Bearer "+localStorage.getItem("bearer")),e.append("Content-Type","application/json");var a={method:"GET",headers:e},i=this.getOptions(this),n=i.limit&&void 0!==i.limit.value?i.limit.value:5,o=app.baseUrl+"/"+app.api_version+"/data/"+t.attributes.flows[0]+"?sort=desc&limit="+n;let s;fetch(o,a).then(app.fetchStatusHandler).then(function(t){return t.json()}).then(function(e){let a=document.getElementById("chart-"+t.id);a.height=250,s=a.getContext("2d");let n=[];if(void 0!==e.data&&"errors"!==e.data.type){e.data.forEach(function(t){n.push({x:new Date(t.attributes.timestamp),y:t.attributes.value})});let a=i.type&&void 0!==i.type.value?i.type.value:i.type.default_value,o=" ("+sprintf(void 0!==e.links.unit?e.links.unit:"","")+")",l={datasets:[{label:void 0!==t.flowNames?t.flowNames[0]:"",backgroundColor:i.background_color&&void 0!==i.background_color.value?i.background_color.value:i.background_color.default_value,borderColor:i.border_color&&void 0!==i.border_color.value?i.border_color.value:i.border_color.default_value,borderWidth:i.border_width&&void 0!==i.border_width.value?i.border_width.value:i.border_width.default_value,fill:i.fill&&void 0!==i.fill.value?i.fill.value:i.fill.default_value,showLine:i.show_line&&void 0!==i.show_line.value?i.show_line.value:i.show_line.default_value,steppedLine:i.stepped_line&&void 0!==i.stepped_line.value?i.stepped_line.value:i.stepped_line.default_value,pointStyle:"rectRounded",hoverRadius:10,pointBackgroundColor:i.point_background_color&&void 0!==i.point_background_color.value?i.point_background_color.value:i.point_background_color.default_value,data:n}]},r={title:{display:i.title_display&&void 0!==i.title_display.value?i.title_display.value:i.title_display.default_value,text:void 0!==t.flowNames?t.flowNames[0]:"Snippet Title",fontSize:i.title_font_size&&void 0!==i.title_font_size.value?i.title_font_size.value:i.title_font_size.default_value,fontFamily:i.title_font_family&&void 0!==i.title_font_family.value?i.title_font_family.value:i.title_font_family.default_value},legend:{display:i.legend_display&&void 0!==i.legend_display.value?i.legend_display.value:i.legend_display.default_value,position:i.legend_position&&void 0!==i.legend_position.value?i.legend_position.value:i.legend_position.default_value,align:i.legend_align&&void 0!==i.legend_align.value?i.legend_align.value:i.legend_align.default_value,labels:{fontColor:i.legend_font_color&&void 0!==i.legend_font_color.value?i.legend_font_color.value:i.legend_font_color.default_value}},tooltips:{enable:!1},scales:{xAxes:[{type:"time",time:{unit:"hour"},ticks:{source:"auto"}}]},maintainAspectRatio:!1,responsive:!0,animation:{duration:0}};new Chart(s,{type:a,data:l,options:r});let d=(e.data[0].attributes.id,e.data[0].attributes.time);document.getElementById("unit-"+t.id).innerHTML=o,setInterval(function(){app.refreshFromNow("snippet-time-"+t.id,d,!0)},2e3)}else a.getContext("2d").textAlign="center",a.getContext("2d").fillText("Data error occured; please check Snippet settings :-(",a.width/2,a.height/2)}).catch(function(t){"true"==localStorage.getItem("settings.debug")&&toast("getSnippet Inside error..."+t,{timeout:3e3,type:"error"})})},getHtml:function(t){return t||(t={}),t.unit,`
\t\t<div id="${t.id}" class="flowgraph tile card-flowgraph material-animate margin-top-4 material-animated mdl-shadow--2dp">
\t\t\t<div class="contextual">
\t\t\t\t<div class="mdl-list__item-primary-content">
\t\t\t\t\t<i class="material-icons">${t.icon}</i>
\t\t\t\t\t<span class="heading">${t.name} <span id="unit-${t.id}">(${t.unit})</span></span>
\t\t\t\t\t<span class="heading pull-right">
\t\t\t\t\t\t<button data-snippet-id="${t.id}" class="edit-snippet mdl-button mdl-js-button mdl-button--icon">
\t\t\t\t\t\t\t<i class="material-icons">settings</i>
\t\t\t\t\t\t</button>
\t\t\t\t\t</span>
\t\t\t\t</div>
\t\t\t\t<div class="mdl-list__item-secondary-content">
\t\t\t\t\t<div class="mdl-list__item" id="snippet-graph-${t.id}" style="width:100%;">
\t\t\t\t\t\t<canvas id="chart-${t.id}"></canvas>
\t\t\t\t\t</div>
\t\t\t\t</div>
\t\t\t</div>
\t\t\t<div class="mdl-list__item-sub-title" id="snippet-time-${t.id}">// ::</span>
\t\t</div>`}};snippet.getOptions=function(t){return t.options},snippet.setOptions=function(t){var e={};for(var a in this.options)e[a]=this.options[a];for(var a in t)e[a]=t[a];return this.options=e,e},app.snippetTypes.push(snippet);var snippet={name:"simpleclock",value:"Realtime clock",options:{width:{default_value:"12",type:"select",available_values:["4","6","8","12"]},color:{defaultValue:"#FF0000",type:"text"},legend:{defaultValue:"top",type:"select",availableValues:[!0,!1,"top","bottom"]}},activateOnce:function(t){void 0!==t.attributes.options?this.options.width.value=void 0!==t.attributes.options.width.value?t.attributes.options.width.value:this.options.width.default_value:this.options.width.value="12",document.getElementById(t.id).parentNode.classList.add("mdl-cell--"+this.options.width.value+"-col"),setInterval(function(){app.refreshFromNow("snippet-clock-"+t.id,moment(),null)},1e3)},getHtml:function(t){return t||(t={}),t.time=moment().format(app.date_format),`
\t\t<div id="${t.id}" class="clock tile card-simpleclock material-animate margin-top-4 material-animated mdl-shadow--2dp">
\t\t\t<span class='mdl-list__item mdl-list__item--two-line'>
\t\t\t\t<span class='mdl-list__item-primary-content'>
\t\t\t\t\t<i class='material-icons'>${t.icon}</i>
\t\t\t\t\t<span class="heading">${t.name}</span>
\t\t\t\t\t<span class='mdl-list__item-sub-title' id='snippet-time-${t.id}'></span>
\t\t\t\t</span>
\t\t\t\t<span class='mdl-list__item-secondary-content'>
\t\t\t\t\t<span class='mdl-list__item'>
\t\t\t\t\t\t<span class='mdl-list__item-sub-title mdl-chip mdl-chip__text' id='snippet-clock-${t.id}'>// ::</span>
\t\t\t\t\t</span>
\t\t\t\t</span>
\t\t\t</span>
\t\t</div>`}};snippet.getOptions=function(t){return t.options},snippet.setOptions=function(t){var e={},a=this;for(var i in a.options)e[i]=a.options[i];for(var i in t)e[i]=t[i];return this.options=e,e},app.snippetTypes.push(snippet);var snippet={name:"simplerow",value:"Display one row for each value",options:{width:{default_value:"12",type:"select",available_values:["4","6","8","12"]},color:{defaultValue:"#FF0000",type:"text"},legend:{defaultValue:"top",type:"select",availableValues:[!0,!1,"top","bottom"]}},activateOnce:function(t){void 0!==t.attributes.options?this.options.width.value=void 0!==t.attributes.options.width.value?t.attributes.options.width.value:this.options.width.default_value:this.options.width.value="12",document.getElementById(t.id).parentNode.classList.add("mdl-cell--"+this.options.width.value+"-col")},getHtml:function(t){return t||(t={}),t.time=moment().format(app.date_format),`
\t\t<div id="${t.id}" class="simplerow tile card-simplerow material-animate margin-top-4 material-animated mdl-shadow--2dp">\t\t
\t\t\t<span class="mdl-list__item mdl-list__item--two-line">
\t\t\t\t<span class="mdl-list__item-primary-content">
\t\t\t\t\t<i class="material-icons">widgets</i>
\t\t\t\t\t<span class="heading">${t.name}</span>
\t\t\t\t\t<span class="mdl-list__item-sub-title" id="snippet-time-${t.id}">
\t\t\t\t\t\t// ::
\t\t\t\t\t</span>
\t\t\t\t</span>
\t\t\t\t<span class="mdl-list__item-secondary-content">
\t\t\t\t\t<span class="mdl-list__item-sub-title mdl-chip mdl-chip__text" id="snippet-value-${t.id}">
\t\t\t\t\t\t${t.value}
\t\t\t\t\t</span>
\t\t\t\t</span>
\t\t\t\t<span class="heading pull-right">
\t\t\t\t\t<button data-snippet-id="${t.id}" class="edit-snippet mdl-button mdl-js-button mdl-button--icon">
\t\t\t\t\t\t<i class="material-icons">settings</i>
\t\t\t\t\t</button>
\t\t\t\t</span>
\t\t\t</span>
\t\t</div>`}};snippet.getOptions=function(t){return t.options},snippet.setOptions=function(t){var e={},a=this;for(var i in a.options)e[i]=a.options[i];for(var i in t)e[i]=t[i];return this.options=e,e},app.snippetTypes.push(snippet);var snippet={name:"cardChart",value:"Chart on a card",options:{width:{default_value:"12",type:"select",available_values:["4","6","8","12"]},color:{defaultValue:"#FF0000",type:"text"},legend:{defaultValue:"top",type:"select",availableValues:[!0,!1,"top","bottom"]}},getSample:function(){var t={};return snippet.getHtml(t)},activateOnce:function(t){void 0!==t.attributes.options?this.options.width.value=void 0!==t.attributes.options.width.value?t.attributes.options.width.value:this.options.width.default_value:this.options.width.value="12",document.getElementById(t.id).parentNode.classList.add("mdl-cell--"+this.options.width.value+"-col")},getHtml:function(t){return t||(t={}),`
\t\t<div id="${t.id}" class="card card-chart material-animate margin-top-4 material-animated mdl-shadow--2dp">
\t\t\t<div class="card-header" style="background: ${t.color}">
\t\t\t<div class="ct-chart" id="dailySalesChart"></div>
\t\t\t</div>
\t\t\t<div class="card-body">
\t\t\t\t<i class="material-icons">${t.icon}</i>
\t\t\t\t<h4 class="card-title">${t.name}</h4>
\t\t\t\t<p class="card-category">Subtitle</p>
\t\t\t</div>
\t\t\t<div class="card-footer">
\t\t\t\t<div class="stats">
\t\t\t\t\t<i class="material-icons" id="snippet-time-${t.id}">access_time</i> Last
\t\t\t\t</div>
\t\t\t</div>
\t\t</div>`}};snippet.getOptions=function(t){return t.options},snippet.setOptions=function(t){var e={},a=this;for(var i in a.options)e[i]=a.options[i];for(var i in t)e[i]=t[i];return this.options=e,e},app.snippetTypes.push(snippet);var snippet={name:"sparkline",value:"Spark line",options:{width:{default_value:"12",type:"select",available_values:["4","6","8","12"]},color:{defaultValue:"#FF0000",type:"text"},legend:{defaultValue:"top",type:"select",availableValues:[!0,!1,"top","bottom"]}},activateOnce:function(t){void 0!==t.attributes.options?this.options.width.value=void 0!==t.attributes.options.width.value?t.attributes.options.width.value:this.options.width.default_value:this.options.width.value="12",document.getElementById(t.id).parentNode.classList.add("mdl-cell--"+this.options.width.value+"-col")},getHtml:function(t){return t||(t={}),`
\t\t<div id="${t.id}" class="sparkline tile card-sparkline material-animate margin-top-4 material-animated mdl-shadow--2dp">
\t\t\t<span class="mdl-list__item mdl-list__item--two-line">
\t\t\t\t<span class="mdl-list__item-primary-content">
\t\t\t\t\t<i class="material-icons">trending_up</i>
\t\t\t\t\t<span class="heading">${t.title}</span>
\t\t\t\t\t<span class="mdl-list__item-sub-title" id="snippet-time-${t.id}">// ::</span>
\t\t\t\t</span>
\t\t\t\t<span class="mdl-list__item-secondary-content">
\t\t\t\t\t<span class="mdl-list__item-sub-title mdl-chip mdl-chip__text" id="snippet-value-${t.id}"></span>
\t\t\t\t</span>
\t\t\t\t<span class="mdl-list__item" id="snippet-sparkline-" style="width:100%; height:200px;">
\t\t\t\t\t<span class="mdl-list__item-sub-title mdl-chip mdl-chip__text">sparkline</span>
\t\t\t\t</span>
\t\t\t</span>
\t\t</div>`}};snippet.getOptions=function(t){return t.options},snippet.setOptions=function(t){var e={},a=this;for(var i in a.options)e[i]=a.options[i];for(var i in t)e[i]=t[i];return this.options=e,e},app.snippetTypes.push(snippet);